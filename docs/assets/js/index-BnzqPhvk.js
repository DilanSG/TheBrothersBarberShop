import{a as ic,b as oc,g as lc,r as O,u as Ya,c as Tn,L as Ae,O as yn,d as cc,N as kr,R as gs,e as Ie,f as dc,h as uc,B as fc}from"./vendor-CqFXMR30.js";import{P as hc,M as Cn,U as Nr,A as Ro,S as Rt,a as jr,C as ht,b as ws,c as Us,X as qr,d as An,e as nr,f as jt,F as ys,L as ya,B as Si,E as tn,g as Ta,h as na,i as It,j as ua,k as aa,T as Xa,l as fa,m as ki,n as Dn,o as Fn,p as Ti,q as Pn,r as Ca,s as Sa,D as Ra,t as Lo,u as Nn,v as $s,w as Aa,x as Ns,y as Bo,z as xc,G as On,H as an,I as Ci,R as mc,J as Wo,K as is,N as pc,O as gc}from"./utils-D3v0yySm.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var sn={exports:{}},Na={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ai;function vc(){if(Ai)return Na;Ai=1;var e=ic(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(l,d,c){var u,h={},m=null,f=null;c!==void 0&&(m=""+c),d.key!==void 0&&(m=""+d.key),d.ref!==void 0&&(f=d.ref);for(u in d)s.call(d,u)&&!i.hasOwnProperty(u)&&(h[u]=d[u]);if(l&&l.defaultProps)for(u in d=l.defaultProps,d)h[u]===void 0&&(h[u]=d[u]);return{$$typeof:t,type:l,key:m,ref:f,props:h,_owner:n.current}}return Na.Fragment=r,Na.jsx=o,Na.jsxs=o,Na}var Di;function bc(){return Di||(Di=1,sn.exports=vc()),sn.exports}var a=bc(),os={},Fi;function wc(){if(Fi)return os;Fi=1;var e=oc();return os.createRoot=e.createRoot,os.hydrateRoot=e.hydrateRoot,os}var yc=wc();const Nc=lc(yc),ea="https://thebrothersbarbershop.onrender.com/api/v1",jc="1.0.0",Pi=e=>new Promise(t=>setTimeout(t,e));let Ke=null;const Oi=e=>{Ke=e},_t={async open(e){if(typeof caches=="undefined")return null;try{return await caches.open(e)}catch(t){return console.warn("Error al abrir caché:",t),null}},async delete(e){if(typeof caches=="undefined")return!1;try{return await caches.delete(e)}catch(t){return console.warn("Error al eliminar caché:",t),!1}},async keys(){if(typeof caches=="undefined")return[];try{return await caches.keys()}catch(e){return console.warn("Error al obtener keys de caché:",e),[]}}},La={async get(e){const t=await _t.open("api-cache");if(!t)return null;try{const r=await t.match(e);if(r){const s=await r.json();if(s.expiry&&s.expiry>Date.now())return s.value;await t.delete(e)}}catch(r){console.warn("Error al obtener del caché:",r)}return null},async set(e,t,r=3e5){const s=await _t.open("api-cache");if(s)try{const n={value:t,expiry:Date.now()+r,timestamp:Date.now()},i=new Response(JSON.stringify(n));await s.put(e,i)}catch(n){console.warn("Error al guardar en caché:",n)}},async clear(){try{const e=await _t.keys();await Promise.all(e.map(t=>_t.delete(t)))}catch(e){console.warn("Error al limpiar caché:",e)}}},yt=async(e,t,r=3,s=1e3)=>{const n=t.headers&&t.headers["Content-Type"]==="multipart/form-data",i=e.includes("/inventory-snapshots"),o=n||i?3e4:1e4,l=new AbortController;let d;try{d=setTimeout(()=>l.abort(),o),t.headers={...t.headers,"X-Client-Version":jc,"X-Request-ID":Math.random().toString(36).substring(7)},t.signal=l.signal;const c=performance.now(),u=await fetch(e,t),h=performance.now();if(clearTimeout(d),u.status===429&&r>0)return await Pi(s),yt(e,t,r-1,s*2);if(!u.ok){let m;try{m=await u.text();try{m=JSON.parse(m)}catch{}}catch{m="Error desconocido"}const f=new Error(`HTTP error! status: ${u.status}
Endpoint: ${e}
Details: ${typeof m=="object"?JSON.stringify(m):m}`);throw f.response=u,f.data=m,f}return u}catch(c){if(d&&clearTimeout(d),c.name==="AbortError")throw new Error(`La operación tardó demasiado (más de ${o/1e3}s). Esto puede deberse a problemas de conectividad.`);if(r>0&&(c.name==="TypeError"||c.message.includes("failed to fetch")))return await Pi(s),yt(e,t,r-1,s*2);throw c}},_c=()=>{console.log("🕐 Sesión expirada - iniciando proceso de limpieza"),Ke?(console.log("📢 Mostrando notificación de sesión expirada"),Ke.showSessionExpired()):(console.warn("⚠️ NotificationContext no disponible para mostrar sesión expirada"),alert("Tu sesión ha expirado. Serás redirigido al login.")),localStorage.removeItem("token"),localStorage.removeItem("user"),La.clear(),setTimeout(()=>{console.log("🔄 Redirigiendo a login..."),window.location.href="/login"},2e3)},Qr=(e,t,r="")=>{if(console.log("🔐 Manejando error de autenticación:",{status:e.status,message:t.message,endpoint:r,data:t,notificationContext:!!Ke}),e.status===401){const s=t.message||"";throw r.includes("/auth/login")||r.includes("/auth/register")?new Error(s||"Error de autenticación"):window.location.pathname==="/login"||window.location.pathname==="/register"?new Error(s||"Error de autenticación"):s.toLowerCase().includes("expirado")||s.toLowerCase().includes("expired")||s.toLowerCase().includes("jwt")?(console.log("🕐 Token expirado detectado, llamando handleSessionExpired"),_c(),new Error("Tu sesión ha expirado. Por favor, inicia sesión nuevamente.")):s.toLowerCase().includes("no proporcionado")||s.toLowerCase().includes("token requerido")||s.toLowerCase().includes("acceso denegado")||s.toLowerCase().includes("unauthorized")?(console.log("🚫 Acceso no autorizado, mostrando notificación"),Ke&&Ke.showError("Tu sesión ha expirado o no tienes los permisos necesarios. Redirigiendo al login...","Sesión Expirada"),localStorage.removeItem("token"),localStorage.removeItem("user"),setTimeout(()=>{window.location.href="/login"},2e3),new Error("Se requiere autenticación. Redirigiendo al inicio de sesión...")):(console.log("❌ Otro error de autenticación"),Ke&&Ke.showError("Error de autenticación. Por favor, inicia sesión nuevamente.","Acceso Denegado"),localStorage.removeItem("token"),localStorage.removeItem("user"),setTimeout(()=>{window.location.href="/login"},2e3),new Error("Error de autenticación. Redirigiendo al inicio de sesión..."))}},ja=e=>{if(Ke)if(e.message.includes("failed to fetch")||e.name==="TypeError")Ke.showConnectionError();else if(e.message.includes("429"))Ke.showWarning("El servidor está ocupado. Por favor, espera un momento y vuelve a intentarlo.","Servidor Ocupado");else{if(e.message.includes("HTTP error! status: 400"))return;if(e.message.includes("HTTP error! status: 401"))return;e.message.includes("HTTP error! status: 403")?Ke.showError("No tienes permisos para realizar esta acción.","Acceso Prohibido"):e.message.includes("HTTP error! status: 404")?Ke.showError("El recurso solicitado no fue encontrado.","No Encontrado"):e.message.includes("HTTP error! status: 500")?Ke.showError("Error interno del servidor. Por favor, inténtalo más tarde.","Error del Servidor"):e.message.includes("HTTP error! status:")||Ke.showError(e.message,"Error de Servidor")}},ra=()=>{const e=localStorage.getItem("token");if(!e)return null;try{const t=JSON.parse(atob(e.split(".")[1])),r=Math.floor(Date.now()/1e3);return t.exp&&t.exp<r?(console.log("🚨 Token expirado, removiendo del localStorage"),localStorage.removeItem("token"),localStorage.removeItem("user"),null):e}catch(t){return console.error("❌ Error al validar token:",t),localStorage.removeItem("token"),localStorage.removeItem("user"),null}},pe={get:async(e,t=!0,r=3e5)=>{try{const s=ra(),n=`${ea}${e}`;if(t){const l=await La.get(n);if(l)return l}const i=await yt(n,{method:"GET",headers:{"Content-Type":"application/json",...s&&{Authorization:`Bearer ${s}`}}}),o=await i.json();return Qr(i,o,e),t&&i.ok&&await La.set(n,o,r),o}catch(s){if(console.log("🚨 Error en api.get:",s),s.response&&s.data)try{Qr(s.response,s.data,e)}catch(n){throw n}throw ja(s),s}},post:async(e,t)=>{try{const r=ra(),s=await yt(`${ea}${e}`,{method:"POST",headers:{"Content-Type":"application/json",...r&&{Authorization:`Bearer ${r}`}},body:JSON.stringify(t)}),n=await s.json();if(Qr(s,n,e),s.ok)try{const i=new RegExp(e.split("/")[1]),o=await _t.open("api-cache");if(o){const l=await o.keys();for(const d of l)i.test(d.url)&&await o.delete(d)}}catch(i){console.warn("Error al invalidar caché:",i)}return n}catch(r){if(console.log("🚨 Error en api.post:",r),r.response&&r.data){try{Qr(r.response,r.data,e)}catch(s){throw s}if(r.response.status===400&&Ke){const s=r.data;let n="Error de validación";throw s!=null&&s.details&&Array.isArray(s.details)?n=`Error de validación: ${s.details.map(o=>`${o.field}: ${o.message}`).join(", ")}`:s!=null&&s.message&&(n=s.message),Ke.showError(n,"Error de Validación"),new Error(n)}}throw ja(r),r}},put:async(e,t,r={})=>{try{const s=ra(),n=t instanceof FormData;console.log(`PUT ${e} - isFormData: ${n}`);const i={method:"PUT",headers:{...s&&{Authorization:`Bearer ${s}`},...r.headers}};n?i.body=t:(i.headers["Content-Type"]="application/json",i.body=t?JSON.stringify(t):void 0),console.log("Enviando request con headers:",i.headers);const o=await yt(`${ea}${e}`,i);console.log("Response status:",o.status,"ok:",o.ok);const l=await o.json();if(console.log("Response data:",l),Qr(o,l,e),o.ok)try{const d=new RegExp(e.split("/")[1]),c=await _t.open("api-cache");if(c){const u=await c.keys();for(const h of u)d.test(h.url)&&await c.delete(h)}}catch(d){console.warn("Error al invalidar caché:",d)}return l}catch(s){if(console.log("🚨 Error en api.put:",s),s.response&&s.data){try{Qr(s.response,s.data,e)}catch(n){throw n}if(s.response.status===400&&Ke){const n=s.data;let i="Error de validación";throw n!=null&&n.details&&Array.isArray(n.details)?i=`Error de validación: ${n.details.map(l=>`${l.field}: ${l.message}`).join(", ")}`:n!=null&&n.message&&(i=n.message),Ke.showError(i,"Error de Validación"),new Error(i)}}throw ja(s),s}},delete:async e=>{try{const t=ra(),r=await yt(`${ea}${e}`,{method:"DELETE",headers:{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}}),s=await r.json();if(Qr(r,s,e),r.ok)try{const n=new RegExp(e.split("/")[1]),i=await _t.open("api-cache");if(i){const o=await i.keys();for(const l of o)n.test(l.url)&&await i.delete(l)}}catch(n){console.warn("Error al invalidar caché:",n)}return s}catch(t){if(console.log("🚨 Error en api.delete:",t),t.response&&t.data){try{Qr(t.response,t.data,e)}catch(r){throw r}if(t.response.status===400&&Ke){const r=t.data;let s="Error de validación";throw r!=null&&r.details&&Array.isArray(r.details)?s=`Error de validación: ${r.details.map(i=>`${i.field}: ${i.message}`).join(", ")}`:r!=null&&r.message&&(s=r.message),Ke.showError(s,"Error de Validación"),new Error(s)}}throw ja(t),t}},upload:async(e,t)=>{try{const r=ra(),s=await yt(`${ea}${e}`,{method:"POST",headers:{...r&&{Authorization:`Bearer ${r}`}},body:t}),n=await s.json();if(Qr(s,n,e),s.ok)try{const i=new RegExp(e.split("/")[1]),o=await _t.open("api-cache");if(o){const l=await o.keys();for(const d of l)i.test(d.url)&&await o.delete(d)}}catch(i){console.warn("Error al invalidar caché:",i)}return n}catch(r){if(console.log("🚨 Error en api.upload:",r),r.response&&r.data){try{Qr(r.response,r.data,e)}catch(s){throw s}if(r.response.status===400&&Ke){const s=r.data;let n="Error de validación";throw s!=null&&s.details&&Array.isArray(s.details)?n=`Error de validación: ${s.details.map(o=>`${o.field}: ${o.message}`).join(", ")}`:s!=null&&s.message&&(n=s.message),Ke.showError(n,"Error de Validación"),new Error(n)}}throw ja(r),r}}},Sr={getAppointments:()=>pe.get("/appointments",!0,6e4),getBarberAppointments:e=>pe.get(`/appointments/barber/${e}`,!0,6e4),createAppointment:e=>pe.post("/appointments",e),updateAppointment:(e,t)=>pe.put(`/appointments/${e}`,t),cancelAppointment:(e,t)=>pe.put(`/appointments/${e}/cancel`,{reason:t}),approveAppointment:e=>pe.put(`/appointments/${e}/approve`,{}),completeAppointment:e=>pe.put(`/appointments/${e}/complete`,{}),markNoShow:e=>pe.put(`/appointments/${e}/no-show`,{}),deleteAppointment:e=>pe.delete(`/appointments/${e}`),getAvailableTimes:(e,t)=>pe.get(`/appointments/availability/${e}?date=${t}&duration=30`)},ct={getAllBarbers:()=>pe.get("/barbers",!0,3e5),getBarberById:e=>pe.get(`/barbers/${e}`,!0,3e5),getBarberByUserId:e=>pe.get(`/barbers/by-user/${e}`,!0,3e5),createBarber:e=>pe.post("/barbers",e),updateBarber:(e,t)=>pe.put(`/barbers/${e}`,t),removeBarber:e=>pe.put(`/barbers/${e}/remove`),getBarberProfile:async()=>{const e=JSON.parse(localStorage.getItem("user")||"{}");if(!e._id)throw new Error("Usuario no autenticado");return pe.get(`/barbers/by-user/${e._id}`,!0,3e5)},updateBarberProfile:(e,t)=>pe.put(`/barbers/${e}`,t),updateMyProfile:async e=>{const t=JSON.parse(localStorage.getItem("user")||"{}");if(!t._id)throw new Error("Usuario no autenticado");const r=await pe.get(`/barbers/by-user/${t._id}`,!1),s=r.data||r;if(!s||!s._id)throw new Error("No se pudo obtener el ID del barbero");return pe.put(`/barbers/${s._id}/profile`,e)},getBarberStats:e=>pe.get(`/barbers/${e}/stats`,!0,9e5)},bt={getBarberSalesStats:(e,t={})=>{const r=new URLSearchParams(t).toString(),s=`/sales/barber/${e}/stats${r?`?${r}`:""}`;return pe.get(s,!0,3e5)},getAvailableDates:(e=null)=>e?pe.get(`/sales/barber/${e}/available-dates`,!0,3e5):pe.get("/sales/available-dates",!0,3e5),getDailyReport:(e,t=null)=>{const r=new URLSearchParams({date:e});return t&&r.append("barberId",t),pe.get(`/sales/daily-report?${r.toString()}`,!1)},getBarberRangeReport:(e,t,r)=>{const s=new URLSearchParams({type:e,date:t});return r&&s.append("barberId",r),pe.get(`/sales/reports?${s.toString()}`,!1)},createSale:e=>pe.post("/sales",e),createWalkInSale:e=>pe.post("/sales/walk-in",e)},ls={getBarberAppointmentStats:(e,t={})=>{const r=new URLSearchParams(t).toString(),s=`/appointments/barber/${e}/stats${r?`?${r}`:""}`;return pe.get(s,!0,3e5)},getAvailableDates:e=>pe.get(`/appointments/barber/${e}/available-dates`,!0,3e5),getDailyReport:(e,t=null)=>{const r=new URLSearchParams({date:e});return t&&r.append("barberId",t),pe.get(`/appointments/daily-report?${r.toString()}`,!1)}},Mn={getAllServices:()=>pe.get("/services",!0,3e5),getServiceById:e=>pe.get(`/services/${e}`,!0,3e5),createService:e=>pe.post("/services",e),updateService:(e,t)=>pe.put(`/services/${e}`,t),deleteService:e=>pe.delete(`/services/${e}`)},lt={getInventory:(e={})=>{const t=new URLSearchParams(e).toString();return pe.get(`/inventory${t?`?${t}`:""}`,!0,3e5)},getInventoryItem:e=>pe.get(`/inventory/${e}`,!0,3e5),createInventoryItem:e=>pe.post("/inventory",e),updateInventoryItem:(e,t)=>pe.put(`/inventory/${e}`,t),deleteInventoryItem:e=>pe.delete(`/inventory/${e}`),adjustStock:(e,t)=>pe.post(`/inventory/${e}/stock`,t),getLowStockItems:e=>pe.get(`/inventory/low-stock${e?`?threshold=${e}`:""}`,!0,3e5),getItemsByCategory:e=>pe.get(`/inventory/category/${e}`,!0,3e5),getMovementHistory:(e,t,r)=>{const s=new URLSearchParams;return t&&s.append("startDate",t),r&&s.append("endDate",r),pe.get(`/inventory/${e}/history${s.toString()?`?${s.toString()}`:""}`,!0,3e5)},getStats:()=>pe.get("/inventory/stats/overview",!0,3e5),getLogs:e=>pe.get(`/inventory/logs${e?`?${e}`:""}`,!0,6e4),getLogStats:(e,t)=>{const r=new URLSearchParams;return e&&r.append("startDate",e),t&&r.append("endDate",t),pe.get(`/inventory/logs/stats${r.toString()?`?${r.toString()}`:""}`,!0,3e5)},getDailyReport:e=>{const t=new URLSearchParams({date:e});return pe.get(`/inventory/daily-report?${t.toString()}`,!1)}},vs={createSnapshot:e=>pe.post("/inventory-snapshots",e),getSnapshots:(e={})=>{const t=new URLSearchParams(e).toString();return pe.get(`/inventory-snapshots${t?`?${t}`:""}`,!0,3e5)},getSnapshotById:e=>pe.get(`/inventory-snapshots/${e}`,!0,3e5),deleteSnapshot:e=>pe.delete(`/inventory-snapshots/${e}`),getStats:(e={})=>{const t=new URLSearchParams(e).toString();return pe.get(`/inventory-snapshots/stats${t?`?${t}`:""}`,!0,3e5)},downloadSnapshot:async e=>{try{const t=ra(),r=await yt(`${ea}/inventory-snapshots/${e}/download`,{method:"GET",headers:{...t&&{Authorization:`Bearer ${t}`}}});if(!r.ok)throw new Error(`Error al descargar: ${r.status}`);return r.blob()}catch(t){throw console.error("Error al descargar inventario guardado:",t),t}}},qt="https://thebrothersbarbershop.onrender.com/api/v1",Ec="1.0.0",wt=async(e,t,r=2,s=500)=>{try{t.headers={...t.headers,"X-Client-Version":Ec,"X-Request-ID":Math.random().toString(36).substring(7)};const n=performance.now(),i=await fetch(e,t),o=performance.now();if(i.status===429&&r>0)return await new Promise(c=>setTimeout(c,s)),wt(e,t,r-1,s*2);const l=i.headers.get("content-type");let d;if(l&&l.includes("application/json"))d=await i.json();else{const c=await i.text();console.error("Respuesta no JSON recibida:",c),d={message:"Error del servidor",error:c}}if(!i.ok)throw d.errors&&Array.isArray(d.errors)?new Error(d.errors.map(c=>c.msg).join(`
`)):i.status===401?new Error("Credenciales inválidas"):i.status===403?new Error("No tienes permiso para realizar esta acción"):new Error(d.message||"Error en la autenticación");return{response:i,data:d}}catch(n){if(r>0&&n.name==="TypeError")return await new Promise(i=>setTimeout(i,s)),wt(e,t,r-1,s*2);throw n}},Nt={register:async e=>{try{const{data:t}=await wt(`${qt}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return t}catch(t){throw console.error("Error en el registro:",t),new Error(t.message.includes("429")?"Demasiados intentos. Por favor, espera un momento.":t.message)}},login:async e=>{try{const{data:t,response:r}=await wt(`${qt}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return t.token&&(localStorage.setItem("token",t.token),t.user&&localStorage.setItem("user",JSON.stringify(t.user)),await La.clear()),t}catch(t){throw console.error("Error en el login:",t),new Error(t.message.includes("429")?"Demasiados intentos de inicio de sesión. Por favor, espera un momento.":t.message)}},logout:async()=>{try{const e=localStorage.getItem("token");if(e)try{await wt(`${qt}/auth/logout`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}})}catch(t){console.warn("Error en logout del servidor:",t)}}finally{localStorage.removeItem("token"),localStorage.removeItem("user"),await La.clear()}},verifyEmail:async e=>{try{const{data:t}=await wt(`${qt}/auth/verify-email/${e}`,{method:"GET"});return t}catch(t){throw console.error("Error en verificación de email:",t),new Error(t.message||"Error al verificar el email")}},requestPasswordReset:async e=>{try{const{data:t}=await wt(`${qt}/auth/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});return t}catch(t){throw console.error("Error en solicitud de reset de password:",t),new Error(t.message.includes("429")?"Demasiadas solicitudes. Por favor, espera unos minutos.":t.message)}},resetPassword:async(e,t)=>{try{const{data:r}=await wt(`${qt}/auth/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,newPassword:t})});return r}catch(r){throw console.error("Error en reset de password:",r),new Error(r.message||"Error al restablecer la contraseña")}},refreshToken:async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("No hay token para refrescar");const t=Nt.getCurrentUser();if(!t)throw new Error("No hay usuario autenticado");return{token:e,user:t}}catch(e){throw console.error("Error refreshing token:",e),await Nt.logout(),new Error("Tu sesión ha expirado. Por favor, inicia sesión nuevamente.")}},getCurrentUser:()=>{const e=localStorage.getItem("user");return e?JSON.parse(e):null}},Uo=O.createContext();function Sc({children:e}){const[t,r]=O.useState(()=>Nt.getCurrentUser()),[s,n]=O.useState(()=>localStorage.getItem("token")),[i,o]=O.useState(null),[l,d]=O.useState(!0),[c,u]=O.useState(null),[h,m]=O.useState(null),f=y=>{r(y),y?localStorage.setItem("user",JSON.stringify(y)):localStorage.removeItem("user")},g=O.useCallback(()=>{h&&clearInterval(h);const y=setInterval(async()=>{try{await Nt.refreshToken()}catch(S){console.error("Error al refrescar el token:",S),w()}},840*1e3);return m(y),()=>clearInterval(y)},[]);O.useEffect(()=>{(async()=>{if((t==null?void 0:t.role)==="barber"&&s&&t._id)try{const S=await ct.getBarberByUserId(t._id);o(S.data)}catch(S){console.error("Error al cargar perfil de barbero:",S),u("Error al cargar perfil de barbero")}d(!1)})()},[t==null?void 0:t._id,s]),O.useEffect(()=>{if(s){const y=g();return()=>{y(),h&&clearInterval(h)}}},[s]);const x=async y=>{try{let S=await ct.getBarberByUserId(y);return S.success||(S=await ct.createBarber({user:y})),o(S.data),S}catch(S){throw console.error("Error al verificar/crear perfil de barbero:",S),u("Error al gestionar perfil de barbero"),S}},p=async(y,S)=>{try{d(!0),u(null);const P=await Nt.login({email:y,password:S});if(!P.token||!P.user)throw new Error("Datos de autenticación inválidos");const L={...P.user,photo:P.user.photo||null,_id:P.user._id||P.user.id};return f(L),n(P.token),P.user.role==="barber"&&await x(P.user._id),g(),!0}catch(P){console.error("Error durante el login:",P);let L="Error al iniciar sesión";return P.message.includes("Credenciales inválidas")||P.message.includes("Invalid credentials")?L="Email o contraseña incorrectos":P.message.includes("usuario no encontrado")||P.message.includes("User not found")?L="Usuario no encontrado":(P.message.includes("network")||P.message.includes("fetch"))&&(L="Error de conexión. Verifica tu internet"),u(L),!1}finally{d(!1)}},w=async()=>{try{d(!0),await Nt.logout()}catch(y){console.error("Error durante el logout:",y)}finally{f(null),n(null),o(null),h&&clearInterval(h),d(!1)}},b={user:t,token:s,login:p,logout:w,setUser:f,barberProfile:i,setBarberProfile:o,checkAndCreateBarberProfile:x,loading:l,error:c,refreshToken:Nt.refreshToken};return a.jsx(Uo.Provider,{value:b,children:e})}function er(){const e=O.useContext(Uo);if(!e)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return e}const kc="h-14 sm:h-16",Tc=({user:e})=>{var s,n,i,o;const[t,r]=O.useState(!1);return O.useEffect(()=>{function l(d){d.target.closest(".dropdown-menu")||r(!1)}return t&&document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[t]),a.jsxs("div",{className:"relative dropdown-menu",children:[a.jsxs("button",{onClick:()=>r(!t),className:"flex items-center space-x-3 px-4 py-2 rounded-xl bg-white/10 hover:bg-white/20 backdrop-blur-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-transparent focus:ring-blue-400/50 hover:scale-105 border border-white/20",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[e.profilePicture?a.jsx("img",{src:e.profilePicture,alt:e.name||"Usuario",className:"w-8 h-8 rounded-full object-cover border-2 border-white/30 shadow-lg"}):a.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-red-600 to-blue-600 flex items-center justify-center text-white font-semibold shadow-lg",children:((n=(s=e.name)==null?void 0:s[0])==null?void 0:n.toUpperCase())||((o=(i=e.email)==null?void 0:i[0])==null?void 0:o.toUpperCase())||"?"}),a.jsx("span",{className:"text-sm font-medium bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent",children:e.name||e.email})]}),a.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 text-blue-300 ${t?"transform rotate-180":""}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),t&&a.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-gray-900/95 backdrop-blur-lg border border-white/20 rounded-2xl shadow-2xl py-2 z-50 transform opacity-100 scale-100 transition-all duration-200",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-white/10",children:[a.jsx("p",{className:"text-xs text-white/60 mb-1",children:"Conectado como"}),a.jsx("p",{className:"text-sm font-medium bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent truncate",children:e.email})]}),a.jsxs("div",{className:"py-2",children:[a.jsxs(Ae,{to:"/profile",onClick:()=>r(!1),className:"group flex items-center px-4 py-2.5 text-sm hover:bg-white/10 transition-all duration-200 rounded-lg mx-2",children:[a.jsx("svg",{className:"mr-3 h-4 w-4 text-blue-300 group-hover:text-blue-200 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),a.jsx("span",{className:"bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-red-100 group-hover:via-white group-hover:to-blue-100",children:"Mi Perfil"})]}),a.jsxs(Ae,{to:"/profile-edit",onClick:()=>r(!1),className:"group flex items-center px-4 py-2.5 text-sm hover:bg-white/10 transition-all duration-200 rounded-lg mx-2",children:[a.jsx("svg",{className:"mr-3 h-4 w-4 text-red-300 group-hover:text-red-200 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),a.jsx("span",{className:"bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-red-100 group-hover:via-white group-hover:to-blue-100",children:"Editar Perfil"})]})]}),(e.role==="admin"||e.role==="barber")&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"py-2 border-t border-white/10 mt-2",children:[a.jsx("div",{className:"px-4 py-2",children:a.jsx("p",{className:"text-xs font-medium bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent uppercase tracking-wider",children:e.role==="admin"?"Administración":"Gestión"})}),a.jsxs(Ae,{to:"/admin/inventory",onClick:()=>r(!1),className:"group flex items-center px-4 py-2.5 text-sm hover:bg-white/10 transition-all duration-200 rounded-lg mx-2",children:[a.jsx("svg",{className:"mr-3 h-4 w-4 text-blue-300 group-hover:text-blue-200 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),a.jsx("span",{className:"bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-blue-100 group-hover:via-white group-hover:to-red-100",children:"Control de Inventario"})]}),e.role==="admin"&&a.jsxs(a.Fragment,{children:[a.jsxs(Ae,{to:"/admin/sales",onClick:()=>r(!1),className:"group flex items-center px-4 py-2.5 text-sm hover:bg-white/10 transition-all duration-200 rounded-lg mx-2",children:[a.jsx("svg",{className:"mr-3 h-4 w-4 text-green-300 group-hover:text-green-200 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5L2 21m5-8v8a2 2 0 002 2h10a2 2 0 002-2v-8m-9 2V9a2 2 0 012-2h2a2 2 0 012 2v4.01"})}),a.jsx("span",{className:"bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-green-100 group-hover:via-white group-hover:to-green-100",children:"Punto de Venta"})]}),a.jsxs(Ae,{to:"/admin/services",onClick:()=>r(!1),className:"group flex items-center px-4 py-2.5 text-sm hover:bg-white/10 transition-all duration-200 rounded-lg mx-2",children:[a.jsx("svg",{className:"mr-3 h-4 w-4 text-red-300 group-hover:text-red-200 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),a.jsx("span",{className:"bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-red-100 group-hover:via-white group-hover:to-blue-100",children:"Gestión de Servicios"})]}),a.jsxs(Ae,{to:"/admin/barbers",onClick:()=>r(!1),className:"group flex items-center px-4 py-2.5 text-sm hover:bg-white/10 transition-all duration-200 rounded-lg mx-2",children:[a.jsx("svg",{className:"mr-3 h-4 w-4 text-blue-300 group-hover:text-blue-200 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),a.jsx("span",{className:"bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-blue-100 group-hover:via-white group-hover:to-red-100",children:"Gestión de Barberos"})]}),a.jsxs(Ae,{to:"/admin/roles",onClick:()=>r(!1),className:"group flex items-center px-4 py-2.5 text-sm hover:bg-white/10 transition-all duration-200 rounded-lg mx-2",children:[a.jsx("svg",{className:"mr-3 h-4 w-4 text-red-300 group-hover:text-red-200 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),a.jsx("span",{className:"bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-red-100 group-hover:via-white group-hover:to-blue-100",children:"Gestión de Roles"})]}),a.jsxs(Ae,{to:"/admin/reports",onClick:()=>r(!1),className:"group flex items-center px-4 py-2.5 text-sm hover:bg-white/10 transition-all duration-200 rounded-lg mx-2",children:[a.jsx("svg",{className:"mr-3 h-4 w-4 text-green-300 group-hover:text-green-200 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),a.jsx("span",{className:"bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-green-100 group-hover:via-white group-hover:to-blue-100",children:"Reportes Diarios"})]})]})]})})]})]})},Cc=()=>{var h,m,f,g;const{user:e,logout:t}=er(),r=Ya(),s=Tn(),[n,i]=O.useState(!1),[o,l]=O.useState(!1),[d,c]=O.useState(!1);O.useEffect(()=>{const x=()=>{i(window.scrollY>10)};return window.addEventListener("scroll",x),()=>window.removeEventListener("scroll",x)},[]),O.useEffect(()=>{l(!1)},[s.pathname]);const u=()=>{t(),r("/")};return a.jsxs("nav",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${n?"bg-gradient-to-r from-gray-900/95 via-blue-900/95 to-gray-800/95 shadow-2xl":"bg-gradient-to-r from-gray-900/90 via-blue-900/90 to-gray-800/90"} backdrop-blur-lg ${kc}`,children:[a.jsx("div",{className:"absolute inset-0 bg-black/20"}),a.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`radial-gradient(circle at 25% 25%, #1e40af 0px, transparent 2px),
                         radial-gradient(circle at 75% 75%, #dc2626 0px, transparent 1px),
                         radial-gradient(circle at 50% 50%, #ffffff 0px, transparent 0.5px)`,backgroundSize:"50px 50px, 30px 30px, 20px 20px"}}),a.jsx("div",{className:"absolute top-0 w-full h-1 bg-gradient-to-r from-red-600 via-white to-blue-600"}),a.jsx("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full",children:a.jsxs("div",{className:"flex justify-between items-center h-full",children:[a.jsxs(Ae,{to:"/",className:"flex items-center space-x-3 group",children:[d?a.jsx("div",{className:"bg-white/10 backdrop-blur-sm p-2 rounded-full shadow-lg transform group-hover:scale-105 transition-transform duration-200 border border-white/20",children:a.jsx("span",{className:"text-lg font-bold bg-gradient-to-r from-red-400 via-white to-blue-400 bg-clip-text text-transparent",children:"TBB"})}):a.jsx("img",{src:"/images/logo 5.1.png",alt:"The Brothers Barber Shop",className:"h-12 w-auto transform group-hover:scale-105 transition-transform duration-200",onError:()=>c(!0)}),a.jsxs("div",{children:[a.jsx("span",{className:"text-2xl sm:text-3xl font-black bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-red-100 group-hover:via-white group-hover:to-blue-100 transition-all duration-300",style:{textShadow:"2px 2px 4px rgba(0,0,0,0.3)"},children:"The Brother's"}),a.jsx("div",{className:"text-xs text-white/80 font-serif italic mt-0.5",children:"Barber Shop"})]})]}),a.jsxs("div",{className:"hidden md:flex items-center space-x-6",children:[e&&a.jsx(a.Fragment,{children:e.role==="barber"?a.jsxs(Ae,{to:"/admin/sales",className:"relative px-4 py-2 font-medium text-sm group",children:[a.jsx("span",{className:"relative z-10 bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-red-100 group-hover:via-white group-hover:to-blue-100 transition-all duration-300",children:"Punto de Venta"}),a.jsx("div",{className:"absolute inset-0 h-full w-full transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-200 bg-gradient-to-r from-red-500/20 to-blue-500/20 rounded-lg"}),a.jsx("div",{className:"absolute bottom-0 left-0 h-0.5 w-full bg-gradient-to-r from-red-600 to-blue-600 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-200"})]}):a.jsxs(Ae,{to:"/barbers",className:"relative px-4 py-2 font-medium text-sm group",children:[a.jsx("span",{className:"relative z-10 bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-red-100 group-hover:via-white group-hover:to-blue-100 transition-all duration-300",children:"Barberos"}),a.jsx("div",{className:"absolute inset-0 h-full w-full transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-200 bg-gradient-to-r from-red-500/20 to-blue-500/20 rounded-lg"}),a.jsx("div",{className:"absolute bottom-0 left-0 h-0.5 w-full bg-gradient-to-r from-red-600 to-blue-600 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-200"})]})}),e?a.jsxs("div",{className:"flex items-center space-x-6",children:[a.jsxs(Ae,{to:"/appointment",className:"relative px-4 py-2 font-medium text-sm group",children:[a.jsx("span",{className:"relative z-10 bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-red-100 group-hover:via-white group-hover:to-blue-100 transition-all duration-300",children:"Reservas"}),a.jsx("div",{className:"absolute inset-0 h-full w-full transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-200 bg-gradient-to-r from-blue-500/20 to-red-500/20 rounded-lg"})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(Tc,{user:e}),a.jsx("button",{onClick:u,className:"relative inline-flex items-center justify-center px-4 py-2.5 overflow-hidden rounded-xl group bg-red-500/20 border border-red-400/30 hover:bg-red-500/30 transition-all duration-300 hover:scale-105 backdrop-blur-sm",children:a.jsx("span",{className:"relative bg-gradient-to-r from-red-200 via-red-100 to-red-200 bg-clip-text text-transparent group-hover:from-white group-hover:via-red-100 group-hover:to-white font-medium",children:"Salir"})})]})]}):a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs(Ae,{to:"/login",className:"relative overflow-hidden px-6 py-2.5 rounded-xl group bg-gradient-to-r from-red-600 to-blue-600 hover:from-red-700 hover:to-blue-700 shadow-lg hover:shadow-xl hover:shadow-red-500/25 transition-all duration-300 hover:scale-105",children:[a.jsx("span",{className:"relative z-10 bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent font-medium",children:"Iniciar Sesión"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-red-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),a.jsx(Ae,{to:"/register",className:"relative overflow-hidden px-6 py-2.5 rounded-xl group border-2 border-white/20 hover:border-red-400/50 transition-all duration-300 backdrop-blur-sm bg-white/5 hover:bg-white/10 hover:scale-105",children:a.jsx("span",{className:"relative z-10 bg-gradient-to-r from-white via-blue-100 to-red-100 bg-clip-text text-transparent group-hover:from-red-100 group-hover:via-white group-hover:to-blue-100 transition-all duration-300 font-medium",children:"Registro"})})]})]}),a.jsx("div",{className:"md:hidden",children:a.jsxs("button",{className:"md:hidden ml-2 inline-flex items-center justify-center p-2.5 rounded-xl bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-transparent focus:ring-blue-400/50 hover:scale-105",onClick:()=>l(!o),"aria-expanded":"false",children:[a.jsx("span",{className:"sr-only",children:"Abrir menú principal"}),o?a.jsx("svg",{className:"block h-5 w-5 text-purple-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}):a.jsx("svg",{className:"block h-5 w-5 text-blue-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})]})})]})}),a.jsx("div",{className:`md:hidden transition-all duration-300 ease-in-out ${o?"opacity-100 max-h-screen":"opacity-0 max-h-0 pointer-events-none overflow-hidden"}`,children:a.jsxs("div",{className:"mx-4 my-2 bg-gradient-to-br from-gray-900/95 to-gray-800/95 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900/30 via-black/20 to-gray-900/30",children:[a.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-red-500/5 via-transparent to-blue-500/5"}),a.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='80' height='80' viewBox='0 0 80 80' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239BA9B4' fill-opacity='0.05'%3E%3Cpath d='M40 44v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V10h-2v4h-4v2h4v4h2v-4h4v-2h-4zM20 44v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zM20 14v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),a.jsx("div",{className:"absolute inset-0",style:{background:`
                linear-gradient(to right, rgba(17, 24, 39, 0.3) 0px, transparent 2px, transparent calc(100% - 2px), rgba(17, 24, 39, 0.3) 100%),
                linear-gradient(to bottom, rgba(17, 24, 39, 0.3) 0px, transparent 2px, transparent calc(100% - 2px), rgba(17, 24, 39, 0.3) 100%)
              `}})]}),a.jsxs("div",{className:"relative z-10 p-4",children:[e&&a.jsx("div",{className:"mb-4 pb-4 border-b border-gray-700/50",children:a.jsxs("div",{className:"flex items-center gap-3",children:[e.profilePicture?a.jsx("img",{src:e.profilePicture,alt:e.name||"Usuario",className:"w-10 h-10 rounded-full object-cover border-2 border-white/30 shadow-lg"}):a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-red-600 to-blue-600 flex items-center justify-center text-white font-semibold shadow-lg",children:((m=(h=e.name)==null?void 0:h[0])==null?void 0:m.toUpperCase())||((g=(f=e.email)==null?void 0:f[0])==null?void 0:g.toUpperCase())||"?"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-white",children:e.name||e.email}),a.jsx("p",{className:"text-xs text-gray-400",children:e.role==="admin"?"Administrador":e.role==="barber"?"Barbero":"Cliente"})]})]})}),a.jsx("div",{className:"space-y-2",children:e?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-1",children:[e.role==="barber"?a.jsxs(Ae,{to:"/admin/sales",className:"group flex items-center px-4 py-3 rounded-xl text-base font-medium hover:bg-white/10 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-green-400 group-hover:text-green-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5L2 21m5-8v8a2 2 0 002 2h10a2 2 0 002-2v-8m-9 2V9a2 2 0 012-2h2a2 2 0 012 2v4.01"})}),a.jsx("span",{className:"text-white group-hover:text-green-300 transition-colors",children:"Punto de Venta"})]}):a.jsxs(Ae,{to:"/barbers",className:"group flex items-center px-4 py-3 rounded-xl text-base font-medium hover:bg-white/10 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-blue-400 group-hover:text-blue-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),a.jsx("span",{className:"text-white group-hover:text-blue-300 transition-colors",children:"Barberos"})]}),a.jsxs(Ae,{to:"/appointment",className:"group flex items-center px-4 py-3 rounded-xl text-base font-medium hover:bg-white/10 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-blue-400 group-hover:text-blue-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),a.jsx("span",{className:"text-white group-hover:text-blue-300 transition-colors",children:"Reservas"})]})]}),a.jsxs("div",{className:"pt-2 border-t border-gray-700/30",children:[a.jsx("p",{className:"px-4 py-2 text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Perfil"}),a.jsxs(Ae,{to:"/profile",className:"group flex items-center px-4 py-3 rounded-xl text-base font-medium hover:bg-white/10 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-blue-400 group-hover:text-blue-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),a.jsx("span",{className:"text-white group-hover:text-blue-300 transition-colors",children:"Mi Perfil"})]}),a.jsxs(Ae,{to:"/profile-edit",className:"group flex items-center px-4 py-3 rounded-xl text-base font-medium hover:bg-white/10 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-red-400 group-hover:text-red-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),a.jsx("span",{className:"text-white group-hover:text-red-300 transition-colors",children:"Editar Perfil"})]})]}),(e.role==="admin"||e.role==="barber")&&a.jsxs("div",{className:"pt-2 border-t border-gray-700/30",children:[a.jsx("p",{className:"px-4 py-2 text-xs font-medium text-gray-400 uppercase tracking-wider",children:e.role==="admin"?"Administración":"Gestión"}),a.jsxs(Ae,{to:"/admin/inventory",className:"group flex items-center px-4 py-3 rounded-xl text-base font-medium hover:bg-white/10 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-blue-400 group-hover:text-blue-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),a.jsx("span",{className:"text-white group-hover:text-blue-300 transition-colors",children:"Control de Inventario"})]}),e.role==="admin"&&a.jsxs(a.Fragment,{children:[a.jsxs(Ae,{to:"/admin/sales",className:"group flex items-center px-4 py-3 rounded-xl text-base font-medium hover:bg-white/10 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-green-400 group-hover:text-green-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5L2 21m5-8v8a2 2 0 002 2h10a2 2 0 002-2v-8m-9 2V9a2 2 0 012-2h2a2 2 0 012 2v4.01"})}),a.jsx("span",{className:"text-white group-hover:text-green-300 transition-colors",children:"Punto de Venta"})]}),a.jsxs(Ae,{to:"/admin/services",className:"group flex items-center px-4 py-3 rounded-xl text-base font-medium hover:bg-white/10 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-red-400 group-hover:text-red-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),a.jsx("span",{className:"text-white group-hover:text-red-300 transition-colors",children:"Gestión de Servicios"})]}),a.jsxs(Ae,{to:"/admin/barbers",className:"group flex items-center px-4 py-3 rounded-xl text-base font-medium hover:bg-white/10 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-blue-400 group-hover:text-blue-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),a.jsx("span",{className:"text-white group-hover:text-blue-300 transition-colors",children:"Gestión de Barberos"})]}),a.jsxs(Ae,{to:"/admin/roles",className:"group flex items-center px-4 py-3 rounded-xl text-base font-medium hover:bg-white/10 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-red-400 group-hover:text-red-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),a.jsx("span",{className:"text-white group-hover:text-red-300 transition-colors",children:"Gestión de Roles"})]}),a.jsxs(Ae,{to:"/admin/reports",className:"group flex items-center px-4 py-3 rounded-xl text-base font-medium hover:bg-white/10 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-green-400 group-hover:text-green-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),a.jsx("span",{className:"text-white group-hover:text-green-300 transition-colors",children:"Reportes Diarios"})]})]})]}),a.jsx("div",{className:"pt-2 border-t border-gray-700/30",children:a.jsxs("button",{onClick:u,className:"group flex items-center w-full px-4 py-3 rounded-xl text-base font-medium hover:bg-red-500/20 transition-all duration-200",children:[a.jsx("svg",{className:"mr-3 h-5 w-5 text-red-400 group-hover:text-red-300 transition-colors",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),a.jsx("span",{className:"text-white group-hover:text-red-300 transition-colors",children:"Cerrar Sesión"})]})})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsx(Ae,{to:"/login",className:"block w-full text-center px-6 py-3 rounded-xl bg-gradient-to-r from-red-600 to-blue-600 hover:from-red-700 hover:to-blue-700 transition-all duration-200 shadow-lg transform hover:scale-105",children:a.jsx("span",{className:"text-white font-medium",children:"Iniciar Sesión"})}),a.jsx(Ae,{to:"/register",className:"block w-full text-center px-6 py-3 rounded-xl border-2 border-white/20 hover:border-red-400/50 hover:bg-white/10 transition-all duration-200 backdrop-blur-sm transform hover:scale-105",children:a.jsx("span",{className:"text-white font-medium",children:"Registro"})})]})})]})]})})]})},Ac=()=>a.jsxs("div",{className:"relative min-h-screen bg-gradient-to-b from-black via-gray-900 to-black overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-900/3 via-blue-900/3 to-red-900/3"}),a.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.15) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-8",style:{backgroundImage:"radial-gradient(circle, rgba(239, 68, 68, 0.12) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-6",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.1) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}}),a.jsxs("div",{className:"relative z-10",children:[a.jsx(Cc,{}),a.jsx("main",{className:"container mx-auto px-4 py-8 shadow-lg shadow-blue-500/20 rounded-lg",children:a.jsx(yn,{})})]})]}),$o=O.createContext(),Er=()=>{const e=O.useContext($o);if(!e)throw new Error("useNotification debe ser usado dentro de NotificationProvider");return e},Dc=({children:e})=>{const[t,r]=O.useState([]),s=g=>{const x=Date.now()+Math.random(),p={id:x,type:"info",title:"",message:"",duration:5e3,autoClose:!0,...g};return t.some(b=>b.message===p.message&&b.type===p.type&&Date.now()-b.id<1e3)?(console.log("Notificación duplicada ignorada:",p.message),x):(r(b=>[...b,p]),p.autoClose&&setTimeout(()=>{n(x)},p.duration),x)},n=g=>{r(x=>x.filter(p=>p.id!==g))},f={notifications:t,addNotification:s,removeNotification:n,clearAllNotifications:()=>{r([])},showSuccess:(g,x="Éxito")=>s({type:"success",title:x,message:g,duration:4e3}),showError:(g,x="Error")=>s({type:"error",title:x,message:g,duration:8e3}),showWarning:(g,x="Advertencia")=>s({type:"warning",title:x,message:g,duration:6e3}),showInfo:(g,x="Información")=>s({type:"info",title:x,message:g,duration:5e3}),showSessionExpired:()=>s({type:"warning",title:"Sesión Expirada",message:"Tu sesión ha expirado. Serás redirigido al login en unos segundos...",duration:4e3,autoClose:!0}),showConnectionError:()=>s({type:"error",title:"Error de Conexión",message:"No se pudo conectar con el servidor. Verifica tu conexión a internet.",duration:8e3,autoClose:!0}),showAuthRequired:()=>s({type:"info",title:"Autenticación Requerida",message:"Necesitas iniciar sesión para acceder a esta función. Redirigiendo...",duration:4e3,autoClose:!0})};return a.jsx($o.Provider,{value:f,children:e})},Fc=()=>{const{notifications:e,removeNotification:t}=Er();if(e.length===0)return null;const r=i=>{const o="relative overflow-hidden backdrop-blur-md border rounded-lg shadow-lg transition-all duration-300 ease-in-out transform";switch(i){case"success":return`${o} bg-green-500/10 border-green-500/30 text-green-100`;case"error":return`${o} bg-red-500/10 border-red-500/30 text-red-100`;case"warning":return`${o} bg-yellow-500/10 border-yellow-500/30 text-yellow-100`;case"info":default:return`${o} bg-blue-500/10 border-blue-500/30 text-blue-100`}},s=i=>{switch(i){case"success":return a.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"error":return a.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});case"warning":return a.jsx("svg",{className:"w-5 h-5 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.268 16.5c-.77.833.192 2.5 1.732 2.5z"})});case"info":default:return a.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},n=i=>{switch(i){case"success":return"bg-green-400";case"error":return"bg-red-400";case"warning":return"bg-yellow-400";case"info":default:return"bg-blue-400"}};return a.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm w-full",children:e.map(i=>a.jsxs("div",{className:r(i.type),role:"alert",children:[i.autoClose&&a.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-gray-600 w-full",children:a.jsx("div",{className:`h-full ${n(i.type)} transition-all ease-linear`,style:{animation:`shrink ${i.duration}ms linear forwards`}})}),a.jsx("div",{className:"p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:s(i.type)}),a.jsxs("div",{className:"ml-3 w-0 flex-1",children:[i.title&&a.jsx("p",{className:"text-sm font-medium",children:i.title}),a.jsx("p",{className:`text-sm ${i.title?"mt-1":""}`,children:i.message})]}),a.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:a.jsx("button",{onClick:()=>t(i.id),className:"inline-flex text-gray-400 hover:text-gray-300 focus:outline-none focus:text-gray-300 transition-colors duration-200",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]})})]},i.id))})},Pc=()=>{const e=Er();return O.useEffect(()=>(Oi(e),()=>{Oi(null)}),[e]),e},zo=O.createContext(),Ho=()=>{const e=O.useContext(zo);if(!e)throw new Error("useInventoryRefresh debe ser usado dentro de InventoryProvider");return e},Oc=({children:e})=>{const[t,r]=O.useState(0),[s,n]=O.useState(null),i=O.useCallback(()=>{const c=Date.now();n(c),r(u=>u+1),console.log("🔄 InventoryContext: Notificando venta, trigger:",t+1)},[t]),o=O.useCallback(c=>!s||!c?!1:s>c,[s]),l=O.useCallback(()=>Date.now(),[]),d={refreshTrigger:t,lastSaleTime:s,notifySale:i,needsRefresh:o,markRefreshed:l};return a.jsx(zo.Provider,{value:d,children:e})},He=({children:e,variant:t="primary",size:r="md",gradient:s="barber",loading:n=!1,disabled:i=!1,className:o="",onClick:l,type:d="button",loadingText:c="Cargando...",...u})=>{const[h,m]=O.useState(!1),g={sm:"text-sm px-4 py-2",md:"text-base px-6 py-3",lg:"text-xl px-8 py-4",xl:"text-2xl px-10 py-5"}[r];return a.jsxs("button",{type:d,onClick:l,disabled:i||n,"aria-disabled":i||n,onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),className:`
        relative isolate inline-flex items-center justify-center whitespace-nowrap
        rounded-2xl font-semibold tracking-wide 
        shadow-[0_4px_12px_rgba(0,0,0,0.2)] border border-slate-600/40
        outline-none transition-all duration-400 overflow-hidden
        active:scale-[0.98] focus:ring-3 focus:ring-blue-400/40
        bg-slate-600 min-w-fit
        ${g}
        ${i||n?"opacity-60 cursor-not-allowed":"hover:shadow-[0_8px_20px_rgba(220,38,38,0.15)] hover:scale-[1.01]"}
        ${o}
      `,...u,children:[a.jsxs("span",{className:"relative z-10 flex items-center justify-center space-x-2",children:[n&&a.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2 text-white/90",viewBox:"0 0 24 24",fill:"none",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 714 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a.jsx("span",{className:"relative",children:t==="outline"?a.jsx("span",{className:"font-extrabold bg-gradient-to-r from-red-400 via-white to-blue-400 bg-clip-text text-transparent",children:n?c:e}):a.jsx("span",{className:"font-bold tracking-wide",style:{color:"#1e293b",textShadow:`
                  0 1px 2px rgba(255, 255, 255, 0.3),
                  0 0 4px rgba(255, 255, 255, 0.2)
                `,filter:"contrast(1.2)",letterSpacing:"0.02em"},children:n?c:e})})]}),t==="primary"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{"aria-hidden":!0,className:"absolute inset-0 rounded-2xl",style:{background:`repeating-linear-gradient(
                -45deg,
                #a84949ff 0px,
                #e75757 12.5px,
                #dc2626 25px,
                #ffffff 25px,
                #ffffff 50px,
                #2563eb 50px,
                #4e7beb 62.5px,
                #2563eb 75px,
                #ffffff 75px,
                #ffffff 100px
              )`,backgroundSize:"141.42px 141.42px",animation:h?"barberPoleSynced 3s linear infinite":"none",opacity:.95,border:"2px solid rgba(59, 130, 246, 0.6)",boxShadow:`
                0 0 15px rgba(59, 130, 246, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1)
              `},children:a.jsx("span",{className:"absolute inset-0 rounded-2xl",style:{background:`linear-gradient(
                  135deg,
                  rgba(0, 0, 0, 0.05) 0%,
                  transparent 50%,
                  rgba(255, 255, 255, 0.05) 100%
                )`,mixBlendMode:"soft-light"}})}),a.jsx("style",{children:`
            @keyframes barberPoleSynced {
              0% {
                background-position: 0px 0px;
              }
              100% {
                background-position: 141.42px 0px;
              }
            }
          `})]}),t==="secondary"&&a.jsx("span",{"aria-hidden":!0,className:"absolute inset-0 rounded-2xl bg-[#1a1f3c]/80 backdrop-blur-md"}),t==="outline"&&a.jsx("span",{"aria-hidden":!0,className:"absolute inset-0 rounded-2xl bg-transparent"}),t==="ghost"&&a.jsx("span",{"aria-hidden":!0,className:"absolute inset-0 rounded-2xl bg-white/5 backdrop-blur-md"}),a.jsx("span",{"aria-hidden":!0,className:"absolute inset-0 rounded-2xl overflow-hidden pointer-events-none",children:a.jsx("span",{className:"absolute inset-0 rounded-2xl",style:{background:`linear-gradient(
              to bottom,
              rgba(255, 255, 255, 0.08) 0%,
              rgba(255, 255, 255, 0.03) 40%,
              transparent 100%
            )`,transition:"opacity 400ms ease",opacity:h?.7:.5}})})]})},Ye=({children:e,className:t=""})=>a.jsxs("div",{className:`relative min-h-screen w-full pt-10 sm:pt-12 bg-gradient-to-b from-black via-gray-900 to-black overflow-hidden ${t}`,style:{isolation:"isolate"},children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-900/3 via-blue-900/3 to-red-900/3"}),a.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.15) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-8",style:{backgroundImage:"radial-gradient(circle, rgba(239, 68, 68, 0.12) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-6",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.1) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}}),a.jsx("div",{className:"relative z-10",children:e})]}),Mc=({barber:e})=>{var n,i,o,l;const t=d=>{d.target.onerror=null,d.target.src="/images/default-profile.png",d.target.classList.add("fallback-image")},r=d=>{if(!d)return null;if(typeof d=="object"){const c=d.average||0,u=d.count||0;return`${c.toFixed(1)} (${u})`}return d},s=e.user||{};return a.jsxs("div",{className:"group relative overflow-hidden rounded-2xl transform hover:scale-105 transition-all duration-300 bg-gradient-to-br from-gray-800 via-gray-900 to-blue-900",children:[a.jsx("div",{className:"aspect-[4/5] w-full relative",children:(n=s.photo)!=null&&n.url||(i=e.photo)!=null&&i.url?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:((o=s.photo)==null?void 0:o.url)||((l=e.photo)==null?void 0:l.url),alt:s.name||"Barbero",className:"w-full h-full object-cover opacity-90 group-hover:opacity-100 transition-opacity",onError:t}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"})]}):a.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-800 via-blue-900/50 to-gray-900",children:a.jsx("div",{className:"p-4 rounded-full bg-blue-600/10 backdrop-blur",children:a.jsx("svg",{className:"w-20 h-20 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})})}),a.jsx("div",{className:"absolute inset-0 flex flex-col justify-end p-6",children:a.jsx("div",{className:"transform transition-transform group-hover:translate-y-0 translate-y-4",children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-blue-400 transition-colors",children:s.name||e.name||"Nombre no disponible"}),a.jsx("p",{className:"text-gray-300 text-sm",children:e.specialty||"Barbero Profesional"}),a.jsxs("div",{className:"flex flex-wrap gap-2 opacity-0 group-hover:opacity-100 transition-all duration-300 delay-100",children:[e.experience&&a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-blue-900/50 text-blue-200 border border-blue-700 backdrop-blur-sm",children:[e.experience," de experiencia"]}),r(e==null?void 0:e.rating)&&a.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-blue-900/50 text-blue-200 border border-blue-700 backdrop-blur-sm",children:[a.jsx("svg",{className:"w-4 h-4 mr-1 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),r(e.rating)]})]})]})})})]})};function Ic(){const[e,t]=O.useState([]),[r,s]=O.useState([]),[n,i]=O.useState(!0),[o,l]=O.useState(null),[d,c]=O.useState(!1),{user:u,accessToken:h}=er();return O.useEffect(()=>{if(d)return;(async()=>{try{console.log("Iniciando fetch de datos...");const[f,g]=await Promise.all([pe.get("/services"),pe.get("/barbers")]);if(console.log("Respuesta de servicios:",f),console.log("Respuesta de barberos:",g),!f.success||!g.success)throw new Error("Error al cargar los datos");const x=f.data||[],p=g.data||[];console.log("Datos de barberos recibidos:",p);const w=p.filter(b=>(console.log("Evaluando barbero:",b),b.user&&b.user.role==="barber"&&b.user.isActive!==!1&&b.isActive!==!1));console.log("Barberos activos filtrados:",w),t(x.slice(0,6)),s(w),c(!0)}catch(f){console.error("Error completo:",f),l(f.message)}finally{i(!1)}})()},[]),a.jsxs(Ye,{children:[!u&&a.jsxs("div",{className:"relative min-h-screen flex flex-col",children:[a.jsxs("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900/30 via-black/20 to-gray-900/30",children:[a.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-red-500/5 via-transparent to-blue-500/5"}),a.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='80' height='80' viewBox='0 0 80 80' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239BA9B4' fill-opacity='0.05'%3E%3Cpath d='M40 44v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V10h-2v4h-4v2h4v4h2v-4h4v-2h-4zM20 44v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zM20 14v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),a.jsx("div",{className:"absolute inset-0",style:{background:`
                                linear-gradient(to right, rgba(17, 24, 39, 0.3) 0px, transparent 2px, transparent calc(100% - 2px), rgba(17, 24, 39, 0.3) 100%),
                                linear-gradient(to bottom, rgba(17, 24, 39, 0.3) 0px, transparent 2px, transparent calc(100% - 2px), rgba(17, 24, 39, 0.3) 100%)
                            `}})]}),a.jsx("div",{className:"relative z-10 flex-1 flex items-center justify-center px-4 sm:px-6 py-8 sm:py-12",children:a.jsxs("div",{className:"text-center max-w-6xl mx-auto",children:[a.jsxs("div",{className:"mb-8 sm:mb-12",children:[a.jsxs("div",{className:"relative mx-auto w-48 sm:w-56 md:w-64 lg:w-72 xl:w-80 mb-6 sm:mb-8 transform hover:scale-105 transition-all duration-500",children:[a.jsx("img",{src:"/images/logo 1.png",alt:"The Brothers Barber Shop",className:"w-full h-auto filter drop-shadow-[0_0_30px_rgba(59,130,246,0.6)]",onError:m=>{m.target.style.display="none",m.target.nextElementSibling.style.display="block"}}),a.jsx("div",{className:"hidden text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-black text-center tracking-tight",style:{textShadow:"0 0 30px rgba(59, 130, 246, 0.6)"},children:a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-blue-200 to-blue-400",children:"The Brothers"})})]}),a.jsxs("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-4xl xl:text-5xl font-bold mb-4 sm:mb-6 leading-tight px-2",children:[a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-red-400 via-white to-blue-400",children:"Donde el estilo se encuentra"}),a.jsx("br",{}),a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-white to-red-400",children:"con la tradición"})]})]}),a.jsxs("div",{className:"mb-8 sm:mb-12 space-y-6 sm:space-y-8 px-2",children:[a.jsxs("p",{className:"text-lg sm:text-xl lg:text-2xl text-gray-300 max-w-3xl mx-auto leading-relaxed",children:["Experimenta un corte de pelo que define tu personalidad.",a.jsx("span",{className:"block mt-2 text-blue-400 font-medium",children:"Tradición, calidad y estilo en cada corte."})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-sm rounded-xl sm:rounded-2xl p-4 sm:p-6 border border-gray-700/30 hover:border-red-500/30 transition-all duration-300",children:[a.jsx("div",{className:"mb-3 sm:mb-4 mx-auto w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-r from-red-600/20 to-blue-600/20 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("h3",{className:"font-bold text-white mb-2 text-sm sm:text-base",children:"Reservas Online"}),a.jsx("p",{className:"text-gray-400 text-xs sm:text-sm",children:"Agenda tu cita 24/7"})]}),a.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-sm rounded-xl sm:rounded-2xl p-4 sm:p-6 border border-gray-700/30 hover:border-blue-500/30 transition-all duration-300",children:[a.jsx("div",{className:"mb-3 sm:mb-4 mx-auto w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-r from-blue-600/20 to-red-600/20 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})})}),a.jsx("h3",{className:"font-bold text-white mb-2 text-sm sm:text-base",children:"Barberos Expertos"}),a.jsx("p",{className:"text-gray-400 text-xs sm:text-sm",children:"Profesionales certificados"})]}),a.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-sm rounded-xl sm:rounded-2xl p-4 sm:p-6 border border-gray-700/30 hover:border-red-500/30 transition-all duration-300",children:[a.jsx("div",{className:"mb-3 sm:mb-4 mx-auto w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-r from-red-600/20 to-blue-600/20 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),a.jsx("h3",{className:"font-bold text-white mb-2 text-sm sm:text-base",children:"Calidad Premium"}),a.jsx("p",{className:"text-gray-400 text-xs sm:text-sm",children:"Los mejores productos"})]})]})]}),a.jsxs("div",{className:"space-y-4 sm:space-y-6 px-2",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx(He,{variant:"primary",size:"lg",className:"inline-flex items-center justify-center whitespace-nowrap px-6 sm:px-8 py-3 sm:py-4 text-base sm:text-lg font-semibold rounded-xl sm:rounded-2xl shadow-lg transform hover:scale-105 transition-all duration-300 min-w-fit",onClick:()=>window.location.href="/appointment",children:a.jsxs("span",{className:"flex items-center gap-2 sm:gap-3",children:[a.jsx("span",{className:"hidden sm:inline",children:"Reserva tu cita ahora"}),a.jsx("span",{className:"sm:hidden",children:"Reservar cita"}),a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transform group-hover:translate-x-1 transition-transform flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3 sm:gap-4 lg:gap-8 text-xs sm:text-sm text-gray-400",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Sin compromiso"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Cancelación gratuita"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Confirmación inmediata"]})]})]})]})}),a.jsx("div",{className:"relative z-10 pb-8 flex justify-center",children:a.jsx("div",{className:"animate-bounce",children:a.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})})]}),a.jsxs("section",{className:`${u?"py-6 sm:py-8 lg:py-12":"py-16 sm:py-24 lg:py-32"} px-4 relative bg-gradient-to-b from-black via-gray-900 to-black`,children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-900/8 via-blue-900/8 to-red-900/8"}),a.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%235a67d8' fill-opacity='0.1'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),a.jsxs("div",{className:"container mx-auto relative",children:[u&&a.jsx("div",{className:"relative z-10 mb-6 sm:mb-8 px-2 sm:px-0",children:a.jsx("div",{className:"flex justify-end",children:a.jsx("div",{className:"bg-gray-900/90 backdrop-blur-xl border border-gray-700/50 rounded-xl sm:rounded-2xl p-3 sm:p-4 shadow-2xl max-w-full",children:a.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[a.jsx("div",{className:"flex h-8 w-8 sm:h-10 sm:w-10 items-center justify-center rounded-full bg-gradient-to-r from-blue-600/20 to-red-600/20 border border-blue-500/30 flex-shrink-0",children:a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"font-semibold text-white text-xs sm:text-sm truncate",children:"Bienvenido,"}),a.jsx("p",{className:"font-bold text-blue-400 text-sm sm:text-base truncate",children:u.username||u.name||u.email}),u.role==="admin"&&a.jsx("span",{className:"inline-block mt-0.5 sm:mt-1 px-1.5 sm:px-2 py-0.5 bg-gradient-to-r from-blue-600/30 to-red-600/30 border border-blue-500/30 text-blue-400 rounded-full text-xs font-medium",children:u.role})]})]})})})}),a.jsxs("div",{className:`text-center max-w-4xl mx-auto ${u?"mb-8 sm:mb-12":"mb-12 sm:mb-20"} px-2 sm:px-0`,children:[a.jsx("div",{className:"mb-6",children:a.jsx("span",{className:"inline-block px-4 py-2 bg-gradient-to-r from-red-600/20 to-blue-600/20 border border-red-500/30 rounded-full text-red-400 text-sm font-medium uppercase tracking-wider",children:"Nuestros Servicios"})}),a.jsxs("h2",{className:"text-3xl sm:text-4xl lg:text-5xl xl:text-6xl font-bold mb-6 sm:mb-8 leading-tight",children:[a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-red-400 via-white to-blue-400",children:"Servicios Profesionales"}),a.jsx("br",{}),a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-white to-red-400",children:"de Barbería"})]}),a.jsxs("p",{className:"text-base sm:text-xl text-gray-300 leading-relaxed max-w-2xl mx-auto",children:["Ofrecemos una amplia gama de servicios de barbería profesional",a.jsx("span",{className:"block mt-2 text-blue-400 font-medium",children:"para que luzcas tu mejor versión"})]})]}),n?a.jsx("div",{className:"flex justify-center py-16",children:a.jsx("div",{className:"relative w-16 h-16",children:a.jsxs("div",{className:"absolute inset-0",children:[a.jsx("div",{className:"w-full h-full border-4 border-blue-500/20 rounded-full"}),a.jsx("div",{className:"w-full h-full border-4 border-transparent border-t-blue-500 rounded-full animate-spin"})]})})}):e.length===0?a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"mb-6 mx-auto w-16 h-16 bg-gray-800/50 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("p",{className:"text-gray-500 text-lg",children:"No hay servicios disponibles en este momento."})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8 lg:gap-10 px-2 sm:px-0",children:e.slice(0,6).map((m,f)=>a.jsxs("div",{className:`group relative overflow-hidden bg-gradient-to-br from-gray-900/90 to-gray-800/90 backdrop-blur-sm rounded-2xl sm:rounded-3xl border border-gray-700/50 hover:border-red-500/40 transition-all duration-700 transform hover:-translate-y-2 hover:shadow-[0_20px_60px_rgba(220,38,38,0.25)] ${f===0?"md:col-span-2 lg:col-span-1":""}`,style:{animationDelay:`${f*100}ms`},children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),a.jsxs("div",{className:"relative p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"mb-4 sm:mb-6 relative",children:[a.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto bg-gradient-to-br from-red-600/20 to-blue-600/20 rounded-xl sm:rounded-2xl flex items-center justify-center border border-red-500/20 group-hover:border-blue-500/40 transition-all duration-500",children:a.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-red-400 group-hover:text-blue-400 transition-colors duration-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15.414 5l5.293 5.293a1 1 0 0 1 0 1.414L15.414 17H6a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h9.414z M12 12h.01"})})}),f===0&&a.jsx("div",{className:"absolute -top-1 -right-1 sm:-top-2 sm:-right-2 bg-gradient-to-r from-red-600 to-blue-600 text-white text-xs font-bold px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full",children:"Popular"})]}),a.jsxs("div",{className:"text-center mb-4 sm:mb-6",children:[a.jsx("h3",{className:"font-bold text-xl sm:text-2xl lg:text-3xl mb-2 sm:mb-3 text-white group-hover:text-blue-400 transition-colors duration-500 leading-tight",children:m.name}),a.jsx("p",{className:"text-gray-400 text-sm sm:text-base leading-relaxed line-clamp-3",children:m.description})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-left",children:[a.jsxs("p",{className:"text-blue-400 font-bold text-2xl sm:text-3xl",children:["$",m.price]}),a.jsx("p",{className:"text-gray-500 text-xs sm:text-sm",children:"Precio final"})]}),a.jsx(Ae,{to:"/appointment",className:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-r from-red-600/20 to-blue-600/20 hover:from-red-600/40 hover:to-blue-600/40 border border-red-500/30 hover:border-blue-500/50 rounded-full text-red-400 hover:text-blue-400 transition-all duration-500 transform hover:scale-110 flex-shrink-0",children:a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})})]})]})]},m._id))})]})]}),a.jsxs("section",{className:"py-16 sm:py-24 lg:py-32 px-4 bg-gradient-to-b from-black via-gray-900 to-black relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-900/10 via-blue-900/10 to-red-900/10"}),a.jsx("div",{className:"absolute inset-0 opacity-25",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='120' height='120' viewBox='0 0 120 120' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23dc2626' fill-opacity='0.08'%3E%3Ccircle cx='60' cy='60' r='2'/%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3Ccircle cx='90' cy='30' r='1'/%3E%3Ccircle cx='30' cy='90' r='1'/%3E%3Ccircle cx='90' cy='90' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),a.jsxs("div",{className:"container mx-auto relative",children:[a.jsxs("div",{className:"text-center max-w-4xl mx-auto mb-12 sm:mb-20 px-2 sm:px-0",children:[a.jsx("div",{className:"mb-6",children:a.jsx("span",{className:"inline-block px-4 py-2 bg-gradient-to-r from-blue-600/20 to-red-600/20 border border-blue-500/30 rounded-full text-blue-400 text-sm font-medium uppercase tracking-wider",children:"Nuestro Equipo"})}),a.jsxs("h2",{className:"text-3xl sm:text-4xl lg:text-5xl xl:text-6xl font-bold mb-6 sm:mb-8 leading-tight",children:[a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-white to-red-400",children:"Barberos Expertos"}),a.jsx("br",{}),a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-red-400 via-white to-blue-400",children:"Maestros del Arte"})]}),a.jsxs("p",{className:"text-base sm:text-xl text-gray-300 leading-relaxed max-w-2xl mx-auto",children:["Conoce a nuestro equipo de profesionales expertos en el arte de la barbería",a.jsx("span",{className:"block mt-2 text-blue-400 font-medium",children:"Pasión, técnica y dedicación en cada corte"})]})]}),n?a.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-blue-500/20"}),a.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-transparent border-t-blue-500 animate-spin absolute inset-0"}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/20"})})]})}):r.length===0?a.jsxs("div",{className:"text-center py-20",children:[a.jsx("div",{className:"mb-8 mx-auto w-20 h-20 bg-gradient-to-br from-blue-600/20 to-red-600/20 rounded-2xl flex items-center justify-center border border-blue-500/30",children:a.jsx("svg",{className:"w-10 h-10 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("h3",{className:"text-2xl font-bold text-gray-300 mb-4",children:"Estamos construyendo nuestro equipo"}),a.jsx("p",{className:"text-gray-400 text-lg max-w-md mx-auto",children:"Pronto agregaremos nuevos profesionales especializados a nuestro equipo de barberos expertos"})]}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8 lg:gap-10 px-2 sm:px-0",children:r.map((m,f)=>a.jsx("div",{className:"transform hover:scale-105 transition-all duration-500",style:{animationDelay:`${f*150}ms`},children:a.jsx(Mc,{barber:m})},m._id||m.id))}),r.length>0&&a.jsxs("div",{className:"text-center mt-16",children:[a.jsx("p",{className:"text-gray-400 mb-6",children:"¿Quieres conocer más sobre nuestros barberos?"}),a.jsxs(He,{variant:"outline",size:"md",className:"px-8 py-3",onClick:()=>window.location.href="/barbers",children:["Ver todos los barberos",a.jsx("svg",{className:"w-5 h-5 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]}),a.jsxs("section",{className:"py-16 sm:py-24 lg:py-32 px-4 bg-gradient-to-b from-black to-gray-900 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/8 via-red-900/8 to-blue-900/8"}),a.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%232563eb' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),a.jsxs("div",{className:"container mx-auto relative",children:[a.jsxs("div",{className:"text-center max-w-4xl mx-auto mb-12 sm:mb-20 px-2 sm:px-0",children:[a.jsx("div",{className:"mb-6",children:a.jsx("span",{className:"inline-block px-4 py-2 bg-gradient-to-r from-blue-600/20 to-red-600/20 border border-blue-500/30 rounded-full text-blue-400 text-sm font-medium uppercase tracking-wider",children:"Visítanos"})}),a.jsxs("h2",{className:"text-3xl sm:text-4xl lg:text-5xl xl:text-6xl font-bold mb-6 sm:mb-8 leading-tight",children:[a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-white to-red-400",children:"Encuéntranos"}),a.jsx("br",{}),a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-red-400 via-white to-blue-400",children:"Te Esperamos"})]}),a.jsxs("p",{className:"text-base sm:text-xl text-gray-300 leading-relaxed max-w-2xl mx-auto",children:["Estamos ubicados en el corazón de la ciudad",a.jsx("span",{className:"block mt-2 text-blue-400 font-medium",children:"Ven y experimenta la diferencia por ti mismo"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8 lg:gap-12 xl:gap-16 items-center px-2 sm:px-0",children:[a.jsxs("div",{className:"relative order-2 lg:order-1 w-full",children:[a.jsx("div",{className:"absolute -inset-2 sm:-inset-4 bg-gradient-to-r from-red-600/20 via-blue-600/20 to-red-600/20 rounded-2xl sm:rounded-3xl blur-xl sm:blur-2xl opacity-30"}),a.jsx("div",{className:"absolute -inset-1 sm:-inset-2 bg-gradient-to-br from-gray-900/50 to-gray-800/50 rounded-xl sm:rounded-2xl blur-lg sm:blur-xl"}),a.jsxs("div",{className:"relative bg-gradient-to-br from-gray-900/95 to-gray-800/95 border border-gray-700/50 rounded-2xl sm:rounded-3xl p-4 sm:p-6 backdrop-blur-xl shadow-2xl min-h-[380px] sm:h-[400px] lg:h-[600px] flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"mb-4 sm:mb-6 flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[a.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-blue-600/20 to-red-600/20 rounded-lg sm:rounded-xl flex items-center justify-center border border-blue-500/30 flex-shrink-0",children:a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})})}),a.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Información de Contacto"})]}),a.jsx("p",{className:"text-gray-400 text-xs sm:text-sm leading-relaxed",children:"Estamos aquí para atenderte con la mejor experiencia de barbería."})]}),a.jsxs("div",{className:"space-y-3 sm:space-y-4 flex-1 overflow-y-auto",children:[a.jsx("div",{className:"group",children:a.jsxs("div",{className:"flex items-start space-x-2 sm:space-x-3 p-2 sm:p-3 rounded-lg sm:rounded-xl bg-gradient-to-r from-gray-800/50 to-gray-700/50 border border-gray-600/30 hover:border-blue-500/40 transition-all duration-300",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-br from-blue-600/20 to-red-600/20 rounded-md sm:rounded-lg border border-blue-500/30 group-hover:border-blue-400/50 transition-all duration-300",children:a.jsxs("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-blue-400 group-hover:text-blue-300 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("h4",{className:"text-sm sm:text-base font-semibold text-white mb-1 group-hover:text-blue-300 transition-colors duration-300",children:"Dirección"}),a.jsx("p",{className:"text-gray-400 text-xs sm:text-sm leading-relaxed break-words",children:"Cra 77vBis #52 A - 08"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Bogotá D.C, Cundinamarca."})]})]})}),a.jsx("div",{className:"group",children:a.jsxs("div",{className:"flex items-start space-x-2 sm:space-x-3 p-2 sm:p-3 rounded-lg sm:rounded-xl bg-gradient-to-r from-gray-800/50 to-gray-700/50 border border-gray-600/30 hover:border-red-500/40 transition-all duration-300",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-br from-red-600/20 to-blue-600/20 rounded-md sm:rounded-lg border border-red-500/30 group-hover:border-red-400/50 transition-all duration-300",children:a.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-red-400 group-hover:text-red-300 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("h4",{className:"text-sm sm:text-base font-semibold text-white mb-1 group-hover:text-red-300 transition-colors duration-300",children:"Teléfono"}),a.jsx("p",{className:"text-gray-400 text-xs sm:text-sm leading-relaxed break-words",children:"+57 311 588 2528"}),a.jsx("p",{className:"text-xs text-gray-500",children:"WhatsApp disponible"})]})]})}),a.jsx("div",{className:"group",children:a.jsxs("div",{className:"flex items-start space-x-2 sm:space-x-3 p-2 sm:p-3 rounded-lg sm:rounded-xl bg-gradient-to-r from-gray-800/50 to-gray-700/50 border border-gray-600/30 hover:border-blue-500/40 transition-all duration-300",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-br from-blue-600/20 to-red-600/20 rounded-md sm:rounded-lg border border-blue-500/30 group-hover:border-blue-400/50 transition-all duration-300",children:a.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-blue-400 group-hover:text-blue-300 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("h4",{className:"text-sm sm:text-base font-semibold text-white mb-1 group-hover:text-blue-300 transition-colors duration-300",children:"Horario de Atención"}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("p",{className:"text-gray-400 text-xs sm:text-sm break-words",children:"Lunes - Sábado: 9:00 AM - 8:00 PM"}),a.jsx("p",{className:"text-gray-400 text-xs sm:text-sm break-words",children:"Domingo: 10:00 AM - 6:00 PM"})]}),a.jsx("p",{className:"text-xs text-gray-500",children:"Reservas recomendadas"})]})]})})]}),a.jsx("div",{className:"mt-3 sm:mt-4 pt-3 sm:pt-4 border-t border-gray-700/50 flex-shrink-0",children:a.jsxs(He,{variant:"primary",size:"md",className:"w-full py-2 sm:py-2.5 text-sm sm:text-base",onClick:()=>window.location.href="/appointment",children:["Reservar una cita",a.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})})]})]}),a.jsxs("div",{className:"relative order-1 lg:order-2 w-full",children:[a.jsx("div",{className:"absolute -inset-1 sm:-inset-2 bg-gradient-to-r from-blue-600/20 via-red-600/20 to-blue-600/20 rounded-2xl sm:rounded-3xl blur-lg sm:blur-xl opacity-50"}),a.jsxs("div",{className:"relative h-[300px] sm:h-[400px] lg:h-[600px] rounded-2xl sm:rounded-3xl overflow-hidden shadow-[0_0_40px_rgba(37,99,235,0.3)] border border-gray-700/50 backdrop-blur-sm",children:[a.jsx("iframe",{src:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15907.448844294731!2d-74.16188815134278!3d4.618659698034156!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e3f9fadb32531a3%3A0xad47ce8d546359c!2sThe%20brothers%20barber!5e0!3m2!1ses!2sco!4v1756390613507!5m2!1ses!2sco",className:"w-full h-full",allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",style:{filter:"grayscale(20%) contrast(1.1)"}}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-black/10 pointer-events-none"})]})]})]})]})]})]})}function Rc(){var r,s,n,i;const{user:e}=er();if(!e)return a.jsx("p",{className:"text-center text-red-500 mt-10",children:"No has iniciado sesión."});const t=o=>{if(!o)return"No especificado";const l=new Date(o),d=l.getTimezoneOffset();return new Date(l.getTime()+d*60*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})};return a.jsxs(Ye,{children:[a.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.15) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-8",style:{backgroundImage:"radial-gradient(circle, rgba(239, 68, 68, 0.12) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-6",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.1) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}}),a.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto space-y-8",children:[a.jsx("div",{className:"relative",children:a.jsx("div",{className:"relative bg-gray-800/30 backdrop-blur-xl rounded-2xl p-8 border border-white/10 shadow-xl shadow-blue-500/10",children:a.jsxs("div",{className:"flex items-center space-x-6",children:[a.jsxs("div",{className:"relative",children:[e.profilePicture?a.jsx("img",{src:e.profilePicture,alt:"Foto de perfil",className:"w-28 h-28 rounded-full object-cover ring-4 ring-blue-500/30 shadow-lg shadow-blue-500/20"}):a.jsx("div",{className:"w-28 h-28 rounded-full bg-gradient-to-br from-blue-500/20 to-purple-500/20 flex items-center justify-center text-2xl font-bold ring-4 ring-blue-500/30 shadow-lg shadow-blue-500/20",children:a.jsx("span",{className:"bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent",children:((s=(r=e.name)==null?void 0:r[0])==null?void 0:s.toUpperCase())||((i=(n=e.email)==null?void 0:n[0])==null?void 0:i.toUpperCase())||"?"})}),a.jsx("div",{className:"absolute -bottom-2 -right-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white text-xs px-3 py-1 rounded-full shadow-lg",children:a.jsx("span",{className:"bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent font-medium",children:e.role==="admin"?"Admin":e.role==="barber"?"Barbero":"Cliente"})})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent mb-2",children:e.name||"Sin nombre"}),a.jsx("p",{className:"text-lg bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:e.email})]}),a.jsxs(Ae,{to:"/profile-edit",className:"group relative inline-flex items-center px-6 py-3 rounded-xl bg-gradient-to-r from-blue-500/20 to-purple-500/20 hover:from-blue-500/30 hover:to-purple-500/30 border border-blue-500/30 transition-all duration-300 text-white space-x-2 shadow-lg hover:shadow-blue-500/20 hover:scale-105",children:[a.jsx(hc,{className:"w-5 h-5 group-hover:rotate-12 transition-transform duration-300"}),a.jsx("span",{className:"font-medium bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent",children:"Editar Perfil"})]})]})})}),a.jsxs("div",{className:"grid gap-8 md:grid-cols-2",children:[a.jsxs("div",{className:"group bg-gray-800/20 backdrop-blur-xl rounded-2xl p-8 border border-white/10 shadow-xl hover:shadow-blue-500/10 transition-all duration-300 hover:border-blue-500/20",children:[a.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center space-x-3",children:[a.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-blue-500/20 to-purple-500/20",children:a.jsx(Cn,{className:"w-6 h-6 text-blue-400"})}),a.jsx("span",{className:"bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent",children:"Información de Contacto"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"p-4 rounded-xl bg-gray-700/20 border border-white/5",children:[a.jsx("p",{className:"text-sm font-medium mb-2 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Correo electrónico"}),a.jsx("p",{className:"text-lg bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent break-all",children:e.email})]}),a.jsxs("div",{className:"p-4 rounded-xl bg-gray-700/20 border border-white/5",children:[a.jsx("p",{className:"text-sm font-medium mb-2 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Teléfono"}),a.jsx("p",{className:"text-lg bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent",children:e.phone||"No especificado"})]})]})]}),a.jsxs("div",{className:"group bg-gray-800/20 backdrop-blur-xl rounded-2xl p-8 border border-white/10 shadow-xl hover:shadow-purple-500/10 transition-all duration-300 hover:border-purple-500/20",children:[a.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center space-x-3",children:[a.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-purple-500/20 to-blue-500/20",children:a.jsx(Nr,{className:"w-6 h-6 text-purple-400"})}),a.jsx("span",{className:"bg-gradient-to-r from-white to-purple-200 bg-clip-text text-transparent",children:"Información Personal"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"p-4 rounded-xl bg-gray-700/20 border border-white/5",children:[a.jsx("p",{className:"text-sm font-medium mb-2 bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:"Nombre completo"}),a.jsx("p",{className:"text-lg bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent",children:e.name||"No especificado"})]}),a.jsxs("div",{className:"p-4 rounded-xl bg-gray-700/20 border border-white/5",children:[a.jsx("p",{className:"text-sm font-medium mb-2 bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:"Fecha de nacimiento"}),a.jsx("p",{className:"text-lg bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent",children:t(e.birthdate)})]})]})]})]})]})]})}const Lc={monday:"Lunes",tuesday:"Martes",wednesday:"Miércoles",thursday:"Jueves",friday:"Viernes",saturday:"Sábado",sunday:"Domingo"},Bc={monday:{start:"09:00",end:"17:00",available:!0},tuesday:{start:"09:00",end:"17:00",available:!0},wednesday:{start:"09:00",end:"17:00",available:!0},thursday:{start:"09:00",end:"17:00",available:!0},friday:{start:"09:00",end:"17:00",available:!0},saturday:{start:"09:00",end:"15:00",available:!0},sunday:{start:"09:00",end:"15:00",available:!1}},Wc=()=>{const{user:e,setUser:t}=er(),r=Ya(),{showSuccess:s,showError:n}=Er(),i=O.useRef(null),[o,l]=O.useState(null),[d,c]=O.useState(!0),[u,h]=O.useState(!1),[m,f]=O.useState("personal"),[g,x]=O.useState(null),[p,w]=O.useState({name:"",phone:"",birthdate:""}),[b,y]=O.useState({specialty:"",experience:"",description:"",services:[]}),[S,P]=O.useState([]),[L,I]=O.useState(Bc),H=B=>{if(!B)return"";const ne=new Date(B);return isNaN(ne.getTime())?"":ne.toISOString().split("T")[0]};O.useEffect(()=>{W()},[]),O.useEffect(()=>{e&&(w({name:e.name||"",phone:e.phone||"",birthdate:H(e.birthdate)}),e.profilePicture&&!g&&x(e.profilePicture))},[e]);const W=async()=>{var B,ne,C;c(!0);try{const[A,N]=await Promise.all([ct.getBarberProfile(),Mn.getAllServices()]);if(A.success){const _=A.data;l(_),y({specialty:_.specialty||"",experience:((B=_.experience)==null?void 0:B.toString())||"",description:_.description||"",services:((ne=_.services)==null?void 0:ne.map(re=>re._id))||[]}),w({name:(e==null?void 0:e.name)||"",phone:(e==null?void 0:e.phone)||"",birthdate:H(e==null?void 0:e.birthdate)});const U=(e==null?void 0:e.profilePicture)||((C=_.user)==null?void 0:C.profilePicture);U&&x(U),_.schedule&&I(_.schedule)}N.success&&P(N.data||[])}catch(A){console.error("Error loading data:",A),n("Error al cargar los datos del perfil")}finally{c(!1)}},J=B=>{const{name:ne,value:C}=B.target;w(A=>({...A,[ne]:C}))},ee=B=>{const{name:ne,value:C}=B.target;y(A=>({...A,[ne]:C}))},R=(B,ne)=>{y(C=>({...C,services:ne?[...C.services,B]:C.services.filter(A=>A!==B)}))},q=(B,ne,C)=>{I(A=>({...A,[B]:{...A[B],[ne]:C}}))},be=B=>{const ne=B.target.files[0];if(ne){if(ne.size>5*1024*1024){n("La imagen no puede ser mayor a 5MB");return}if(!ne.type.startsWith("image/")){n("Solo se permiten archivos de imagen");return}const C=new FileReader;C.onload=()=>{x(C.result)},C.readAsDataURL(ne)}},he=()=>{x(null),i.current&&(i.current.value="")},je=async B=>{try{const ne=new FormData;return ne.append("profilePicture",B),(await pe.upload("/users/upload-profile-picture",ne)).profilePictureUrl}catch(ne){throw new Error(ne.message||"Error al subir la imagen")}},le=async()=>{var B;try{h(!0);let ne=e==null?void 0:e.profilePicture;(B=i.current)!=null&&B.files[0]&&(ne=await je(i.current.files[0]));const C={};p.name&&p.name.trim()&&(C.name=p.name.trim()),p.phone&&p.phone.trim()&&(C.phone=p.phone.trim()),p.birthdate&&p.birthdate.trim()&&(C.birthdate=p.birthdate.trim()),ne&&(C.profilePicture=ne);const A=await pe.put("/users/profile",C),N=A.data||A,_={...e,...N,profilePicture:ne};t(_),w({name:_.name||"",phone:_.phone||"",birthdate:H(_.birthdate)}),ne&&ne!==(e==null?void 0:e.profilePicture)?x(ne):x(null),i.current&&(i.current.value=""),s("Información personal actualizada correctamente")}catch(ne){console.error("Error al actualizar información personal:",ne),n(ne.message||"Error al actualizar la información personal")}finally{h(!1)}},M=async()=>{try{h(!0);const B={...b,experience:parseInt(b.experience)||0},ne=await ct.updateMyProfile(B);ne.success?(s("Información profesional actualizada exitosamente"),l(C=>({...C,...B}))):n(ne.message||"Error al actualizar la información profesional")}catch(B){console.error("Error updating professional info:",B),n("Error al actualizar la información profesional")}finally{h(!1)}},ie=async()=>{try{h(!0);const B=await ct.updateMyProfile({schedule:L});B.success?(s("Horarios actualizados exitosamente"),l(ne=>({...ne,schedule:L}))):n(B.message||"Error al actualizar los horarios")}catch(B){console.error("Error updating schedule:",B),n("Error al actualizar los horarios")}finally{h(!1)}};return d?a.jsx(Ye,{children:a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900/20 to-red-900/20 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/20"}),a.jsxs("div",{className:"relative z-10 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-400 mx-auto"}),a.jsx("p",{className:"mt-4 text-white/80",children:"Cargando perfil..."})]})]})}):a.jsx(Ye,{children:a.jsx("div",{className:"relative py-6",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsxs("button",{onClick:()=>r("/profile"),className:"group inline-flex items-center gap-2 mb-10 px-4 py-2 bg-white/10 backdrop-blur-lg border border-white/20 rounded-full text-white hover:bg-white/20 hover:border-white/40 transition-all duration-300 shadow-lg hover:scale-105",children:[a.jsx(Ro,{size:16,className:"group-hover:-translate-x-1 transition-transform duration-300"}),a.jsx("span",{className:"font-medium text-sm",children:"Volver al Perfil"})]}),a.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-3 text-white leading-tight drop-shadow-lg",children:a.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400",children:"Editar Perfil de Barbero"})}),a.jsx("p",{className:"text-blue-200 text-sm max-w-2xl mx-auto leading-relaxed",children:"Gestiona tu información profesional y destaca tus habilidades como barbero"})]}),a.jsx("div",{className:"flex justify-center mb-8",children:a.jsx("div",{className:"bg-gray-900/80 backdrop-blur-xl border border-red-500/20 rounded-xl p-1.5 flex flex-col sm:flex-row gap-1 shadow-xl w-full max-w-lg",children:[{id:"personal",label:"Personal",icon:Nr,gradient:"from-blue-600 to-blue-700"},{id:"professional",label:"Profesional",icon:Rt,gradient:"from-red-600 to-red-700"},{id:"services",label:"Servicios",icon:jr,gradient:"from-red-500 to-blue-500"},{id:"schedule",label:"Horarios",icon:ht,gradient:"from-blue-500 to-red-500"}].map(({id:B,label:ne,icon:C,gradient:A})=>a.jsxs("button",{type:"button",onClick:()=>f(B),className:`group relative px-3 py-2.5 rounded-lg font-medium text-xs transition-all duration-300 flex items-center justify-center gap-1.5 transform hover:scale-105 flex-1 ${m===B?`bg-gradient-to-r ${A} text-white shadow-md border border-white/20`:"text-blue-200 hover:text-white hover:bg-white/10 border border-transparent hover:border-white/20"}`,children:[a.jsx(C,{size:14,className:"transition-all duration-300 drop-shadow-sm"}),a.jsx("span",{className:"hidden sm:inline drop-shadow-sm",children:ne}),a.jsx("span",{className:"sm:hidden drop-shadow-sm",children:ne.substring(0,4)})]},B))})}),a.jsxs("div",{className:"space-y-6",children:[m==="personal"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gray-900/80 backdrop-blur-xl border border-red-500/30 rounded-2xl p-4 shadow-2xl hover:bg-gray-900/90 hover:border-red-500/50 transition-all duration-300",children:[a.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[a.jsx("div",{className:"p-2 bg-gradient-to-r from-red-600/20 to-blue-600/20 rounded-xl border border-red-500/20 hover:border-blue-500/40 transition-all duration-500",children:a.jsx(ws,{size:18,className:"text-red-400 hover:text-blue-400 transition-colors duration-500"})}),a.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 drop-shadow-sm",children:"Foto de Perfil"})]}),a.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[a.jsx("div",{className:"relative group",children:a.jsxs("div",{className:"w-20 h-20 rounded-2xl overflow-hidden bg-gradient-to-br from-gray-800 to-blue-900 border-2 border-red-500/30 shadow-xl hover:border-red-500/60 transition-all duration-300",children:[a.jsx("img",{src:g||(e==null?void 0:e.profilePicture)||"/images/default-avatar.png",alt:"Foto de perfil",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-red-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center cursor-pointer",onClick:()=>{var B;return(B=i.current)==null?void 0:B.click()},children:a.jsx("div",{className:"p-2 bg-red-600/80 rounded-full backdrop-blur-sm border border-white/30",children:a.jsx(Us,{size:16,className:"text-white drop-shadow-lg"})})})]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{var B;return(B=i.current)==null?void 0:B.click()},disabled:u,className:"group relative p-2 bg-gradient-to-r from-blue-600/20 to-red-600/20 rounded-lg border border-blue-500/30 hover:border-red-500/40 transition-all duration-300 backdrop-blur-sm hover:bg-gradient-to-r hover:from-blue-600/30 hover:to-red-600/30 transform hover:scale-110",title:"Subir foto",children:a.jsx(ws,{size:16,className:"text-blue-400 group-hover:text-red-400 transition-colors duration-300"})}),((e==null?void 0:e.profilePicture)||g)&&a.jsx("button",{onClick:he,disabled:u,className:"group relative p-2 bg-gradient-to-r from-red-600/20 to-blue-600/20 rounded-lg border border-red-500/30 hover:border-blue-500/40 transition-all duration-300 backdrop-blur-sm hover:bg-gradient-to-r hover:from-red-600/30 hover:to-blue-600/30 transform hover:scale-110",title:"Eliminar foto",children:a.jsx(qr,{size:16,className:"text-red-400 group-hover:text-blue-400 transition-colors duration-300"})})]}),a.jsx("input",{ref:i,type:"file",accept:"image/*",onChange:be,className:"hidden"})]})]}),a.jsxs("div",{className:"group relative overflow-hidden bg-gradient-to-br from-gray-900/90 to-gray-800/90 backdrop-blur-sm rounded-3xl border border-gray-700/50 hover:border-blue-500/40 transition-all duration-700 transform hover:-translate-y-1 hover:shadow-[0_20px_60px_rgba(59,130,246,0.25)]",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),a.jsxs("div",{className:"relative p-8",children:[a.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-600/20 to-red-600/20 rounded-xl border border-blue-500/20 group-hover:border-red-500/40 transition-all duration-500",children:a.jsx(Nr,{size:20,className:"text-blue-400 group-hover:text-red-400 transition-colors duration-500"})}),a.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-white to-red-400 drop-shadow-sm",children:"Información Personal"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 flex items-center gap-2",children:[a.jsx(Nr,{size:16,className:"text-red-400"}),"Nombre Completo"]}),a.jsx("input",{type:"text",name:"name",value:p.name,onChange:J,className:"w-full px-4 py-2 bg-gradient-to-r from-red-600/25 to-blue-600/25 border border-red-500/30 rounded-full text-gray-100 placeholder-red-200/70 focus:outline-none focus:ring-2 focus:ring-red-500/40 focus:border-red-500/40 hover:border-red-500/40 hover:bg-gradient-to-r hover:from-red-600/35 hover:to-blue-600/35 transition-all duration-300 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner",placeholder:"Tu nombre completo"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-white to-red-400 flex items-center gap-2",children:[a.jsx(An,{size:16,className:"text-blue-400"}),"Teléfono"]}),a.jsx("input",{type:"tel",name:"phone",value:p.phone,onChange:J,className:"w-full px-4 py-2 bg-gradient-to-r from-blue-600/25 to-red-600/25 border border-blue-500/30 rounded-full text-gray-100 placeholder-blue-200/70 focus:outline-none focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500/40 hover:border-blue-500/40 hover:bg-gradient-to-r hover:from-blue-600/35 hover:to-red-600/35 transition-all duration-300 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner",placeholder:"+57 300 123 4567"})]}),a.jsxs("div",{className:"space-y-3 lg:col-span-2",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 flex items-center gap-2",children:[a.jsx(nr,{size:16,className:"text-red-400"}),"Fecha de Nacimiento"]}),a.jsx("input",{type:"date",name:"birthdate",value:p.birthdate,onChange:J,className:"w-full px-4 py-2 bg-gradient-to-r from-red-600/25 to-blue-600/25 border border-red-500/30 rounded-full text-gray-100 placeholder-red-200/70 focus:outline-none focus:ring-2 focus:ring-red-500/40 focus:border-red-500/40 hover:border-red-500/40 hover:bg-gradient-to-r hover:from-red-600/35 hover:to-blue-600/35 transition-all duration-300 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner"})]})]}),a.jsx("div",{className:"flex justify-end mt-6",children:a.jsx(He,{onClick:le,disabled:u,loading:u,loadingText:"Guardando...",variant:"primary",size:"md",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jt,{size:18}),a.jsx("span",{children:"Guardar Cambios"})]})})})]})]})]}),m==="professional"&&a.jsxs("div",{className:"group relative overflow-hidden bg-gradient-to-br from-gray-900/90 to-gray-800/90 backdrop-blur-sm rounded-3xl border border-gray-700/50 hover:border-red-500/40 transition-all duration-700 transform hover:-translate-y-1 hover:shadow-[0_20px_60px_rgba(239,68,68,0.25)]",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),a.jsxs("div",{className:"relative p-8",children:[a.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-r from-red-600/20 to-blue-600/20 rounded-xl border border-red-500/20 group-hover:border-blue-500/40 transition-all duration-500",children:a.jsx(Rt,{size:20,className:"text-red-400 group-hover:text-blue-400 transition-colors duration-500"})}),a.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 drop-shadow-sm",children:"Información Profesional"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 flex items-center gap-2",children:[a.jsx(jr,{size:16,className:"text-red-400"}),"Especialidad"]}),a.jsx("input",{type:"text",name:"specialty",value:b.specialty,onChange:ee,className:"w-full px-4 py-2 bg-gradient-to-r from-red-600/25 to-blue-600/25 border border-red-500/30 rounded-full text-gray-100 placeholder-red-200/70 focus:outline-none focus:ring-2 focus:ring-red-500/40 focus:border-red-500/40 hover:border-red-500/40 hover:bg-gradient-to-r hover:from-red-600/35 hover:to-blue-600/35 transition-all duration-300 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner",placeholder:"Ej: Cortes clásicos, barbas, etc."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-white to-red-400 flex items-center gap-2",children:[a.jsx(Rt,{size:16,className:"text-blue-400"}),"Años de Experiencia"]}),a.jsx("input",{type:"number",name:"experience",min:"0",value:b.experience,onChange:ee,className:"w-full px-4 py-2 bg-gradient-to-r from-blue-600/25 to-red-600/25 border border-blue-500/30 rounded-full text-gray-100 placeholder-blue-200/70 focus:outline-none focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500/40 hover:border-blue-500/40 hover:bg-gradient-to-r hover:from-blue-600/35 hover:to-red-600/35 transition-all duration-300 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner",placeholder:"0"})]}),a.jsxs("div",{className:"space-y-3 lg:col-span-2",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 flex items-center gap-2",children:[a.jsx(ys,{size:16,className:"text-red-400"}),"Descripción"]}),a.jsx("textarea",{name:"description",value:b.description,onChange:ee,rows:3,className:"w-full px-4 py-2 bg-gradient-to-r from-red-600/25 to-blue-600/25 border border-red-500/30 rounded-xl text-gray-100 placeholder-red-200/70 focus:outline-none focus:ring-2 focus:ring-red-500/40 focus:border-red-500/40 hover:border-red-500/40 hover:bg-gradient-to-r hover:from-red-600/35 hover:to-blue-600/35 transition-all duration-300 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner resize-none",placeholder:"Cuéntanos sobre tu experiencia y estilo de trabajo..."})]})]}),a.jsx("div",{className:"flex justify-end mt-6",children:a.jsx(He,{onClick:M,disabled:u,loading:u,loadingText:"Guardando...",variant:"primary",size:"md",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jt,{size:18}),a.jsx("span",{children:"Guardar Cambios"})]})})})]})]}),m==="services"&&a.jsxs("div",{className:"group relative overflow-hidden bg-gradient-to-br from-gray-900/90 to-gray-800/90 backdrop-blur-sm rounded-3xl border border-gray-700/50 hover:border-red-500/40 transition-all duration-700 transform hover:-translate-y-1 hover:shadow-[0_20px_60px_rgba(239,68,68,0.25)]",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),a.jsxs("div",{className:"relative p-8",children:[a.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-r from-red-600/20 to-blue-600/20 rounded-xl border border-red-500/20 group-hover:border-blue-500/40 transition-all duration-500",children:a.jsx(jr,{size:20,className:"text-red-400 group-hover:text-blue-400 transition-colors duration-500"})}),a.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 drop-shadow-sm",children:"Servicios que Ofreces"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:S.map(B=>a.jsxs("label",{className:`group relative p-4 rounded-2xl border-2 cursor-pointer transition-all duration-500 hover:scale-105 overflow-hidden ${b.services.includes(B._id)?"border-transparent bg-gradient-to-br from-red-500/30 via-white/10 to-blue-500/30 shadow-xl shadow-red-500/30":"border-white/20 bg-white/5 hover:border-white/40 hover:bg-white/10"}`,children:[b.services.includes(B._id)&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),a.jsx("input",{type:"checkbox",checked:b.services.includes(B._id),onChange:ne=>R(B._id,ne.target.checked),className:"sr-only"}),a.jsxs("div",{className:"relative z-10 flex flex-col space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h4",{className:`font-bold text-base group-hover:scale-105 transition-transform duration-300 ${b.services.includes(B._id)?"bg-clip-text text-transparent bg-gradient-to-r from-red-300 via-white to-blue-300":"text-white"}`,children:B.name}),a.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all duration-300 ${b.services.includes(B._id)?"border-red-400 bg-gradient-to-r from-red-500 to-blue-500 shadow-lg":"border-gray-400 group-hover:border-white"}`,children:b.services.includes(B._id)&&a.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"})})]}),a.jsx("p",{className:`text-sm leading-relaxed ${b.services.includes(B._id)?"text-gray-200":"text-gray-300"}`,children:B.description}),a.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-white/20",children:[a.jsxs("span",{className:`font-bold text-base ${b.services.includes(B._id)?"bg-clip-text text-transparent bg-gradient-to-r from-red-400 to-blue-400":"text-blue-400"}`,children:["$",B.price]}),a.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${b.services.includes(B._id)?"bg-white/20 text-white":"bg-gray-600/50 text-gray-400"}`,children:[B.duration," min"]})]})]})]},B._id))}),a.jsx("div",{className:"flex justify-end",children:a.jsx(He,{onClick:M,disabled:u,loading:u,loadingText:"Guardando...",variant:"primary",size:"md",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jt,{size:18}),a.jsx("span",{children:"Guardar Servicios"})]})})})]})]}),m==="schedule"&&a.jsxs("div",{className:"group relative overflow-hidden bg-gradient-to-br from-gray-900/90 to-gray-800/90 backdrop-blur-sm rounded-3xl border border-gray-700/50 hover:border-blue-500/40 transition-all duration-700 transform hover:-translate-y-1 hover:shadow-[0_20px_60px_rgba(59,130,246,0.25)]",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),a.jsxs("div",{className:"relative p-8",children:[a.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-600/20 to-red-600/20 rounded-xl border border-blue-500/20 group-hover:border-red-500/40 transition-all duration-500",children:a.jsx(ht,{size:20,className:"text-blue-400 group-hover:text-red-400 transition-colors duration-500"})}),a.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-white to-red-400 drop-shadow-sm",children:"Horarios de Trabajo"})]}),a.jsx("div",{className:"space-y-3 mb-6",children:Object.entries(L).map(([B,ne])=>a.jsx("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0 md:w-40",children:[a.jsx("input",{type:"checkbox",checked:ne.available,onChange:C=>q(B,"available",C.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("span",{className:"text-white font-medium text-base",children:Lc[B]})]}),ne.available&&a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[a.jsx("input",{type:"time",value:ne.start,onChange:C=>q(B,"start",C.target.value),className:"px-3 py-2 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),a.jsx("span",{className:"text-gray-300 font-medium text-sm",children:"a"}),a.jsx("input",{type:"time",value:ne.end,onChange:C=>q(B,"end",C.target.value),className:"px-3 py-2 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),!ne.available&&a.jsx("div",{className:"flex-1",children:a.jsx("span",{className:"text-gray-400 italic text-sm",children:"No disponible"})})]})},B))}),a.jsx("div",{className:"flex justify-end",children:a.jsx(He,{onClick:ie,disabled:u,loading:u,loadingText:"Guardando...",variant:"primary",size:"md",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jt,{size:18}),a.jsx("span",{children:"Guardar Horarios"})]})})})]})]})]})]})})})},Uc=()=>{var be,he,je,le;const{user:e,setUser:t}=er(),{showSuccess:r,showError:s}=Er(),n=Ya(),i=O.useRef(null),[o,l]=O.useState(!1),[d,c]=O.useState("personal"),[u,h]=O.useState(null),m=M=>{if(!M)return"";const ie=new Date(M),B=ie.getTimezoneOffset();return new Date(ie.getTime()+B*60*1e3).toISOString().split("T")[0]},[f,g]=O.useState({name:(e==null?void 0:e.name)||"",email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",birthdate:m(e==null?void 0:e.birthdate),profilePicture:(e==null?void 0:e.profilePicture)||""}),[x,p]=O.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[w,b]=O.useState({emailNotifications:(he=(be=e==null?void 0:e.preferences)==null?void 0:be.emailNotifications)!=null?he:!0,marketingEmails:(le=(je=e==null?void 0:e.preferences)==null?void 0:je.marketingEmails)!=null?le:!1}),[y,S]=O.useState({current:!1,new:!1,confirm:!1});O.useEffect(()=>{var M,ie,B,ne;e&&(g({name:e.name||"",email:e.email||"",phone:e.phone||"",birthdate:m(e.birthdate),profilePicture:e.profilePicture||""}),b({emailNotifications:(ie=(M=e.preferences)==null?void 0:M.emailNotifications)!=null?ie:!0,marketingEmails:(ne=(B=e.preferences)==null?void 0:B.marketingEmails)!=null?ne:!1}))},[e]);const P=M=>{const{name:ie,value:B}=M.target;g(ne=>({...ne,[ie]:B}))},L=M=>{const{name:ie,value:B}=M.target;p(ne=>({...ne,[ie]:B}))},I=M=>{const{name:ie,checked:B}=M.target;b(ne=>({...ne,[ie]:B}))},H=M=>{const ie=M.target.files[0];if(ie){if(ie.size>5*1024*1024){s("La imagen no puede ser mayor a 5MB");return}if(!ie.type.startsWith("image/")){s("Solo se permiten archivos de imagen");return}const B=new FileReader;B.onload=()=>{h(B.result)},B.readAsDataURL(ie)}},W=()=>{h(null),g(M=>({...M,profilePicture:""})),i.current&&(i.current.value="")},J=async M=>{try{const ie=new FormData;return ie.append("profilePicture",M),(await pe.upload("/users/upload-profile-picture",ie)).profilePictureUrl}catch(ie){throw new Error(ie.message||"Error al subir la imagen")}},ee=async()=>{var M;try{l(!0);let ie=f.profilePicture;(M=i.current)!=null&&M.files[0]&&(ie=await J(i.current.files[0]));const B={};f.name&&f.name.trim()&&(B.name=f.name.trim()),f.email&&f.email.trim()&&(B.email=f.email.trim()),f.phone&&f.phone.trim()&&(B.phone=f.phone.trim()),f.birthdate&&f.birthdate.trim()&&(B.birthdate=f.birthdate.trim()),ie&&(B.profilePicture=ie);const ne=await pe.put("/users/profile",B),C=ne.data||ne,A={...e,...C,profilePicture:ie};t(A),g({name:A.name||"",email:A.email||"",phone:A.phone||"",birthdate:m(A.birthdate),profilePicture:A.profilePicture||""}),h(null),i.current&&(i.current.value=""),r("Perfil actualizado correctamente")}catch(ie){console.error("Error al actualizar perfil:",ie),s(ie.message||"Error al actualizar el perfil")}finally{l(!1)}},R=async()=>{try{if(!x.currentPassword||!x.newPassword||!x.confirmPassword){s("Todos los campos de contraseña son obligatorios");return}if(x.newPassword!==x.confirmPassword){s("Las contraseñas nuevas no coinciden");return}if(x.newPassword.length<6){s("La nueva contraseña debe tener al menos 6 caracteres");return}l(!0),await pe.put("/users/change-password",{currentPassword:x.currentPassword,newPassword:x.newPassword}),p({currentPassword:"",newPassword:"",confirmPassword:""}),r("Contraseña actualizada correctamente")}catch(M){console.error("Error al cambiar contraseña:",M),s(M.message||"Error al cambiar la contraseña")}finally{l(!1)}},q=async()=>{try{l(!0);const M=await pe.put("/users/preferences",w),ie=M.data||M;t(B=>({...B,preferences:ie.preferences||w})),r("Preferencias actualizadas correctamente")}catch(M){console.error("Error al actualizar preferencias:",M),s(M.message||"Error al actualizar las preferencias")}finally{l(!1)}};return a.jsx(Ye,{children:a.jsx("div",{className:"relative py-6",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsxs("button",{onClick:()=>n("/dashboard"),className:"group inline-flex items-center gap-2 mb-10 px-4 py-2 bg-white/10 backdrop-blur-lg border border-white/20 rounded-full text-white hover:bg-white/20 hover:border-white/40 transition-all duration-300 shadow-lg hover:scale-105",children:[a.jsx(Ro,{size:16,className:"group-hover:-translate-x-1 transition-transform duration-300"}),a.jsx("span",{className:"font-medium text-sm",children:"Volver al Dashboard"})]}),a.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-3 text-white leading-tight drop-shadow-lg",children:a.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400",children:"Editar Perfil de Usuario"})}),a.jsx("p",{className:"text-blue-200 text-sm max-w-2xl mx-auto leading-relaxed",children:"Gestiona tu información personal y preferencias de la cuenta con total seguridad"})]}),a.jsx("div",{className:"flex justify-center mb-8",children:a.jsx("div",{className:"bg-gray-900/80 backdrop-blur-xl border border-red-500/20 rounded-xl p-1.5 flex flex-col sm:flex-row gap-1 shadow-xl w-full max-w-md",children:[{id:"personal",label:"Personal",icon:Nr,gradient:"from-blue-600 to-blue-700"},{id:"security",label:"Seguridad",icon:ya,gradient:"from-red-600 to-red-700"},{id:"preferences",label:"Preferencias",icon:Si,gradient:"from-red-500 to-blue-500"}].map(({id:M,label:ie,icon:B,gradient:ne})=>a.jsxs("button",{type:"button",onClick:()=>c(M),className:`group relative px-3 py-2.5 rounded-lg font-medium text-xs transition-all duration-300 flex items-center justify-center gap-1.5 transform hover:scale-105 flex-1 ${d===M?`bg-gradient-to-r ${ne} text-white shadow-md border border-white/20`:"text-blue-200 hover:text-white hover:bg-white/10 border border-transparent hover:border-white/20"}`,children:[a.jsx(B,{size:14,className:"transition-all duration-300 drop-shadow-sm"}),a.jsx("span",{className:"hidden sm:inline drop-shadow-sm",children:ie}),a.jsx("span",{className:"sm:hidden drop-shadow-sm",children:ie.substring(0,4)})]},M))})}),a.jsxs("div",{className:"space-y-6",children:[d==="personal"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gray-900/80 backdrop-blur-xl border border-red-500/30 rounded-2xl p-4 shadow-2xl hover:bg-gray-900/90 hover:border-red-500/50 transition-all duration-300",children:[a.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[a.jsx("div",{className:"p-2 bg-gradient-to-r from-red-600/20 to-blue-600/20 rounded-xl border border-red-500/20 hover:border-blue-500/40 transition-all duration-500",children:a.jsx(ws,{size:18,className:"text-red-400 hover:text-blue-400 transition-colors duration-500"})}),a.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 drop-shadow-sm",children:"Foto de Perfil"})]}),a.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[a.jsx("div",{className:"relative group",children:a.jsxs("div",{className:"w-20 h-20 rounded-2xl overflow-hidden bg-gradient-to-br from-gray-800 to-blue-900 border-2 border-red-500/30 shadow-xl hover:border-red-500/60 transition-all duration-300",children:[a.jsx("img",{src:u||f.profilePicture||"/images/default-avatar.png",alt:"Foto de perfil",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-red-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center cursor-pointer",onClick:()=>{var M;return(M=i.current)==null?void 0:M.click()},children:a.jsx("div",{className:"p-2 bg-red-600/80 rounded-full backdrop-blur-sm border border-white/30",children:a.jsx(Us,{size:16,className:"text-white drop-shadow-lg"})})})]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{var M;return(M=i.current)==null?void 0:M.click()},disabled:o,className:"group relative p-2 bg-gradient-to-r from-blue-600/20 to-red-600/20 rounded-lg border border-blue-500/30 hover:border-red-500/40 transition-all duration-300 backdrop-blur-sm hover:bg-gradient-to-r hover:from-blue-600/30 hover:to-red-600/30 transform hover:scale-110",title:"Subir foto",children:a.jsx(ws,{size:16,className:"text-blue-400 group-hover:text-red-400 transition-colors duration-300"})}),(f.profilePicture||u)&&a.jsx("button",{onClick:W,disabled:o,className:"group relative p-2 bg-gradient-to-r from-red-600/20 to-blue-600/20 rounded-lg border border-red-500/30 hover:border-blue-500/40 transition-all duration-300 backdrop-blur-sm hover:bg-gradient-to-r hover:from-red-600/30 hover:to-blue-600/30 transform hover:scale-110",title:"Eliminar foto",children:a.jsx(qr,{size:16,className:"text-red-400 group-hover:text-blue-400 transition-colors duration-300"})})]}),a.jsx("input",{ref:i,type:"file",accept:"image/*",onChange:H,className:"hidden"})]})]}),a.jsxs("div",{className:"group relative overflow-hidden bg-gradient-to-br from-gray-900/90 to-gray-800/90 backdrop-blur-sm rounded-3xl border border-gray-700/50 hover:border-blue-500/40 transition-all duration-700 transform hover:-translate-y-1 hover:shadow-[0_20px_60px_rgba(59,130,246,0.25)]",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),a.jsxs("div",{className:"relative p-8",children:[a.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-600/20 to-red-600/20 rounded-xl border border-blue-500/20 group-hover:border-red-500/40 transition-all duration-500",children:a.jsx(Nr,{size:20,className:"text-blue-400 group-hover:text-red-400 transition-colors duration-500"})}),a.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-white to-red-400 drop-shadow-sm",children:"Información Personal"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 flex items-center gap-2",children:[a.jsx(Nr,{size:16,className:"text-red-400"}),"Nombre Completo"]}),a.jsx("input",{type:"text",name:"name",value:f.name,onChange:P,className:"w-full px-4 py-2 bg-gradient-to-r from-red-600/25 to-blue-600/25 border border-red-500/30 rounded-full text-gray-100 placeholder-red-200/70 focus:outline-none focus:ring-2 focus:ring-red-500/40 focus:border-red-500/40 hover:border-red-500/40 hover:bg-gradient-to-r hover:from-red-600/35 hover:to-blue-600/35 transition-all duration-300 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner",placeholder:"Tu nombre completo"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-white to-red-400 flex items-center gap-2",children:[a.jsx(Cn,{size:16,className:"text-blue-400"}),"Correo Electrónico"]}),a.jsx("input",{type:"email",name:"email",value:f.email,onChange:P,className:"w-full px-4 py-2 bg-gradient-to-r from-blue-600/25 to-red-600/25 border border-blue-500/30 rounded-full text-gray-100 placeholder-blue-200/70 focus:outline-none focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500/40 hover:border-blue-500/40 hover:bg-gradient-to-r hover:from-blue-600/35 hover:to-red-600/35 transition-all duration-300 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner",placeholder:"tu@email.com"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 flex items-center gap-2",children:[a.jsx(An,{size:16,className:"text-red-400"}),"Teléfono"]}),a.jsx("input",{type:"tel",name:"phone",value:f.phone,onChange:P,className:"w-full px-4 py-2 bg-gradient-to-r from-red-600/25 to-blue-600/25 border border-red-500/30 rounded-full text-gray-100 placeholder-red-200/70 focus:outline-none focus:ring-2 focus:ring-red-500/40 focus:border-red-500/40 hover:border-red-500/40 hover:bg-gradient-to-r hover:from-red-600/35 hover:to-blue-600/35 transition-all duration-300 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner",placeholder:"+57 300 123 4567"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-white to-red-400 flex items-center gap-2",children:[a.jsx(nr,{size:16,className:"text-blue-400"}),"Fecha de Nacimiento"]}),a.jsx("input",{type:"date",name:"birthdate",value:f.birthdate,onChange:P,className:"w-full px-4 py-2 bg-gradient-to-r from-blue-600/25 to-red-600/25 border border-blue-500/30 rounded-full text-gray-100 placeholder-blue-200/70 focus:outline-none focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500/40 hover:border-blue-500/40 hover:bg-gradient-to-r hover:from-blue-600/35 hover:to-red-600/35 transition-all duration-300 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner"})]})]}),a.jsx("div",{className:"flex justify-end mt-6",children:a.jsx(He,{onClick:ee,disabled:o,loading:o,loadingText:"Guardando...",variant:"primary",size:"md",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jt,{size:18}),a.jsx("span",{children:"Guardar Cambios"})]})})})]})]})]}),d==="security"&&a.jsxs("div",{className:"group relative overflow-hidden bg-gradient-to-br from-gray-900/90 to-gray-800/90 backdrop-blur-sm rounded-3xl border border-gray-700/50 hover:border-red-500/40 transition-all duration-700 transform hover:-translate-y-1 hover:shadow-[0_20px_60px_rgba(220,38,38,0.25)]",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),a.jsxs("div",{className:"relative p-8",children:[a.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-r from-red-600/20 to-blue-600/20 rounded-xl border border-red-500/20 group-hover:border-blue-500/40 transition-all duration-500",children:a.jsx(ya,{size:20,className:"text-red-400 group-hover:text-blue-400 transition-colors duration-500"})}),a.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 drop-shadow-sm",children:"Cambiar Contraseña"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 flex items-center gap-2",children:[a.jsx(ya,{size:16,className:"text-red-400"}),"Contraseña Actual"]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:y.current?"text":"password",name:"currentPassword",value:x.currentPassword,onChange:L,className:"w-full px-4 py-2 bg-gradient-to-r from-red-600/25 to-blue-600/25 border border-red-500/30 rounded-full text-gray-100 placeholder-red-200/70 focus:outline-none focus:ring-2 focus:ring-red-500/40 focus:border-red-500/40 hover:border-red-500/40 hover:bg-gradient-to-r hover:from-red-600/35 hover:to-blue-600/35 transition-all duration-300 pr-12 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner",placeholder:"Tu contraseña actual"}),a.jsx("button",{type:"button",onClick:()=>S(M=>({...M,current:!M.current})),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-red-300 hover:text-red-400 transition-colors duration-300",children:y.current?a.jsx(tn,{size:18}):a.jsx(Ta,{size:18})})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-white to-red-400 flex items-center gap-2",children:[a.jsx(ya,{size:16,className:"text-blue-400"}),"Nueva Contraseña"]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:y.new?"text":"password",name:"newPassword",value:x.newPassword,onChange:L,className:"w-full px-4 py-2 bg-gradient-to-r from-red-600/25 to-blue-600/25 border border-red-500/30 rounded-full text-gray-100 placeholder-blue-200/70 focus:outline-none focus:ring-2 focus:ring-red-500/40 focus:border-red-500/40 hover:border-red-500/40 hover:bg-gradient-to-r hover:from-red-600/35 hover:to-blue-600/35 transition-all duration-300 pr-12 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner",placeholder:"Tu nueva contraseña"}),a.jsx("button",{type:"button",onClick:()=>S(M=>({...M,new:!M.new})),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-blue-300 hover:text-blue-400 transition-colors duration-300",children:y.new?a.jsx(tn,{size:18}):a.jsx(Ta,{size:18})})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"block text-sm font-semibold bg-clip-text text-transparent bg-gradient-to-r from-red-400 via-white to-blue-400 flex items-center gap-2",children:[a.jsx(ya,{size:16,className:"text-red-400"}),"Confirmar Nueva Contraseña"]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:y.confirm?"text":"password",name:"confirmPassword",value:x.confirmPassword,onChange:L,className:"w-full px-4 py-2 bg-gradient-to-r from-red-600/25 to-blue-600/25 border border-red-500/30 rounded-full text-gray-100 placeholder-red-200/70 focus:outline-none focus:ring-2 focus:ring-red-500/40 focus:border-red-500/40 hover:border-red-500/40 hover:bg-gradient-to-r hover:from-red-600/35 hover:to-blue-600/35 transition-all duration-300 pr-12 text-sm font-medium tracking-wider backdrop-blur-sm shadow-inner",placeholder:"Confirma tu nueva contraseña"}),a.jsx("button",{type:"button",onClick:()=>S(M=>({...M,confirm:!M.confirm})),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-red-300 hover:text-red-400 transition-colors duration-300",children:y.confirm?a.jsx(tn,{size:18}):a.jsx(Ta,{size:18})})]})]}),a.jsx("div",{className:"flex justify-end mt-6",children:a.jsx(He,{onClick:R,disabled:o,loading:o,loadingText:"Actualizando...",variant:"primary",size:"md",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jt,{size:18}),a.jsx("span",{children:"Cambiar Contraseña"})]})})})]})]})]}),d==="preferences"&&a.jsxs("div",{className:"group relative overflow-hidden bg-gradient-to-br from-gray-900/90 to-gray-800/90 backdrop-blur-sm rounded-3xl border border-gray-700/50 hover:border-blue-500/40 transition-all duration-700 transform hover:-translate-y-1 hover:shadow-[0_20px_60px_rgba(59,130,246,0.25)]",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),a.jsxs("div",{className:"relative p-8",children:[a.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-600/20 to-red-600/20 rounded-xl border border-blue-500/20 group-hover:border-red-500/40 transition-all duration-500",children:a.jsx(Si,{size:20,className:"text-blue-400 group-hover:text-red-400 transition-colors duration-500"})}),a.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-white to-red-400 drop-shadow-sm",children:"Preferencias de Notificaciones"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-red-600/25 to-blue-600/25 rounded-full border border-red-500/30 hover:border-red-500/40 hover:bg-gradient-to-r hover:from-red-600/35 hover:to-blue-600/35 transition-all duration-300 backdrop-blur-sm",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-semibold text-sm",children:"Notificaciones por Email"}),a.jsx("p",{className:"text-blue-200 text-xs mt-1",children:"Recibe notificaciones importantes por correo electrónico"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"emailNotifications",checked:w.emailNotifications,onChange:I,className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-600/80 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-red-500/50 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gradient-to-r peer-checked:from-red-500 peer-checked:to-red-600 shadow-lg backdrop-blur-sm"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-blue-600/25 to-red-600/25 rounded-full border border-blue-500/30 hover:border-blue-500/40 hover:bg-gradient-to-r hover:from-blue-600/35 hover:to-red-600/35 transition-all duration-300 backdrop-blur-sm",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-semibold text-sm",children:"Emails de Marketing"}),a.jsx("p",{className:"text-blue-200 text-xs mt-1",children:"Recibe información sobre promociones y novedades"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"marketingEmails",checked:w.marketingEmails,onChange:I,className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-600/80 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-500/50 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gradient-to-r peer-checked:from-blue-500 peer-checked:to-blue-600 shadow-lg backdrop-blur-sm"})]})]}),a.jsx("div",{className:"flex justify-end mt-6",children:a.jsx(He,{onClick:q,disabled:o,loading:o,loadingText:"Guardando...",variant:"primary",size:"md",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jt,{size:18}),a.jsx("span",{children:"Guardar Preferencias"})]})})})]})]})]})]})]})})})},$c=()=>{const{user:e}=er();return e?e.role==="barber"?a.jsx(Wc,{}):a.jsx(Uc,{}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900/20 to-red-900/20 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/20"}),a.jsxs("div",{className:"relative z-10 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-400 mx-auto"}),a.jsx("p",{className:"mt-4 text-white/80",children:"Cargando..."})]})]})};function Fe(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Lr(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function vr(e,t){const r=Fe(e);return isNaN(t)?Lr(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Kr(e,t){const r=Fe(e);if(isNaN(t))return Lr(e,NaN);if(!t)return r;const s=r.getDate(),n=Lr(e,r.getTime());n.setMonth(r.getMonth()+t+1,0);const i=n.getDate();return s>=i?n:(r.setFullYear(n.getFullYear(),n.getMonth(),s),r)}const In=6048e5,zc=864e5;let Hc={};function qa(){return Hc}function st(e,t){var l,d,c,u,h,m,f,g;const r=qa(),s=(g=(f=(u=(c=t==null?void 0:t.weekStartsOn)!=null?c:(d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.weekStartsOn)!=null?u:r.weekStartsOn)!=null?f:(m=(h=r.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)!=null?g:0,n=Fe(e),i=n.getDay(),o=(i<s?7:0)+i-s;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function Bt(e){return st(e,{weekStartsOn:1})}function Vo(e){const t=Fe(e),r=t.getFullYear(),s=Lr(e,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const n=Bt(s),i=Lr(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=Bt(i);return t.getTime()>=n.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function Wt(e){const t=Fe(e);return t.setHours(0,0,0,0),t}function js(e){const t=Fe(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function at(e,t){const r=Wt(e),s=Wt(t),n=+r-js(r),i=+s-js(s);return Math.round((n-i)/zc)}function Vc(e){const t=Vo(e),r=Lr(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Bt(r)}function jn(e,t){const r=t*7;return vr(e,r)}function Gc(e,t){return Kr(e,t*12)}function Yc(e){let t;return e.forEach(function(r){const s=Fe(r);(t===void 0||t<s||isNaN(Number(s)))&&(t=s)}),t||new Date(NaN)}function Xc(e){let t;return e.forEach(r=>{const s=Fe(r);(!t||t>s||isNaN(+s))&&(t=s)}),t||new Date(NaN)}function yr(e,t){const r=Wt(e),s=Wt(t);return+r==+s}function Rn(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function qc(e){if(!Rn(e)&&typeof e!="number")return!1;const t=Fe(e);return!isNaN(Number(t))}function Ba(e,t){const r=Fe(e),s=Fe(t),n=r.getFullYear()-s.getFullYear(),i=r.getMonth()-s.getMonth();return n*12+i}function Kc(e,t,r){const s=st(e,r),n=st(t,r),i=+s-js(s),o=+n-js(n);return Math.round((i-o)/In)}function Ln(e){const t=Fe(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Tr(e){const t=Fe(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Go(e){const t=Fe(e),r=Lr(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function Bn(e,t){var l,d,c,u,h,m,f,g;const r=qa(),s=(g=(f=(u=(c=t==null?void 0:t.weekStartsOn)!=null?c:(d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.weekStartsOn)!=null?u:r.weekStartsOn)!=null?f:(m=(h=r.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)!=null?g:0,n=Fe(e),i=n.getDay(),o=(i<s?-7:0)+6-(i-s);return n.setDate(n.getDate()+o),n.setHours(23,59,59,999),n}function Yo(e){return Bn(e,{weekStartsOn:1})}const Jc={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Qc=(e,t,r)=>{let s;const n=Jc[e];return typeof n=="string"?s=n:t===1?s=n.one:s=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+s:s+" ago":s};function ia(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Zc={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ed={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},rd={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},td={date:ia({formats:Zc,defaultWidth:"full"}),time:ia({formats:ed,defaultWidth:"full"}),dateTime:ia({formats:rd,defaultWidth:"full"})},ad={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},sd=(e,t,r,s)=>ad[e];function rt(e){return(t,r)=>{const s=r!=null&&r.context?String(r.context):"standalone";let n;if(s==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;n=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return n[i]}}const nd={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},id={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},od={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ld={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},cd={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},dd={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ud=(e,t)=>{const r=Number(e),s=r%100;if(s>20||s<10)switch(s%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},fd={ordinalNumber:ud,era:rt({values:nd,defaultWidth:"wide"}),quarter:rt({values:id,defaultWidth:"wide",argumentCallback:e=>e-1}),month:rt({values:od,defaultWidth:"wide"}),day:rt({values:ld,defaultWidth:"wide"}),dayPeriod:rt({values:cd,defaultWidth:"wide",formattingValues:dd,defaultFormattingWidth:"wide"})};function tt(e){return(t,r={})=>{const s=r.width,n=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],i=t.match(n);if(!i)return null;const o=i[0],l=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(l)?xd(l,h=>h.test(o)):hd(l,h=>h.test(o));let c;c=e.valueCallback?e.valueCallback(d):d,c=r.valueCallback?r.valueCallback(c):c;const u=t.slice(o.length);return{value:c,rest:u}}}function hd(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function xd(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Xo(e){return(t,r={})=>{const s=t.match(e.matchPattern);if(!s)return null;const n=s[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(n.length);return{value:o,rest:l}}}const md=/^(\d+)(th|st|nd|rd)?/i,pd=/\d+/i,gd={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},vd={any:[/^b/i,/^(a|c)/i]},bd={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},wd={any:[/1/i,/2/i,/3/i,/4/i]},yd={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Nd={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},jd={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_d={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ed={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Sd={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},kd={ordinalNumber:Xo({matchPattern:md,parsePattern:pd,valueCallback:e=>parseInt(e,10)}),era:tt({matchPatterns:gd,defaultMatchWidth:"wide",parsePatterns:vd,defaultParseWidth:"any"}),quarter:tt({matchPatterns:bd,defaultMatchWidth:"wide",parsePatterns:wd,defaultParseWidth:"any",valueCallback:e=>e+1}),month:tt({matchPatterns:yd,defaultMatchWidth:"wide",parsePatterns:Nd,defaultParseWidth:"any"}),day:tt({matchPatterns:jd,defaultMatchWidth:"wide",parsePatterns:_d,defaultParseWidth:"any"}),dayPeriod:tt({matchPatterns:Ed,defaultMatchWidth:"any",parsePatterns:Sd,defaultParseWidth:"any"})},qo={code:"en-US",formatDistance:Qc,formatLong:td,formatRelative:sd,localize:fd,match:kd,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Td(e){const t=Fe(e);return at(t,Go(t))+1}function Ko(e){const t=Fe(e),r=+Bt(t)-+Vc(t);return Math.round(r/In)+1}function Jo(e,t){var u,h,m,f,g,x,p,w;const r=Fe(e),s=r.getFullYear(),n=qa(),i=(w=(p=(f=(m=t==null?void 0:t.firstWeekContainsDate)!=null?m:(h=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)!=null?f:n.firstWeekContainsDate)!=null?p:(x=(g=n.locale)==null?void 0:g.options)==null?void 0:x.firstWeekContainsDate)!=null?w:1,o=Lr(e,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const l=st(o,t),d=Lr(e,0);d.setFullYear(s,0,i),d.setHours(0,0,0,0);const c=st(d,t);return r.getTime()>=l.getTime()?s+1:r.getTime()>=c.getTime()?s:s-1}function Cd(e,t){var l,d,c,u,h,m,f,g;const r=qa(),s=(g=(f=(u=(c=t==null?void 0:t.firstWeekContainsDate)!=null?c:(d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.firstWeekContainsDate)!=null?u:r.firstWeekContainsDate)!=null?f:(m=(h=r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)!=null?g:1,n=Jo(e,t),i=Lr(e,0);return i.setFullYear(n,0,s),i.setHours(0,0,0,0),st(i,t)}function Qo(e,t){const r=Fe(e),s=+st(r,t)-+Cd(r,t);return Math.round(s/In)+1}function Le(e,t){const r=e<0?"-":"",s=Math.abs(e).toString().padStart(t,"0");return r+s}const gt={y(e,t){const r=e.getFullYear(),s=r>0?r:1-r;return Le(t==="yy"?s%100:s,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Le(r+1,2)},d(e,t){return Le(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Le(e.getHours()%12||12,t.length)},H(e,t){return Le(e.getHours(),t.length)},m(e,t){return Le(e.getMinutes(),t.length)},s(e,t){return Le(e.getSeconds(),t.length)},S(e,t){const r=t.length,s=e.getMilliseconds(),n=Math.trunc(s*Math.pow(10,r-3));return Le(n,t.length)}},Kt={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Mi={G:function(e,t,r){const s=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(s,{width:"abbreviated"});case"GGGGG":return r.era(s,{width:"narrow"});case"GGGG":default:return r.era(s,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const s=e.getFullYear(),n=s>0?s:1-s;return r.ordinalNumber(n,{unit:"year"})}return gt.y(e,t)},Y:function(e,t,r,s){const n=Jo(e,s),i=n>0?n:1-n;if(t==="YY"){const o=i%100;return Le(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Le(i,t.length)},R:function(e,t){const r=Vo(e);return Le(r,t.length)},u:function(e,t){const r=e.getFullYear();return Le(r,t.length)},Q:function(e,t,r){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return Le(s,2);case"Qo":return r.ordinalNumber(s,{unit:"quarter"});case"QQQ":return r.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,t,r){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return Le(s,2);case"qo":return r.ordinalNumber(s,{unit:"quarter"});case"qqq":return r.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,t,r){const s=e.getMonth();switch(t){case"M":case"MM":return gt.M(e,t);case"Mo":return r.ordinalNumber(s+1,{unit:"month"});case"MMM":return r.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(s,{width:"wide",context:"formatting"})}},L:function(e,t,r){const s=e.getMonth();switch(t){case"L":return String(s+1);case"LL":return Le(s+1,2);case"Lo":return r.ordinalNumber(s+1,{unit:"month"});case"LLL":return r.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(s,{width:"wide",context:"standalone"})}},w:function(e,t,r,s){const n=Qo(e,s);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):Le(n,t.length)},I:function(e,t,r){const s=Ko(e);return t==="Io"?r.ordinalNumber(s,{unit:"week"}):Le(s,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):gt.d(e,t)},D:function(e,t,r){const s=Td(e);return t==="Do"?r.ordinalNumber(s,{unit:"dayOfYear"}):Le(s,t.length)},E:function(e,t,r){const s=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(s,{width:"short",context:"formatting"});case"EEEE":default:return r.day(s,{width:"wide",context:"formatting"})}},e:function(e,t,r,s){const n=e.getDay(),i=(n-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Le(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,s){const n=e.getDay(),i=(n-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Le(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){const s=e.getDay(),n=s===0?7:s;switch(t){case"i":return String(n);case"ii":return Le(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(s,{width:"short",context:"formatting"});case"iiii":default:return r.day(s,{width:"wide",context:"formatting"})}},a:function(e,t,r){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){const s=e.getHours();let n;switch(s===12?n=Kt.noon:s===0?n=Kt.midnight:n=s/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){const s=e.getHours();let n;switch(s>=17?n=Kt.evening:s>=12?n=Kt.afternoon:s>=4?n=Kt.morning:n=Kt.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let s=e.getHours()%12;return s===0&&(s=12),r.ordinalNumber(s,{unit:"hour"})}return gt.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):gt.H(e,t)},K:function(e,t,r){const s=e.getHours()%12;return t==="Ko"?r.ordinalNumber(s,{unit:"hour"}):Le(s,t.length)},k:function(e,t,r){let s=e.getHours();return s===0&&(s=24),t==="ko"?r.ordinalNumber(s,{unit:"hour"}):Le(s,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):gt.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):gt.s(e,t)},S:function(e,t){return gt.S(e,t)},X:function(e,t,r){const s=e.getTimezoneOffset();if(s===0)return"Z";switch(t){case"X":return Ri(s);case"XXXX":case"XX":return Ot(s);case"XXXXX":case"XXX":default:return Ot(s,":")}},x:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"x":return Ri(s);case"xxxx":case"xx":return Ot(s);case"xxxxx":case"xxx":default:return Ot(s,":")}},O:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Ii(s,":");case"OOOO":default:return"GMT"+Ot(s,":")}},z:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Ii(s,":");case"zzzz":default:return"GMT"+Ot(s,":")}},t:function(e,t,r){const s=Math.trunc(e.getTime()/1e3);return Le(s,t.length)},T:function(e,t,r){const s=e.getTime();return Le(s,t.length)}};function Ii(e,t=""){const r=e>0?"-":"+",s=Math.abs(e),n=Math.trunc(s/60),i=s%60;return i===0?r+String(n):r+String(n)+t+Le(i,2)}function Ri(e,t){return e%60===0?(e>0?"-":"+")+Le(Math.abs(e)/60,2):Ot(e,t)}function Ot(e,t=""){const r=e>0?"-":"+",s=Math.abs(e),n=Le(Math.trunc(s/60),2),i=Le(s%60,2);return r+n+t+i}const Li=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Zo=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Ad=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],s=r[1],n=r[2];if(!n)return Li(e,t);let i;switch(s){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Li(s,t)).replace("{{time}}",Zo(n,t))},Dd={p:Zo,P:Ad},Fd=/^D+$/,Pd=/^Y+$/,Od=["D","DD","YY","YYYY"];function Md(e){return Fd.test(e)}function Id(e){return Pd.test(e)}function Rd(e,t,r){const s=Ld(e,t,r);if(console.warn(s),Od.includes(e))throw new RangeError(s)}function Ld(e,t,r){const s=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${s} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Bd=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Wd=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ud=/^'([^]*?)'?$/,$d=/''/g,zd=/[a-zA-Z]/;function Cr(e,t,r){var u,h,m,f,g,x,p,w,b,y,S,P,L,I,H,W,J,ee;const s=qa(),n=(h=(u=r==null?void 0:r.locale)!=null?u:s.locale)!=null?h:qo,i=(y=(b=(x=(g=r==null?void 0:r.firstWeekContainsDate)!=null?g:(f=(m=r==null?void 0:r.locale)==null?void 0:m.options)==null?void 0:f.firstWeekContainsDate)!=null?x:s.firstWeekContainsDate)!=null?b:(w=(p=s.locale)==null?void 0:p.options)==null?void 0:w.firstWeekContainsDate)!=null?y:1,o=(ee=(J=(I=(L=r==null?void 0:r.weekStartsOn)!=null?L:(P=(S=r==null?void 0:r.locale)==null?void 0:S.options)==null?void 0:P.weekStartsOn)!=null?I:s.weekStartsOn)!=null?J:(W=(H=s.locale)==null?void 0:H.options)==null?void 0:W.weekStartsOn)!=null?ee:0,l=Fe(e);if(!qc(l))throw new RangeError("Invalid time value");let d=t.match(Wd).map(R=>{const q=R[0];if(q==="p"||q==="P"){const be=Dd[q];return be(R,n.formatLong)}return R}).join("").match(Bd).map(R=>{if(R==="''")return{isToken:!1,value:"'"};const q=R[0];if(q==="'")return{isToken:!1,value:Hd(R)};if(Mi[q])return{isToken:!0,value:R};if(q.match(zd))throw new RangeError("Format string contains an unescaped latin alphabet character `"+q+"`");return{isToken:!1,value:R}});n.localize.preprocessor&&(d=n.localize.preprocessor(l,d));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:n};return d.map(R=>{if(!R.isToken)return R.value;const q=R.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&Id(q)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Md(q))&&Rd(q,t,String(e));const be=Mi[q[0]];return be(l,q,n.localize,c)}).join("")}function Hd(e){const t=e.match(Ud);return t?t[1].replace($d,"'"):e}function Vd(e){const t=Fe(e),r=t.getFullYear(),s=t.getMonth(),n=Lr(e,0);return n.setFullYear(r,s+1,0),n.setHours(0,0,0,0),n.getDate()}function Gd(e){return Math.trunc(+Fe(e)/1e3)}function Yd(e){const t=Fe(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function Xd(e,t){return Kc(Yd(e),Tr(e),t)+1}function _s(e,t){const r=Fe(e),s=Fe(t);return r.getTime()>s.getTime()}function Wn(e,t){const r=Fe(e),s=Fe(t);return+r<+s}function Un(e,t){const r=Fe(e),s=Fe(t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function qd(e,t){const r=Fe(e),s=Fe(t);return r.getFullYear()===s.getFullYear()}function nn(e,t){return vr(e,-t)}function on(e,t){const r=Fe(e),s=r.getFullYear(),n=r.getDate(),i=Lr(e,0);i.setFullYear(s,t,15),i.setHours(0,0,0,0);const o=Vd(i);return r.setMonth(t,Math.min(n,o)),r}function Bi(e,t){const r=Fe(e);return isNaN(+r)?Lr(e,NaN):(r.setFullYear(t),r)}const Kd={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},Jd=(e,t,r)=>{let s;const n=Kd[e];return typeof n=="string"?s=n:t===1?s=n.one:s=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"en "+s:"hace "+s:s},Qd={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},Zd={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},eu={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ru={date:ia({formats:Qd,defaultWidth:"full"}),time:ia({formats:Zd,defaultWidth:"full"}),dateTime:ia({formats:eu,defaultWidth:"full"})},tu={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},au={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},su=(e,t,r,s)=>t.getHours()!==1?au[e]:tu[e],nu={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},iu={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},ou={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},lu={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},cu={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},du={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},uu=(e,t)=>Number(e)+"º",fu={ordinalNumber:uu,era:rt({values:nu,defaultWidth:"wide"}),quarter:rt({values:iu,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:rt({values:ou,defaultWidth:"wide"}),day:rt({values:lu,defaultWidth:"wide"}),dayPeriod:rt({values:cu,defaultWidth:"wide",formattingValues:du,defaultFormattingWidth:"wide"})},hu=/^(\d+)(º)?/i,xu=/\d+/i,mu={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},pu={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},gu={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},vu={any:[/1/i,/2/i,/3/i,/4/i]},bu={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},wu={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},yu={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},Nu={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},ju={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},_u={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},Eu={ordinalNumber:Xo({matchPattern:hu,parsePattern:xu,valueCallback:function(e){return parseInt(e,10)}}),era:tt({matchPatterns:mu,defaultMatchWidth:"wide",parsePatterns:pu,defaultParseWidth:"any"}),quarter:tt({matchPatterns:gu,defaultMatchWidth:"wide",parsePatterns:vu,defaultParseWidth:"any",valueCallback:e=>e+1}),month:tt({matchPatterns:bu,defaultMatchWidth:"wide",parsePatterns:wu,defaultParseWidth:"any"}),day:tt({matchPatterns:yu,defaultMatchWidth:"wide",parsePatterns:Nu,defaultParseWidth:"any"}),dayPeriod:tt({matchPatterns:ju,defaultMatchWidth:"any",parsePatterns:_u,defaultParseWidth:"any"})},$n={code:"es",formatDistance:Jd,formatLong:ru,formatRelative:su,localize:fu,match:Eu,options:{weekStartsOn:1,firstWeekContainsDate:1}},Wi=()=>{const[e]=cc(),[t,r]=O.useState([]),[s,n]=O.useState(""),[i,o]=O.useState(""),[l,d]=O.useState(!1),[c,u]=O.useState(!1),[h,m]=O.useState(null),[f,g]=O.useState(""),[x,p]=O.useState(""),[w,b]=O.useState(""),[y,S]=O.useState(""),[P,L]=O.useState([]),[I,H]=O.useState([]),[W,J]=O.useState([]),[ee,R]=O.useState(""),[q,be]=O.useState("upcoming"),[he,je]=O.useState(!1),[le,M]=O.useState(null),[ie,B]=O.useState(""),{user:ne}=er(),{showSuccess:C,showError:A}=Er();O.useEffect(()=>{console.log("Component mounted, user:",ne),N(),_(),U()},[ne]),O.useEffect(()=>{console.log("🔄 Services state changed:",P)},[P]),O.useEffect(()=>{console.log("🔄 Barbers state changed:",I)},[I]),O.useEffect(()=>{const D=e.get("barberId");D&&I.length>0&&I.find(_e=>_e._id===D)&&p(D)},[e,I]),O.useEffect(()=>{w&&x?(console.log("🔄 Date or barber changed, fetching available times"),re()):(console.log("🔄 Clearing available times - missing date or barber"),J([]),S(""))},[w,x]),O.useEffect(()=>{y&&W.length>0&&(W.some(ae=>typeof ae=="object"?ae.datetime===y:ae===y)||(console.log("🔄 Selected time no longer available, clearing selection"),S("")))},[W,y]),O.useEffect(()=>{console.log("🎯 Button state check:",{submitting:c,selectedService:!!f,selectedBarber:!!x,selectedDate:!!w,selectedTime:!!y,isButtonDisabled:c||!f||!x||!w||!y})},[c,f,x,w,y]);const N=async()=>{if(ne!=null&&ne._id)try{d(!0);const D=await Sr.getAppointments();D.success?r(D.data||[]):o(D.message||"Error al cargar las citas")}catch(D){console.error("Error fetching appointments:",D),o("Error al cargar las citas")}finally{d(!1)}},_=async()=>{try{console.log("Fetching services...");const D=await Mn.getAllServices();console.log("Services response:",D),D.success?(L(D.data||[]),console.log("Services loaded (success):",D.data)):D.data&&D.data.success?(L(D.data.data||[]),console.log("Services loaded (data.success):",D.data.data)):Array.isArray(D.data)?(L(D.data),console.log("Services loaded (array):",D.data)):Array.isArray(D)?(L(D),console.log("Services loaded (direct array):",D)):console.warn("Unexpected services response format:",D)}catch(D){console.error("Error fetching services:",D)}},U=async()=>{try{console.log("Fetching barbers...");const D=await ct.getAllBarbers();console.log("Barbers response:",D),D.success?(H(D.data||[]),console.log("Barbers loaded (success):",D.data)):D.data&&D.data.success?(H(D.data.data||[]),console.log("Barbers loaded (data.success):",D.data.data)):Array.isArray(D.data)?(H(D.data),console.log("Barbers loaded (array):",D.data)):Array.isArray(D)?(H(D),console.log("Barbers loaded (direct array):",D)):console.warn("Unexpected barbers response format:",D)}catch(D){console.error("Error fetching barbers:",D)}},re=async()=>{if(!(!w||!x))try{console.log("🕐 Fetching available times for:",{selectedBarber:x,selectedDate:w});const D=await Sr.getAvailableTimes(x,w);console.log("🕐 Available times response:",D);let ae=[];D.success&&D.data&&Array.isArray(D.data.slots)?(ae=D.data.slots,R(D.data.reason||""),console.log("🕐 Available times loaded (slots):",D.data.slots),console.log("🕐 Barber name:",D.data.barber),console.log("🕐 Date:",D.data.date),D.data.reason&&console.log("🕐 Reason:",D.data.reason)):D.data&&D.data.success&&Array.isArray(D.data.data)?(ae=D.data.data,console.log("Available times loaded (nested success + array):",D.data.data)):Array.isArray(D.data)?(ae=D.data,console.log("Available times loaded (direct array):",D.data)):Array.isArray(D)?(ae=D,console.log("Available times loaded (response is array):",D)):(console.warn("Available times response structure unexpected:",D),ae=[]),J(ae),console.log("🕐 Final available times set:",ae)}catch(D){console.error("❌ Error fetching available times:",D),J([])}},z=async D=>{var _e,Pe;if(D.preventDefault(),console.log("🚀 Submit button clicked! Form state:",{selectedService:f,selectedBarber:x,selectedDate:w,selectedTime:y,submitting:c}),!f||!x||!w||!y){console.log("❌ Missing required fields"),o("Por favor completa todos los campos");return}const ae=W.some(De=>typeof De=="object"?De.datetime===y:De===y);if(console.log("🔍 Validating time availability:",{selectedTime:y,availableTimes:W,isTimeAvailable:ae}),!ae){o("El horario seleccionado ya no está disponible");return}try{u(!0),o(""),n("");const De={serviceId:f,barberId:x,date:y};console.log("📤 Sending appointment data:",De);const Ce=await Sr.createAppointment(De);if(Ce.success)n("Cita agendada exitosamente. El barbero confirmará tu cita pronto."),C("Cita agendada exitosamente"),g(""),p(""),b(""),S(""),J([]),await N();else throw new Error(Ce.message||"Error al agendar la cita")}catch(De){console.error("Error creating appointment:",De);const Ce=((Pe=(_e=De.response)==null?void 0:_e.data)==null?void 0:Pe.message)||De.message||"Error al agendar la cita";o(Ce),A(Ce)}finally{u(!1)}},K=async()=>{if(h)try{const D=await Sr.cancelAppointment(h);D.success?(C("Cita cancelada exitosamente"),m(null),await N()):A(D.message||"Error al cancelar la cita")}catch(D){console.error("Error canceling appointment:",D),A("Error al cancelar la cita")}},Z=async D=>{if(window.confirm("¿Estás seguro de que deseas eliminar el reporte de esta cita?"))try{const ae=await Sr.deleteAppointment(D);ae.success?(C("Reporte de cita eliminado exitosamente"),await N()):A(ae.message||"Error al eliminar el reporte de la cita")}catch(ae){console.error("Error deleting appointment:",ae),A("Error al eliminar el reporte de la cita")}},de=D=>{M(D),je(!0),B("")},ge=()=>{je(!1),M(null),B("")},Se=async()=>{if(!ie.trim()){A("Debe proporcionar un motivo para la cancelación");return}if(ie.split(" ").filter(ae=>ae.length>0).length>100){A("El motivo no puede exceder las 100 palabras");return}try{const ae=await Sr.cancelAppointment(le,ie);ae.success?(C("Cita cancelada exitosamente. El barbero ha sido notificado."),ge(),await N()):A(ae.message||"Error al cancelar la cita")}catch(ae){console.error("Error canceling confirmed appointment:",ae),A("Error al cancelar la cita")}},Ne=D=>{const ae=t.find(_e=>_e._id===D);ae&&ae.cancellationReason&&alert(`Motivo de cancelación: ${ae.cancellationReason}`)},Q=O.useMemo(()=>{if(!t.length)return[];const D=new Date;return q==="upcoming"?t.filter(ae=>{const _e=new Date(ae.date);return(ae.status==="pending"||ae.status==="confirmed")&&(_s(_e,D)||yr(_e,D))}):t.filter(ae=>ae.status==="completed"||ae.status==="cancelled"||ae.status!=="completed"&&ae.status!=="cancelled"&&Wn(new Date(ae.date),Wt(D)))},[t,q]),ce=Cr(new Date,"yyyy-MM-dd");return a.jsx(Ye,{children:a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-black",children:[a.jsx("div",{className:"container mx-auto px-4 py-6 max-w-7xl",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-gray-800/20 backdrop-blur-xl rounded-xl p-6 border border-white/10 shadow-xl",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[a.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-blue-500/20 to-purple-500/20",children:a.jsx(nr,{className:"w-5 h-5 text-blue-400"})}),a.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent",children:"Agendar Nueva Cita"})]}),a.jsxs("form",{onSubmit:z,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(jr,{className:"w-4 h-4 text-purple-400"}),a.jsx("span",{className:"bg-gradient-to-r from-purple-300 to-purple-100 bg-clip-text text-transparent",children:"Servicio"})]})}),a.jsxs("select",{value:f,onChange:D=>{console.log("Service selected:",D.target.value),g(D.target.value)},className:"w-full h-10 px-3 bg-gray-800/50 border border-gray-700/50 rounded-lg text-white text-sm focus:outline-none focus:border-purple-500/50 transition-all duration-200",required:!0,children:[a.jsx("option",{value:"",children:"Selecciona un servicio"}),P.length===0?a.jsx("option",{disabled:!0,children:"Cargando servicios..."}):P.map(D=>a.jsxs("option",{value:D._id,children:[D.name," - $",D.price]},D._id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Nr,{className:"w-4 h-4 text-blue-400"}),a.jsx("span",{className:"bg-gradient-to-r from-blue-300 to-blue-100 bg-clip-text text-transparent",children:"Barbero"})]})}),a.jsxs("select",{value:x,onChange:D=>{console.log("Barber selected:",D.target.value),p(D.target.value)},className:"w-full h-10 px-3 bg-gray-800/50 border border-gray-700/50 rounded-lg text-white text-sm focus:outline-none focus:border-blue-500/50 transition-all duration-200",required:!0,children:[a.jsx("option",{value:"",children:"Selecciona un barbero"}),I.length===0?a.jsx("option",{disabled:!0,children:"Cargando barberos..."}):I.map(D=>{var ae;return a.jsx("option",{value:D._id,children:((ae=D.user)==null?void 0:ae.name)||D.name||"Barbero"},D._id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(nr,{className:"w-4 h-4 text-green-400"}),a.jsx("span",{className:"bg-gradient-to-r from-green-300 to-green-100 bg-clip-text text-transparent",children:"Fecha"})]})}),a.jsx("input",{type:"date",value:w,onChange:D=>{console.log("Date selected:",D.target.value),b(D.target.value)},min:ce,className:"w-full h-10 px-3 bg-gray-800/50 border border-gray-700/50 rounded-lg text-white text-sm focus:outline-none focus:border-green-500/50 transition-all duration-200",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ht,{className:"w-4 h-4 text-orange-400"}),a.jsx("span",{className:"bg-gradient-to-r from-orange-300 to-orange-100 bg-clip-text text-transparent",children:"Horarios"})]})}),!w||!x?a.jsx("div",{className:"p-3 bg-gray-800/30 border border-gray-700/30 rounded-lg",children:a.jsxs("p",{className:"text-xs text-gray-400 flex items-center gap-2",children:[a.jsx(na,{className:"w-4 h-4 text-amber-400"}),"Selecciona fecha y barbero"]})}):w&&x&&(!Array.isArray(W)||W.length===0)?a.jsx("div",{className:"p-3 bg-red-900/20 border border-red-500/30 rounded-lg",children:a.jsxs("p",{className:"text-xs text-red-400 flex items-center gap-2",children:[a.jsx(It,{className:"w-4 h-4"}),ee||"Sin horarios disponibles"]})}):a.jsx("div",{className:"grid grid-cols-3 gap-2",children:Array.isArray(W)&&W.map((D,ae)=>a.jsx("button",{type:"button",onClick:()=>{console.log("🕐 Time slot selected:",D),S(D.datetime)},className:`p-2 rounded-lg text-xs font-medium transition-all duration-200 border ${y===D.datetime?"bg-gradient-to-r from-orange-500 to-amber-500 text-white border-orange-400":"bg-gray-800/50 text-gray-300 border-gray-700/50 hover:bg-gray-700/50"}`,children:D.time},`${D.time}-${ae}`))})]}),i&&a.jsxs("div",{className:"p-3 bg-red-900/30 border border-red-500/50 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[a.jsx(It,{className:"w-4 h-4 flex-shrink-0"}),i]}),s&&a.jsxs("div",{className:"p-3 bg-green-900/30 border border-green-500/50 rounded-lg text-green-400 text-sm flex items-center gap-2",children:[a.jsx(ua,{className:"w-4 h-4 flex-shrink-0"}),s]}),a.jsx(He,{type:"submit",disabled:c||!f||!x||!w||!y,className:"w-full h-10 text-sm font-semibold",onClick:D=>{console.log("🔘 Button clicked!",D)},children:c?"Agendando...":"Agendar Cita"})]})]}),a.jsxs("div",{className:"bg-gray-800/20 backdrop-blur-xl rounded-xl p-6 border border-white/10 shadow-xl",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold flex items-center space-x-2",children:[a.jsx("div",{className:"p-1.5 rounded-lg bg-gradient-to-br from-purple-500/20 to-blue-500/20",children:a.jsx(nr,{className:"w-4 h-4 text-purple-400"})}),a.jsx("span",{className:"bg-gradient-to-r from-white to-purple-200 bg-clip-text text-transparent",children:"Mis Citas"})]}),a.jsx("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-lg p-0.5",children:a.jsxs("div",{className:"flex space-x-0.5",children:[a.jsx("button",{onClick:()=>be("upcoming"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all duration-200 ${q==="upcoming"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:"Próximas"}),a.jsx("button",{onClick:()=>be("history"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all duration-200 ${q==="history"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:"Historial"})]})})]}),l?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})}):Q.length===0?a.jsxs("div",{className:"bg-gray-800/30 rounded-lg p-6 border border-gray-700/30 text-center",children:[a.jsx("div",{className:"inline-block p-3 bg-gradient-to-br from-gray-700/50 to-gray-800/50 rounded-full mb-3",children:a.jsx(nr,{className:"w-5 h-5 text-gray-400"})}),a.jsx("p",{className:"text-gray-400 text-sm mb-1",children:q==="upcoming"?"No tienes citas próximas":"No hay historial de citas"}),a.jsx("p",{className:"text-xs text-gray-500",children:q==="upcoming"?"Agenda una nueva cita":"Tus citas aparecerán aquí"})]}):a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:Q.map(D=>{var ae,_e,Pe,De;return a.jsx("div",{className:`bg-gray-800/40 rounded-lg p-4 border transition-all duration-200 ${D.status==="confirmed"?"border-green-500/40":D.status==="pending"?"border-yellow-500/40":D.status==="cancelled"?"border-red-500/40":"border-gray-600/40"}`,children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-semibold mb-2 flex items-center gap-1",children:[a.jsx(jr,{className:"w-3 h-3 text-purple-400"}),a.jsx("span",{className:"bg-gradient-to-r from-white to-purple-200 bg-clip-text text-transparent",children:((ae=D.service)==null?void 0:ae.name)||"Servicio no disponible"})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-1 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nr,{className:"w-3 h-3 text-blue-400"}),a.jsx("span",{className:"text-gray-400",children:"Fecha:"}),a.jsx("span",{className:"bg-gradient-to-r from-blue-300 to-blue-100 bg-clip-text text-transparent font-medium",children:Cr(new Date(D.date),"d 'de' MMM",{locale:$n})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ht,{className:"w-3 h-3 text-green-400"}),a.jsx("span",{className:"text-gray-400",children:"Hora:"}),a.jsx("span",{className:"bg-gradient-to-r from-green-300 to-green-100 bg-clip-text text-transparent font-medium",children:Cr(new Date(D.date),"HH:mm")})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Nr,{className:"w-3 h-3 text-amber-400"}),a.jsx("span",{className:"text-gray-400",children:"Barbero:"}),a.jsx("span",{className:"bg-gradient-to-r from-amber-300 to-amber-100 bg-clip-text text-transparent font-medium",children:((Pe=(_e=D.barber)==null?void 0:_e.user)==null?void 0:Pe.name)||((De=D.barber)==null?void 0:De.name)||"No asignado"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium border ${D.status==="pending"?"bg-yellow-900/30 text-yellow-400 border-yellow-500/50":D.status==="confirmed"?"bg-green-900/30 text-green-400 border-green-500/50":D.status==="cancelled"?"bg-red-900/30 text-red-400 border-red-500/50":"bg-blue-900/30 text-blue-400 border-blue-500/50"}`,children:D.status==="pending"?"Pendiente":D.status==="confirmed"?"Confirmada":D.status==="cancelled"?"Cancelada":"Completada"}),a.jsxs("div",{className:"flex gap-1",children:[D.status==="pending"&&a.jsx("button",{onClick:()=>m(D._id),className:"p-1 text-red-400 hover:text-red-300 border border-red-500/50 rounded text-xs transition-all duration-200",title:"Cancelar",children:a.jsx(It,{className:"w-3 h-3"})}),D.status==="confirmed"&&a.jsx("button",{onClick:()=>de(D._id),className:"p-1 text-orange-400 hover:text-orange-300 border border-orange-500/50 rounded text-xs transition-all duration-200",title:"Cancelar con motivo",children:a.jsx(na,{className:"w-3 h-3"})}),D.status==="cancelled"&&D.cancellationReason&&D.cancelledBy!=="user"&&a.jsx("button",{onClick:()=>Ne(D._id),className:"p-1 text-blue-400 hover:text-blue-300 border border-blue-500/50 rounded text-xs transition-all duration-200",title:"Ver motivo",children:a.jsx(na,{className:"w-3 h-3"})}),(D.status==="completed"||D.status==="cancelled")&&a.jsx("button",{onClick:()=>Z(D._id),className:"p-1 text-red-400 hover:text-red-300 border border-red-500/50 rounded text-xs transition-all duration-200",title:"Eliminar",children:a.jsx(It,{className:"w-3 h-3"})})]})]})]})},D._id)})})]})]})}),he&&a.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-gray-900 rounded-xl p-4 max-w-md w-full mx-4 border border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 bg-gradient-to-r from-white to-orange-200 bg-clip-text text-transparent",children:"Cancelar Cita Confirmada"}),a.jsx("p",{className:"text-gray-400 mb-3 text-sm",children:"Para cancelar una cita confirmada, debe proporcionar un motivo. El barbero será notificado."}),a.jsx("textarea",{value:ie,onChange:D=>B(D.target.value),placeholder:"Escriba el motivo de la cancelación (máximo 100 palabras)...",className:"w-full h-24 p-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 resize-none focus:outline-none focus:border-orange-500 text-sm",maxLength:500}),a.jsxs("div",{className:"text-right text-xs text-gray-400 mb-3",children:[ie.split(" ").filter(D=>D.length>0).length,"/100 palabras"]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:ge,className:"px-3 py-1.5 text-gray-400 hover:text-white transition-colors text-sm",children:"Cancelar"}),a.jsx("button",{onClick:Se,disabled:!ie.trim(),className:"px-3 py-1.5 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors disabled:bg-gray-600 disabled:cursor-not-allowed text-sm",children:"Cancelar Cita"})]})]})}),h&&a.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-gray-900 rounded-xl p-4 max-w-md w-full mx-4 border border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 bg-gradient-to-r from-white to-red-200 bg-clip-text text-transparent",children:"Cancelar Cita"}),a.jsx("p",{className:"text-gray-400 mb-4 text-sm",children:"¿Estás seguro de que deseas cancelar esta cita? Esta acción no se puede deshacer."}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:()=>m(null),className:"px-3 py-1.5 text-gray-400 hover:text-white transition-colors text-sm",children:"Volver"}),a.jsx("button",{onClick:K,className:"px-3 py-1.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm",children:"Confirmar Cancelación"})]})]})})]})})},Ui=()=>{const[e,t]=O.useState([]),[r,s]=O.useState(!0),[n,i]=O.useState("pending"),[o,l]=O.useState(null),[d,c]=O.useState(null),[u,h]=O.useState(new Set),[m,f]=O.useState(!1),[g,x]=O.useState(null),[p,w]=O.useState(""),{user:b}=er(),{showSuccess:y,showError:S}=Er();O.useEffect(()=>{b&&b.role==="barber"&&P()},[b]);const P=async()=>{try{const M=await ct.getBarberProfile();M.success&&(l(M.data),c(M.data._id),L(M.data._id))}catch(M){console.error("Error fetching barber profile:",M)}},L=async M=>{try{s(!0);const ie=await pe.get(`/appointments/barber/${M}`);ie.success&&t(ie.data)}catch(ie){console.error("Error fetching appointments:",ie),S("Error al cargar las citas")}finally{s(!1)}},I=async(M,ie)=>{if(!u.has(M))try{h(ne=>new Set(ne).add(M)),console.log(`🔄 Changing appointment ${M} status to ${ie}`);let B;switch(ie){case"confirmed":B=await Sr.approveAppointment(M);break;case"completed":B=await Sr.completeAppointment(M);break;case"no-show":B=await Sr.markNoShow(M);break;default:throw new Error(`Estado no válido: ${ie}`)}B.success&&(y(`Cita ${ie==="confirmed"?"confirmada":"actualizada"} exitosamente`),L(d))}catch(B){console.error("Error:",B),S(B.message||"Error al actualizar la cita")}finally{h(B=>{const ne=new Set(B);return ne.delete(M),ne})}},H=async M=>{if(window.confirm("¿Estás seguro de que deseas eliminar este reporte de cita?"))try{(await Sr.deleteAppointment(M)).success&&(y("Reporte de cita eliminado exitosamente"),L(d))}catch(ie){console.error("Error:",ie),S(ie.message||"Error al eliminar el reporte de cita")}},W=M=>{x(M),w(""),f(!0)},J=()=>{f(!1),x(null),w("")},ee=async()=>{if(!p||p.trim().length===0){S("Debe proporcionar un motivo para cancelar la cita");return}if(p.split(" ").length>100){S("El motivo no puede exceder las 100 palabras");return}try{(await pe.put(`/appointments/${g}/cancel`,{reason:p.trim()})).success&&(y("Cita cancelada exitosamente. El cliente ha sido notificado."),J(),L(d))}catch(M){console.error("Error:",M),S(M.message||"Error al cancelar la cita")}},R=M=>{const ie=e.find(B=>B._id===M);ie&&ie.cancellationReason&&alert(`Motivo de cancelación: ${ie.cancellationReason}`)},q=({appointment:M})=>{var ie,B;return a.jsx("div",{className:`bg-gray-800/40 rounded-lg p-4 border transition-all duration-200 ${M.status==="confirmed"?"border-green-500/40":M.status==="pending"?"border-yellow-500/40":M.status==="cancelled"?"border-red-500/40":"border-blue-600/40"}`,children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-1",children:[a.jsx(jr,{className:"w-3 h-3 text-purple-400"}),a.jsx("span",{className:"bg-gradient-to-r from-white to-purple-200 bg-clip-text text-transparent",children:((ie=M.service)==null?void 0:ie.name)||"Servicio no especificado"})]}),a.jsx(be,{status:M.status})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-1 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Nr,{className:"w-3 h-3 text-amber-400"}),a.jsx("span",{className:"text-gray-400",children:"Cliente:"}),a.jsx("span",{className:"bg-gradient-to-r from-amber-300 to-amber-100 bg-clip-text text-transparent font-medium",children:((B=M.user)==null?void 0:B.name)||"Usuario no disponible"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nr,{className:"w-3 h-3 text-blue-400"}),a.jsx("span",{className:"text-gray-400",children:"Fecha:"}),a.jsx("span",{className:"bg-gradient-to-r from-blue-300 to-blue-100 bg-clip-text text-transparent font-medium",children:Cr(new Date(M.date),"EEEE d 'de' MMM",{locale:$n})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ht,{className:"w-3 h-3 text-green-400"}),a.jsx("span",{className:"text-gray-400",children:"Hora:"}),a.jsx("span",{className:"bg-gradient-to-r from-green-300 to-green-100 bg-clip-text text-transparent font-medium",children:Cr(new Date(M.date),"HH:mm")})]})]})]}),a.jsxs("div",{className:"flex gap-1 justify-end",children:[M.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>I(M._id,"confirmed"),disabled:u.has(M._id),className:`p-1.5 rounded text-xs transition-all duration-200 flex items-center gap-1 ${u.has(M._id)?"bg-gray-600/20 text-gray-500 cursor-not-allowed":"bg-green-600/20 text-green-400 hover:bg-green-600/30 border border-green-500/50"}`,title:"Confirmar cita",children:u.has(M._id)?a.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-current"}):a.jsx(aa,{className:"w-3 h-3"})}),a.jsx("button",{onClick:()=>W(M._id),disabled:u.has(M._id),className:`p-1.5 rounded text-xs transition-all duration-200 flex items-center gap-1 ${u.has(M._id)?"bg-gray-600/20 text-gray-500 cursor-not-allowed":"bg-red-600/20 text-red-400 hover:bg-red-600/30 border border-red-500/50"}`,title:"Cancelar cita",children:a.jsx(qr,{className:"w-3 h-3"})})]}),M.status==="confirmed"&&a.jsx("button",{onClick:()=>W(M._id),className:"p-1.5 bg-orange-600/20 text-orange-400 rounded hover:bg-orange-600/30 transition-all duration-200 border border-orange-500/50",title:"Cancelar con motivo",children:a.jsx(qr,{className:"w-3 h-3"})}),M.status==="cancelled"&&M.cancellationReason&&M.cancelledBy!=="barber"&&a.jsx("button",{onClick:()=>R(M._id),className:"p-1.5 bg-blue-600/20 text-blue-400 rounded hover:bg-blue-600/30 transition-all duration-200 border border-blue-500/50",title:"Ver motivo de cancelación",children:a.jsx(Ta,{className:"w-3 h-3"})}),(M.status==="completed"||M.status==="cancelled")&&a.jsx("button",{onClick:()=>H(M._id),className:"p-1.5 bg-red-600/20 text-red-400 rounded hover:bg-red-600/30 transition-all duration-200 border border-red-500/50",title:"Eliminar reporte",children:a.jsx(Xa,{className:"w-3 h-3"})})]})]})})},be=({status:M})=>{const ie={pending:"bg-yellow-900/30 text-yellow-400 border-yellow-500/50",confirmed:"bg-green-900/30 text-green-400 border-green-500/50",cancelled:"bg-red-900/30 text-red-400 border-red-500/50",completed:"bg-blue-900/30 text-blue-400 border-blue-500/50"},B={pending:"Pendiente",confirmed:"Confirmada",cancelled:"Cancelada",completed:"Completada"};return a.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium border ${ie[M]}`,children:B[M]})},he=({status:M,count:ie})=>a.jsxs("button",{onClick:()=>i(M),className:`w-full px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 flex items-center justify-between ${n===M?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-gray-700/50 border border-gray-700/50"}`,children:[a.jsx("span",{children:M==="pending"?"Pendientes":M==="confirmed"?"Confirmadas":M==="cancelled"?"Canceladas":"Completadas"}),ie>0&&a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${n===M?"bg-white/20":"bg-gray-700"}`,children:ie})]}),je=e.filter(M=>M.status===n),le={pending:e.filter(M=>M.status==="pending").length,confirmed:e.filter(M=>M.status==="confirmed").length,completed:e.filter(M=>M.status==="completed").length,cancelled:e.filter(M=>M.status==="cancelled").length};return a.jsx(Ye,{children:a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-black",children:[a.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-7xl",children:[a.jsx("div",{className:"text-center mb-6",children:a.jsxs("h1",{className:"text-2xl font-bold bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent flex items-center justify-center gap-2",children:[a.jsx(nr,{className:"w-6 h-6 text-blue-400"}),"Gestión de Citas"]})}),r?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-gray-800/20 backdrop-blur-xl rounded-xl p-6 border border-white/10 shadow-xl",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[a.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-purple-500/20 to-blue-500/20",children:a.jsx(ua,{className:"w-5 h-5 text-purple-400"})}),a.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-white to-purple-200 bg-clip-text text-transparent",children:"Estados de Citas"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(he,{status:"pending",count:le.pending}),a.jsx(he,{status:"confirmed",count:le.confirmed}),a.jsx(he,{status:"completed",count:le.completed}),a.jsx(he,{status:"cancelled",count:le.cancelled})]}),a.jsxs("div",{className:"mt-6 p-4 bg-gray-800/30 rounded-lg border border-gray-700/30",children:[a.jsx("h3",{className:"text-sm font-semibold mb-3 bg-gradient-to-r from-gray-200 to-gray-400 bg-clip-text text-transparent",children:"Resumen del Día"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-yellow-400 font-bold text-lg",children:le.pending}),a.jsx("div",{className:"text-gray-400",children:"Pendientes"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-green-400 font-bold text-lg",children:le.confirmed}),a.jsx("div",{className:"text-gray-400",children:"Confirmadas"})]})]})]})]}),a.jsxs("div",{className:"bg-gray-800/20 backdrop-blur-xl rounded-xl p-6 border border-white/10 shadow-xl",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[a.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-blue-500/20 to-green-500/20",children:a.jsx(jr,{className:"w-5 h-5 text-blue-400"})}),a.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent",children:n==="pending"?"Citas Pendientes":n==="confirmed"?"Citas Confirmadas":n==="completed"?"Citas Completadas":"Citas Canceladas"})]}),a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:je.length===0?a.jsxs("div",{className:"bg-gray-800/30 rounded-lg p-6 border border-gray-700/30 text-center",children:[a.jsx("div",{className:"inline-block p-3 bg-gradient-to-br from-gray-700/50 to-gray-800/50 rounded-full mb-3",children:a.jsx(nr,{className:"w-5 h-5 text-gray-400"})}),a.jsxs("p",{className:"text-gray-400 text-sm",children:["No hay citas ",n==="pending"?"pendientes":n==="confirmed"?"confirmadas":n==="completed"?"completadas":"canceladas"]})]}):je.map(M=>a.jsx(q,{appointment:M},M._id))})]})]})]}),m&&a.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-gray-900 rounded-xl p-4 max-w-md w-full mx-4 border border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 bg-gradient-to-r from-white to-red-200 bg-clip-text text-transparent",children:"Cancelar Cita"}),a.jsx("p",{className:"text-gray-400 mb-3 text-sm",children:"Como barbero, debe proporcionar un motivo para cancelar la cita. El cliente será notificado."}),a.jsx("textarea",{value:p,onChange:M=>w(M.target.value),placeholder:"Escriba el motivo de la cancelación (máximo 100 palabras)...",className:"w-full h-24 p-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 resize-none focus:outline-none focus:border-red-500 text-sm",maxLength:500}),a.jsxs("div",{className:"text-right text-xs text-gray-400 mb-3",children:[p.split(" ").filter(M=>M.length>0).length,"/100 palabras"]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:J,className:"px-3 py-1.5 text-gray-400 hover:text-white transition-colors text-sm",children:"Cancelar"}),a.jsx("button",{onClick:ee,disabled:!p.trim(),className:"px-3 py-1.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:bg-gray-600 disabled:cursor-not-allowed text-sm",children:"Confirmar Cancelación"})]})]})})]})})},$i=()=>{const[e,t]=O.useState([]),[r,s]=O.useState(!0),{showSuccess:n,showError:i}=Er(),[o,l]=O.useState({total:0,pending:0,confirmed:0,completed:0,cancelled:0}),[d,c]=O.useState({status:"all",date:"all",search:""}),[u,h]=O.useState(!1),[m,f]=O.useState(null),[g,x]=O.useState("");O.useEffect(()=>{p()},[]);const p=async()=>{try{const R=await pe.get("/appointments");R.success&&(t(R.data),w(R.data))}catch(R){console.error("Error:",R)}finally{s(!1)}},w=R=>{const q=R.reduce((be,he)=>(be.total++,be[he.status]=(be[he.status]||0)+1,be),{total:0,pending:0,confirmed:0,completed:0,cancelled:0});l(q)},b=async(R,q)=>{try{let be;switch(q){case"confirmed":be=await Sr.approveAppointment(R);break;case"completed":be=await Sr.completeAppointment(R);break;case"cancelled":S(R);return;default:i("Estado no válido");return}be.success&&(n(`Cita ${q==="confirmed"?"confirmada":"actualizada"} exitosamente`),p())}catch(be){console.error("Error:",be),i("Error al actualizar la cita")}},y=async R=>{if(confirm("¿Está seguro de que desea eliminar este reporte de cita?"))try{(await Sr.deleteAppointment(R)).success&&(n("Reporte de cita eliminado exitosamente"),p())}catch(q){console.error("Error:",q),i("Error al eliminar el reporte de cita")}},S=R=>{f(R),h(!0)},P=()=>{h(!1),f(null),x("")},L=async()=>{try{const R=await Sr.cancelAppointment(m,g.trim()||void 0);R.success?(n("Cita cancelada exitosamente por administración."),p(),P()):i(R.message||"Error al cancelar la cita")}catch(R){console.error("Error:",R),i("Error al cancelar la cita")}},I=async R=>{try{const q=await pe.get(`/appointments/${R}/cancellation-reason`);if(q.success){const{reason:be,cancelledBy:he,cancelledAt:je}=q.data;alert(`Motivo de cancelación por ${he==="user"?"el cliente":he==="barber"?"el barbero":"administración"}:

${be}

Cancelada el: ${new Date(je).toLocaleString("es-ES")}`)}else i("No se pudo obtener el motivo de cancelación")}catch(q){console.error("Error:",q),i("No se pudo obtener el motivo de cancelación")}},H=R=>R.sort((q,be)=>{const he={pending:0,confirmed:1,completed:2,cancelled:3};return he[q.status]-he[be.status]}),W=({title:R,value:q,icon:be,gradient:he,borderColor:je,textColor:le})=>a.jsx("div",{className:`bg-gradient-to-br ${he} backdrop-blur-xl rounded-lg p-3 border ${je} shadow-lg hover:shadow-xl transition-all duration-300 group`,children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-400 text-xs font-medium",children:R}),a.jsx("p",{className:`${le} text-xl font-bold mt-1 group-hover:scale-105 transition-transform duration-200`,children:q})]}),a.jsx("div",{className:`p-2 bg-gradient-to-br ${he} rounded-lg border ${je}`,children:a.jsx(be,{className:`w-4 h-4 ${le}`})})]})}),J=({appointment:R,onStatusChange:q,onCancel:be,onViewReason:he,onDelete:je})=>{var B,ne,C,A,N,_;const le=U=>{switch(U){case"pending":return a.jsx(na,{className:"w-4 h-4"});case"confirmed":return a.jsx(ua,{className:"w-4 h-4"});case"completed":return a.jsx(aa,{className:"w-4 h-4"});case"cancelled":return a.jsx(It,{className:"w-4 h-4"});default:return a.jsx(na,{className:"w-4 h-4"})}},M=U=>{switch(U){case"pending":return"from-yellow-500/20 to-orange-500/20 border-yellow-500/30";case"confirmed":return"from-green-500/20 to-emerald-500/20 border-green-500/30";case"completed":return"from-purple-500/20 to-violet-500/20 border-purple-500/30";case"cancelled":return"from-red-500/20 to-pink-500/20 border-red-500/30";default:return"from-gray-500/20 to-gray-600/20 border-gray-500/30"}},ie=U=>{switch(U){case"pending":return"Pendiente";case"confirmed":return"Confirmada";case"completed":return"Completada";case"cancelled":return"Cancelada";default:return"Desconocido"}};return a.jsxs("div",{className:"bg-gray-800/40 backdrop-blur-xl rounded-lg p-4 border border-white/10 shadow-lg hover:shadow-xl transition-all duration-300 group",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:`flex items-center space-x-1.5 px-2 py-1 rounded-md bg-gradient-to-r ${M(R.status)} border text-xs`,children:[le(R.status),a.jsx("span",{className:"font-medium text-white",children:ie(R.status)})]}),R.status==="pending"&&a.jsx("div",{className:"px-2 py-1 bg-amber-500/20 border border-amber-500/30 rounded-md",children:a.jsx("span",{className:"text-xs font-medium text-amber-300",children:"Atención"})})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Nr,{className:"w-3 h-3 text-blue-400"}),a.jsx("span",{className:"text-xs text-gray-400",children:"Cliente"})]}),a.jsx("p",{className:"text-white text-sm font-medium truncate",children:((B=R.user)==null?void 0:B.name)||((ne=R.client)==null?void 0:ne.name)||"Sin nombre"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(jr,{className:"w-3 h-3 text-green-400"}),a.jsx("span",{className:"text-xs text-gray-400",children:"Barbero"})]}),a.jsx("p",{className:"text-white text-sm font-medium truncate",children:((A=(C=R.barber)==null?void 0:C.user)==null?void 0:A.name)||((N=R.barber)==null?void 0:N.name)||"Sin asignar"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(ki,{className:"w-3 h-3 text-purple-400"}),a.jsx("span",{className:"text-xs text-gray-400",children:"Servicio"})]}),a.jsx("p",{className:"text-white text-sm font-medium truncate",children:((_=R.service)==null?void 0:_.name)||"Sin servicio"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(nr,{className:"w-3 h-3 text-orange-400"}),a.jsx("span",{className:"text-xs text-gray-400",children:"Fecha"})]}),a.jsxs("div",{className:"text-white text-sm font-medium",children:[a.jsx("div",{children:Cr(new Date(R.date),"d MMM",{locale:$n})}),a.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-400",children:[a.jsx(ht,{className:"w-3 h-3"}),a.jsx("span",{children:Cr(new Date(R.date),"HH:mm")})]})]})]})]}),a.jsxs("div",{className:"flex items-center justify-end space-x-1.5 pt-3 border-t border-gray-700/50",children:[R.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>q(R._id,"confirmed"),className:"flex items-center space-x-1 px-2 py-1 bg-green-500/20 text-green-400 rounded-md hover:bg-green-500/30 transition-all duration-200 border border-green-500/30",title:"Confirmar cita",children:[a.jsx(aa,{className:"w-3 h-3"}),a.jsx("span",{className:"text-xs",children:"Confirmar"})]}),a.jsxs("button",{onClick:()=>be(R._id),className:"flex items-center space-x-1 px-2 py-1 bg-red-500/20 text-red-400 rounded-md hover:bg-red-500/30 transition-all duration-200 border border-red-500/30",title:"Cancelar cita",children:[a.jsx(qr,{className:"w-3 h-3"}),a.jsx("span",{className:"text-xs",children:"Cancelar"})]})]}),R.status==="confirmed"&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>q(R._id,"completed"),className:"flex items-center space-x-1 px-2 py-1 bg-purple-500/20 text-purple-400 rounded-md hover:bg-purple-500/30 transition-all duration-200 border border-purple-500/30",title:"Marcar como completada",children:[a.jsx(aa,{className:"w-3 h-3"}),a.jsx("span",{className:"text-xs",children:"Completar"})]}),a.jsxs("button",{onClick:()=>be(R._id),className:"flex items-center space-x-1 px-2 py-1 bg-red-500/20 text-red-400 rounded-md hover:bg-red-500/30 transition-all duration-200 border border-red-500/30",title:"Cancelar cita",children:[a.jsx(qr,{className:"w-3 h-3"}),a.jsx("span",{className:"text-xs",children:"Cancelar"})]})]}),R.status==="cancelled"&&R.cancellationReason&&a.jsxs("button",{onClick:()=>he(R._id),className:"flex items-center space-x-1 px-2 py-1 bg-blue-500/20 text-blue-400 rounded-md hover:bg-blue-500/30 transition-all duration-200 border border-blue-500/30",title:"Ver motivo de cancelación",children:[a.jsx(Ta,{className:"w-3 h-3"}),a.jsx("span",{className:"text-xs",children:"Ver Motivo"})]}),(R.status==="completed"||R.status==="cancelled")&&a.jsxs("button",{onClick:()=>je(R._id),className:"flex items-center space-x-1 px-2 py-1 bg-red-500/20 text-red-400 rounded-md hover:bg-red-500/30 transition-all duration-200 border border-red-500/30",title:"Eliminar reporte de cita",children:[a.jsx(Xa,{className:"w-3 h-3"}),a.jsx("span",{className:"text-xs",children:"Eliminar"})]})]})]})},ee=H(e.filter(R=>{var q,be,he,je;if(d.status!=="all"&&R.status!==d.status)return!1;if(d.search){const le=((q=R.user)==null?void 0:q.name)||((be=R.client)==null?void 0:be.name)||"",M=((he=R.barber)==null?void 0:he.name)||"",ie=((je=R.service)==null?void 0:je.name)||"",B=d.search.toLowerCase();return le.toLowerCase().includes(B)||M.toLowerCase().includes(B)||ie.toLowerCase().includes(B)}return!0}));return a.jsx(Ye,{children:a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-950 via-gray-900 to-black",children:a.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[a.jsxs("div",{className:"text-center space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-blue-500/20 to-purple-500/20 border border-blue-500/30",children:a.jsx(fa,{className:"w-5 h-5 text-blue-400"})}),a.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-300 via-purple-300 to-blue-200 bg-clip-text text-transparent",children:"Panel Administrativo"})]}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Gestión de Reservas y estadísticas"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3",children:[a.jsx(W,{title:"Total",value:o.total,icon:ki,gradient:"from-blue-500/20 to-cyan-500/20",borderColor:"border-blue-500/30",textColor:"text-blue-300"}),a.jsx(W,{title:"Pendientes",value:o.pending,icon:na,gradient:"from-yellow-500/20 to-orange-500/20",borderColor:"border-yellow-500/30",textColor:"text-yellow-300"}),a.jsx(W,{title:"Confirmadas",value:o.confirmed,icon:ua,gradient:"from-green-500/20 to-emerald-500/20",borderColor:"border-green-500/30",textColor:"text-green-300"}),a.jsx(W,{title:"Completadas",value:o.completed,icon:aa,gradient:"from-purple-500/20 to-violet-500/20",borderColor:"border-purple-500/30",textColor:"text-purple-300"}),a.jsx(W,{title:"Canceladas",value:o.cancelled,icon:It,gradient:"from-red-500/20 to-pink-500/20",borderColor:"border-red-500/30",textColor:"text-red-300"})]}),a.jsxs("div",{className:"bg-gray-800/30 backdrop-blur-xl rounded-lg p-4 border border-white/10 shadow-lg",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx(Dn,{className:"w-4 h-4 text-blue-400"}),a.jsx("h2",{className:"text-sm font-semibold bg-gradient-to-r from-blue-300 to-blue-100 bg-clip-text text-transparent",children:"Filtros y Búsqueda"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Fn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar...",value:d.search,onChange:R=>c(q=>({...q,search:R.target.value})),className:"w-full pl-9 pr-3 py-2 text-sm bg-gray-800/50 border border-gray-700/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all duration-200"})]}),a.jsxs("select",{value:d.status,onChange:R=>c(q=>({...q,status:R.target.value})),className:"px-3 py-2 text-sm bg-gray-800/50 border border-gray-700/50 rounded-lg text-white focus:outline-none focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all duration-200",children:[a.jsx("option",{value:"all",children:"Todos los estados"}),a.jsx("option",{value:"pending",children:"Pendientes"}),a.jsx("option",{value:"confirmed",children:"Confirmadas"}),a.jsx("option",{value:"completed",children:"Completadas"}),a.jsx("option",{value:"cancelled",children:"Canceladas"})]}),a.jsxs("select",{value:d.date,onChange:R=>c(q=>({...q,date:R.target.value})),className:"px-3 py-2 text-sm bg-gray-800/50 border border-gray-700/50 rounded-lg text-white focus:outline-none focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all duration-200",children:[a.jsx("option",{value:"all",children:"Todas las fechas"}),a.jsx("option",{value:"today",children:"Hoy"}),a.jsx("option",{value:"week",children:"Esta semana"}),a.jsx("option",{value:"month",children:"Este mes"})]})]})]}),a.jsxs("div",{className:"bg-gray-800/30 backdrop-blur-xl rounded-lg p-4 border border-white/10 shadow-lg",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[a.jsx(nr,{className:"w-4 h-4 text-purple-400"}),a.jsxs("h2",{className:"text-sm font-semibold bg-gradient-to-r from-purple-300 to-purple-100 bg-clip-text text-transparent",children:["Lista de Citas (",ee.length,")"]})]}),r?a.jsxs("div",{className:"flex items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-400"}),a.jsx("span",{className:"ml-2 text-gray-400 text-sm",children:"Cargando citas..."})]}):ee.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(nr,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"No hay citas que coincidan con los filtros"})]}):a.jsx("div",{className:"grid gap-3",children:ee.map(R=>a.jsx(J,{appointment:R,onStatusChange:b,onCancel:S,onViewReason:I,onDelete:y},R._id))})]}),u&&a.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 p-3",children:a.jsxs("div",{className:"bg-gray-800/90 backdrop-blur-xl rounded-lg p-4 border border-red-500/30 shadow-xl max-w-md w-full",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx("div",{className:"p-1 rounded-lg bg-red-500/20 border border-red-500/30",children:a.jsx(It,{className:"w-4 h-4 text-red-400"})}),a.jsx("h3",{className:"text-base font-semibold text-white",children:"Cancelar Cita"})]}),a.jsx("p",{className:"text-gray-300 mb-3 text-sm",children:"¿Estás seguro de que deseas cancelar esta cita? Esta acción no se puede deshacer."}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Motivo de cancelación (opcional)"}),a.jsx("textarea",{value:g,onChange:R=>x(R.target.value),placeholder:"Ingresa el motivo de la cancelación...",rows:2,className:"w-full px-2 py-1 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500/50 focus:border-red-500/50 resize-none text-sm"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:P,className:"flex-1 px-3 py-1 bg-gray-700/50 text-gray-300 rounded-lg hover:bg-gray-600/50 transition-all duration-200 border border-gray-600/50 text-sm",children:"Mantener Cita"}),a.jsx(He,{onClick:L,variant:"danger",className:"flex-1 px-3 py-1 text-sm",children:"Cancelar Cita"})]})]})})]})})})},Su=()=>{const{user:e}=er();if(!e)return a.jsx(kr,{to:"/login"});switch(e.role){case"admin":return a.jsxs(gs,{children:[a.jsx(Ie,{path:"/",element:a.jsx($i,{})}),a.jsx(Ie,{path:"/new",element:a.jsx($i,{})}),a.jsx(Ie,{path:"*",element:a.jsx(kr,{to:"/appointment",replace:!0})})]});case"barber":return a.jsxs(gs,{children:[a.jsx(Ie,{path:"/",element:a.jsx(Ui,{})}),a.jsx(Ie,{path:"/new",element:a.jsx(Ui,{})}),a.jsx(Ie,{path:"*",element:a.jsx(kr,{to:"/appointment",replace:!0})})]});default:return a.jsxs(gs,{children:[a.jsx(Ie,{path:"/",element:a.jsx(Wi,{})}),a.jsx(Ie,{path:"/new",element:a.jsx(Wi,{})}),a.jsx(Ie,{path:"*",element:a.jsx(kr,{to:"/appointment",replace:!0})})]})}},Ze=({children:e,className:t="",gradient:r="primary",customGradient:s,as:n="span",...i})=>{const o={primary:"from-red-600 via-white to-blue-600",secondary:"from-blue-600 via-white to-red-600",metallic:"from-slate-400 via-red-500 via-white via-blue-500 to-slate-400",patriot:"from-red-700 via-gray-100 to-blue-700",classic:"from-red-800 via-yellow-100 via-white via-blue-100 to-blue-800",premium:"from-blue-800 via-red-600 via-gray-100 to-blue-800",vintage:"from-red-900 via-orange-100 via-white via-blue-100 to-blue-900",elegant:"from-red-500 via-gray-200 to-blue-500"},l=s||o[r]||o.primary;return a.jsx(n,{className:`
        text-transparent bg-clip-text bg-gradient-to-r ${l} 
        font-bold relative
        [text-shadow:0_2px_4px_rgba(0,0,0,0.1)]
        before:absolute before:inset-0 before:bg-gradient-to-r before:${l}
        before:bg-clip-text before:text-transparent before:opacity-20
        before:[filter:blur(0.5px)] before:-z-10
        ${t}
      `,...i,children:e})};function zi(){const{user:e}=er(),[t,r]=O.useState([]),[s,n]=O.useState({name:"",description:"",price:0,duration:30,category:"corte"}),[i,o]=O.useState(null),[l,d]=O.useState(""),[c,u]=O.useState(""),[h,m]=O.useState(!0),[f,g]=O.useState(null);O.useEffect(()=>{x()},[]);const x=async()=>{try{m(!0);const P=await pe.get("/services");if(P.success){const L=P.data||[];r(L)}else throw new Error(P.message||"Error al cargar servicios")}catch(P){console.error("Error en fetchServices:",P),u(P.message||"Error al cargar servicios."),setTimeout(()=>u(""),2500)}finally{m(!1)}},p=P=>{const L=P.target.type==="number"?Number(P.target.value):P.target.value;n(I=>({...I,[P.target.name]:L}))},w=async P=>{P.preventDefault();try{console.log("Enviando formulario:",s);let L;if(i?(console.log("Actualizando servicio:",i._id),L=await pe.put(`/services/${i._id}`,s)):(console.log("Creando nuevo servicio"),L=await pe.post("/services",s)),console.log("Respuesta:",L),L.success)d(i?"✅ Servicio actualizado.":"✅ Servicio creado."),setTimeout(()=>d(""),2500),o(null),n({name:"",description:"",price:0,duration:30,category:"corte"}),x();else throw new Error(L.message||"Error al guardar servicio")}catch(L){console.error("Error en handleSubmit:",L),u(L.message||"Error al guardar servicio"),setTimeout(()=>u(""),2500)}},b=P=>{o(P),n({name:P.name,description:P.description,price:P.price,duration:P.duration,category:P.category}),g("form")},y=async P=>{if(!P){u("ID de servicio inválido"),setTimeout(()=>u(""),2500);return}if(window.confirm("¿Seguro que deseas eliminar este servicio?"))try{console.log("Eliminando servicio:",P);const L=await pe.delete(`/services/${P}`);if(console.log("Respuesta de eliminación:",L),L.success)r(I=>I.filter(H=>H._id!==P)),d("✅ Servicio eliminado."),setTimeout(()=>d(""),2500),(i==null?void 0:i._id)===P&&(o(null),n({name:"",description:"",price:0,duration:30,category:"corte"}));else throw new Error(L.message||"Error al eliminar servicio")}catch(L){console.error("Error en handleDelete:",L),u(L.message||"Error al eliminar servicio"),setTimeout(()=>u(""),2500)}},S=()=>{n({name:"",description:"",price:0,duration:30,category:"corte"}),o(null),g("form")};return a.jsxs("div",{className:"relative min-h-screen bg-gradient-to-b from-black via-gray-900 to-black overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-900/8 via-blue-900/8 to-red-900/8"}),a.jsx("div",{className:"absolute inset-0 opacity-40",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.3) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"radial-gradient(circle, rgba(239, 68, 68, 0.4) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-15",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.5) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}}),a.jsx("div",{className:"relative z-10",children:a.jsx(Ye,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"text-center py-8",children:a.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:a.jsxs(Ze,{className:"text-4xl md:text-5xl font-bold",children:[a.jsx(Ti,{className:"w-10 h-10 mx-auto mb-3"}),"Gestión de Servicios"]})})}),c&&a.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 text-red-400 px-4 py-2 rounded-xl backdrop-blur-sm flex items-center gap-2",children:[a.jsx(Pn,{className:"w-4 h-4"}),c]}),l&&a.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 text-green-400 px-4 py-2 rounded-xl backdrop-blur-sm flex items-center gap-2",children:[a.jsx(ua,{className:"w-4 h-4"}),l]}),a.jsxs("div",{className:"bg-transparent border border-white/10 rounded-2xl backdrop-blur-sm shadow-2xl shadow-blue-500/20",children:[a.jsx("div",{className:"p-4 border-b border-white/10 flex justify-end",children:a.jsx(He,{onClick:S,className:"text-sm px-8 py-2 min-w-[180px]",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(Ca,{className:"w-4 h-4"}),a.jsx("span",{children:"Nuevo Servicio"})]})})}),f==="form"&&a.jsxs("div",{className:"mx-4 mt-4 bg-white/5 border border-white/10 rounded-xl p-6 backdrop-blur-md shadow-2xl shadow-blue-500/20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:a.jsx(Ze,{className:"text-lg font-semibold",children:i?"Editar Servicio":"Nuevo Servicio"})}),a.jsx("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-white transition-colors",children:a.jsx(Sa,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:w,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Nombre"}),a.jsx("input",{name:"name",value:s.name,onChange:p,className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",placeholder:"Ej: Corte de cabello",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Categoría"}),a.jsxs("select",{name:"category",value:s.category,onChange:p,className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",required:!0,children:[a.jsx("option",{value:"corte",children:"Corte"}),a.jsx("option",{value:"barba",children:"Barba"}),a.jsx("option",{value:"combo",children:"Combo"}),a.jsx("option",{value:"tinte",children:"Tinte"}),a.jsx("option",{value:"tratamiento",children:"Tratamiento"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Precio ($)"}),a.jsx("input",{name:"price",type:"number",value:s.price,onChange:p,className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",min:"0",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Duración (min)"}),a.jsx("input",{name:"duration",type:"number",value:s.duration,onChange:p,className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",min:"15",max:"240",step:"15",required:!0})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-4",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Descripción"}),a.jsx("textarea",{name:"description",value:s.description,onChange:p,className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",rows:"3",placeholder:"Describe el servicio...",required:!0})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-4 flex gap-3 pt-2",children:[a.jsx(He,{type:"submit",className:"text-sm px-4 py-2",children:i?"Actualizar":"Crear"}),a.jsx("button",{type:"button",onClick:()=>{o(null),n({name:"",description:"",price:0,duration:30,category:"corte"}),g(null)},className:"px-4 py-2 bg-white/5 text-gray-300 rounded-lg hover:bg-white/10 transition-colors text-sm backdrop-blur-sm",children:"Cancelar"})]})]})]}),h?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}),a.jsx("p",{className:"mt-2 text-gray-400 text-sm",children:"Cargando servicios..."})]}):t.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(Ti,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"No hay servicios registrados"})]}):a.jsx("div",{className:"divide-y divide-white/10",children:t.map(P=>a.jsx("div",{className:"px-4 py-4 hover:bg-white/5 transition-colors backdrop-blur-sm border-b border-white/5",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start",children:[a.jsx("div",{className:"flex items-start gap-4 flex-1",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-lg font-semibold",children:a.jsx(Ze,{className:"text-lg font-semibold",children:P.name})}),a.jsx("p",{className:"text-sm text-gray-400 mt-1 mb-3",children:P.description}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ra,{className:"w-4 h-4 text-green-400"}),a.jsxs("span",{className:"text-green-400 font-medium",children:["$",P.price]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ht,{className:"w-4 h-4 text-blue-400"}),a.jsxs("span",{className:"text-gray-300",children:[P.duration," min"]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"text-gray-300 capitalize",children:P.category})})]})]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>b(P),className:"p-2 bg-blue-600/20 text-blue-400 rounded-lg hover:bg-blue-600/30 transition-colors",title:"Editar",children:a.jsx(Lo,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>y(P._id),className:"p-2 bg-red-600/20 text-red-400 rounded-lg hover:bg-red-600/30 transition-colors",title:"Eliminar",children:a.jsx(Xa,{className:"w-4 h-4"})})]})]})},P._id))})]})]})})})]})}const ku=({title:e,description:t})=>a.jsxs("div",{className:"py-16 sm:py-20 px-4 relative bg-gradient-to-b from-black via-gray-900 to-black",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-900/8 via-blue-900/8 to-red-900/8"}),a.jsx("div",{className:"absolute inset-0 opacity-40",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.3) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"radial-gradient(circle, rgba(239, 68, 68, 0.4) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-15",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.5) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}}),a.jsx("div",{className:"container mx-auto relative z-10",children:a.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[a.jsx("div",{className:"mb-4",children:a.jsx("span",{className:"inline-block px-4 py-2 bg-gradient-to-r from-red-600/20 to-blue-600/20 border border-red-500/30 rounded-full text-sm font-medium uppercase tracking-wider backdrop-blur-sm",children:a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-red-400 to-blue-400",children:"Nuestro Equipo"})})}),a.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold mb-4 leading-tight relative",children:a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-red-400 via-white to-blue-400 relative z-10",children:e})}),a.jsx("p",{className:"text-xl leading-relaxed max-w-2xl mx-auto relative z-10",children:a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-gray-300 via-white to-gray-300",children:t})})]})})]}),Tu=()=>a.jsx(Ye,{children:a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[a.jsxs("div",{className:"relative mb-8",children:[a.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-blue-500/20"}),a.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-blue-500 border-t-transparent animate-spin absolute top-0 left-0"})]}),a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx("h3",{className:"text-2xl font-bold text-white",children:"Cargando barberos..."}),a.jsx("p",{className:"text-gray-400 max-w-md",children:"Estamos preparando la mejor selección de profesionales para ti"})]})]})}),Cu=({message:e})=>a.jsx(Ye,{children:a.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:a.jsx("div",{className:"max-w-md w-full text-center",children:a.jsxs("div",{className:"bg-gradient-to-br from-red-900/50 to-red-800/30 backdrop-blur-sm border border-red-500/30 rounded-3xl p-8",children:[a.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-2xl flex items-center justify-center mx-auto mb-6",children:a.jsx("svg",{className:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("h3",{className:"text-2xl font-bold text-red-300 mb-4",children:"Error al cargar"}),a.jsx("p",{className:"text-gray-300 mb-6",children:e}),a.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-gradient-to-r from-red-600 to-red-500 text-white rounded-xl font-medium hover:from-red-500 hover:to-red-400 transition-all duration-300",children:"Reintentar"})]})})})}),Au=({barber:e})=>{var o,l,d,c,u,h,m,f,g;const{user:t}=er();if(!e||!e.user)return console.error("Barbero inválido:",e),null;const r=t&&t.role==="user",n=(()=>{const x=new Date,p=x.toTimeString().slice(0,5),b=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][x.getDay()];if(!e.schedule||!e.schedule[b])return{available:!1,reason:"Sin horario definido"};const y=e.schedule[b];if(!y.available)return{available:!1,reason:"No trabaja hoy"};const S=y.start,P=y.end;return p<S?{available:!1,reason:`Abre a las ${S}`}:p>P?{available:!1,reason:`Cerró a las ${P}`}:{available:!0,reason:`Hasta las ${P}`}})(),i=e.isActive&&n.available;return a.jsxs("article",{className:"group relative overflow-hidden rounded-3xl transform hover:scale-[1.02] transition-all duration-500 bg-gradient-to-br from-gray-800/40 via-gray-900/60 to-black/40 backdrop-blur-sm border border-gray-700/50 hover:border-blue-500/50 shadow-2xl hover:shadow-blue-500/20 flex flex-col h-full",children:[a.jsxs("div",{className:"relative h-80 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/70 to-transparent z-10"}),(o=e.photo)!=null&&o.url||(d=(l=e.user)==null?void 0:l.photo)!=null&&d.url?a.jsx("img",{src:((c=e.photo)==null?void 0:c.url)||((h=(u=e.user)==null?void 0:u.photo)==null?void 0:h.url),alt:(m=e.user)==null?void 0:m.name,className:"w-full h-full object-cover transform transition-transform duration-700 group-hover:scale-110"}):a.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-700 via-blue-900/50 to-gray-800 flex items-center justify-center",children:a.jsx("div",{className:"p-4 rounded-full bg-blue-600/10 backdrop-blur",children:a.jsx("svg",{className:"w-24 h-24 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})}),a.jsx("div",{className:"absolute top-6 left-6 z-20",children:a.jsx("div",{className:`flex items-center px-4 py-2 rounded-2xl text-sm font-medium text-white shadow-lg backdrop-blur-sm transition-all duration-300 border
              ${i?"bg-emerald-500/90 border-emerald-400/30 group-hover:bg-emerald-400/90":"bg-red-500/90 border-red-400/30 group-hover:bg-red-400/90"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${i?"bg-white animate-pulse":"bg-white/80"}`}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs font-bold leading-tight",children:i?"Disponible":"No disponible"}),a.jsx("span",{className:"text-xs opacity-90 leading-tight",children:n.reason})]})]})})}),a.jsxs("div",{className:"absolute top-6 right-6 flex flex-col gap-3 z-20",children:[((f=e.rating)==null?void 0:f.average)>0&&a.jsxs("div",{className:"bg-gradient-to-r from-yellow-600/90 to-orange-600/90 backdrop-blur-sm px-4 py-2 rounded-2xl text-sm font-semibold text-white shadow-lg flex items-center gap-2 group-hover:from-yellow-500/90 group-hover:to-orange-500/90 transition-all duration-300 border border-yellow-400/30",children:[a.jsx(Rt,{className:"w-4 h-4 fill-current"}),a.jsx("span",{children:e.rating.average.toFixed(1)}),e.rating.count>0&&a.jsxs("span",{className:"text-xs text-yellow-100/75",children:["(",e.rating.count,")"]})]}),e.experience>0&&a.jsxs("div",{className:"bg-gradient-to-r from-blue-600/90 to-purple-600/90 backdrop-blur-sm px-4 py-2 rounded-2xl text-sm font-medium text-white shadow-lg group-hover:from-blue-500/90 group-hover:to-purple-500/90 transition-all duration-300 flex items-center gap-2 border border-blue-400/30",children:[a.jsx(Nn,{className:"w-4 h-4"}),a.jsxs("span",{children:[e.experience," años"]})]})]}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black via-gray-900/95 to-transparent z-20",children:[a.jsx("h2",{className:"text-2xl font-bold mb-2 transition-all duration-300",children:a.jsx("span",{className:`text-transparent bg-clip-text bg-gradient-to-r from-red-400 via-white to-blue-400 \r
                group-hover:from-blue-400 group-hover:via-white group-hover:to-red-400`,children:(g=e.user)==null?void 0:g.name})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4 text-blue-400 group-hover:text-red-400 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),a.jsx("p",{className:"text-gray-300 group-hover:text-gray-100 transition-colors duration-300 font-medium",children:e.specialty||"Barbero Profesional"})]})]})]}),a.jsxs("div",{className:"p-6 flex flex-col flex-grow",children:[a.jsx("div",{className:"flex-grow",children:e.services&&e.services.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h3",{className:"text-sm font-bold flex items-center gap-2",children:[a.jsx("span",{className:`text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-red-400 \r
                    group-hover:from-red-400 group-hover:to-blue-400 transition-all duration-300`,children:"Servicios destacados"}),a.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:e.services.slice(0,4).map((x,p)=>a.jsxs("div",{className:`px-4 py-2 bg-gradient-to-br from-gray-800/60 via-gray-700/40 to-gray-800/60 \r
                    border border-gray-600/30 rounded-xl text-sm backdrop-blur-sm\r
                    hover:from-gray-700/70 hover:via-gray-600/50 hover:to-gray-700/70 \r
                    hover:border-blue-500/40 transition-all cursor-default group/service\r
                    hover:shadow-lg hover:shadow-blue-500/10`,children:[a.jsx("div",{className:"font-bold mb-1 transition-all duration-300",children:a.jsx("span",{className:`text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-white \r
                        group-hover/service:from-white group-hover/service:to-blue-400`,children:x.name})}),a.jsx("div",{className:"font-semibold",children:a.jsxs("span",{className:`text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-blue-400 \r
                        group-hover/service:from-emerald-300 group-hover/service:to-blue-300 \r
                        transition-all duration-300`,children:["$",x.price]})})]},`${e._id}-service-${x._id}-${p}`))}),e.services.length>4&&a.jsxs("p",{className:"text-sm text-center font-medium text-gray-400",children:["Y ",e.services.length-4," servicios más..."]})]})}),a.jsxs("div",{className:"flex gap-3 pt-4 mt-auto",children:[a.jsxs(Ae,{to:`/barbers/${e._id}`,className:`flex-1 px-4 py-3 bg-gradient-to-r from-gray-800/60 via-gray-700/70 to-gray-800/60 \r
              hover:from-gray-700/70 hover:via-gray-600/80 hover:to-gray-700/70 rounded-xl font-bold text-center \r
              transition-all duration-300 border border-gray-600/30 hover:border-gray-500/50 backdrop-blur-sm\r
              flex items-center justify-center gap-2 group hover:shadow-lg hover:-translate-y-0.5\r
              hover:shadow-gray-500/20`,children:[a.jsx("span",{className:`text-transparent bg-clip-text bg-gradient-to-r from-white to-blue-200 \r
                group-hover:from-blue-400 group-hover:to-white transition-all duration-300`,children:"Ver Perfil"}),a.jsx("svg",{className:"w-4 h-4 transform transition-all duration-300 group-hover:translate-x-1 text-gray-300 group-hover:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),r&&i&&a.jsxs(Ae,{to:`/appointment?barberId=${e._id}`,className:`flex-1 px-4 py-3 bg-gradient-to-r from-blue-600/90 to-red-600/90 \r
                hover:from-blue-500/90 hover:to-red-500/90 rounded-xl font-bold text-center \r
                transition-all duration-300 border border-blue-500/50 hover:border-red-400/50 \r
                backdrop-blur-sm flex items-center justify-center gap-2 group\r
                hover:shadow-lg hover:-translate-y-0.5 hover:shadow-blue-500/20`,children:[a.jsx("span",{className:`text-transparent bg-clip-text bg-gradient-to-r from-white to-blue-100 \r
                  group-hover:from-white group-hover:to-red-100 transition-all duration-300`,children:"Reservar"}),a.jsx("svg",{className:"w-4 h-4 transform transition-all duration-300 group-hover:translate-x-1 text-white group-hover:text-red-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]})]})]})},Du=()=>{const[e,t]=O.useState([]),[r,s]=O.useState(!0),[n,i]=O.useState(null),[o,l]=O.useState(Date.now());if(O.useEffect(()=>{const c=async()=>{try{const h=Date.now(),m=await pe.get(`/barbers?_t=${h}`);if(!m.success)throw new Error("La respuesta no fue exitosa");if(!Array.isArray(m.data))throw new Error("Los datos de barberos no son válidos");const f=m.data.filter(g=>g.user&&g.user.role==="barber"&&g.isActive);t(f),s(!1)}catch(h){i(h.message||"Error al cargar los barberos"),s(!1)}};c();const u=()=>{document.hidden||(console.log("📱 Página visible de nuevo, refrescando barberos..."),c())};return document.addEventListener("visibilitychange",u),()=>{document.removeEventListener("visibilitychange",u)}},[]),O.useEffect(()=>{const c=setInterval(()=>{l(Date.now())},6e4);return()=>clearInterval(c)},[]),r)return a.jsx(Tu,{});if(n)return a.jsx("div",{className:"min-h-screen bg-gray-900 p-4",children:a.jsx(Cu,{message:n})});const d=[...e].sort((c,u)=>{var h,m;return(((h=u.rating)==null?void 0:h.average)||0)-(((m=c.rating)==null?void 0:m.average)||0)});return a.jsxs("div",{className:"relative min-h-screen bg-gradient-to-b from-black via-gray-900 to-black overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-900/8 via-blue-900/8 to-red-900/8"}),a.jsx("div",{className:"absolute inset-0 opacity-40",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.3) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"radial-gradient(circle, rgba(239, 68, 68, 0.4) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-15",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.5) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}}),a.jsxs("div",{className:"relative z-10",children:[a.jsx(ku,{title:"Nuestros Barberos",description:"Conoce a nuestro equipo de profesionales expertos en el arte del cuidado masculino"}),a.jsxs("div",{className:"py-6 px-4 relative",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-gray-900/30 to-transparent"}),a.jsx("div",{className:"container mx-auto relative z-10",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 items-stretch",children:d.map(c=>a.jsx(Au,{barber:c},`${c._id}-${o}`))})})]})]})]})};function Fu(){const[e,t]=O.useState(""),[r,s]=O.useState(""),[n,i]=O.useState(""),[o,l]=O.useState(!1),{login:d,error:c}=er(),{showError:u,showSuccess:h}=Er(),m=Ya(),f=async g=>{g.preventDefault(),i(""),l(!0);try{if(await d(e,r))h("¡Bienvenido! Has iniciado sesión correctamente"),m("/");else{const p=c||"Credenciales incorrectas. Por favor verifica tu email y contraseña.";u(p),i(p)}}catch{const p="Error al iniciar sesión. Por favor intenta nuevamente.";u(p),i(p)}finally{l(!1)}};return a.jsxs(Ye,{children:[a.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.15) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-8",style:{backgroundImage:"radial-gradient(circle, rgba(239, 68, 68, 0.12) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-6",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.1) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}}),a.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center py-12 px-4",children:a.jsx("div",{className:"w-full max-w-md relative",children:a.jsxs("div",{className:"bg-gray-800/30 backdrop-blur-xl rounded-2xl p-8 sm:p-10 border border-white/10 shadow-xl shadow-blue-500/10 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/10 via-blue-600/10 to-red-600/10 rounded-2xl blur-xl transform rotate-3 scale-105 -z-10"}),a.jsxs("div",{className:"absolute top-0 left-0 right-0 h-20",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-blue-600/20 via-blue-600/10 to-transparent"}),a.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-blue-400 to-transparent"})]}),a.jsxs("div",{className:"text-center mb-8 relative",children:[a.jsxs("div",{className:"w-32 h-32 mx-auto mb-6 relative group",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/20 via-blue-600/20 to-red-600/20 rounded-full blur-xl transform group-hover:scale-110 transition-transform duration-500"}),a.jsx("img",{src:"/images/logo 1.png",alt:"The Brothers Barber Shop",className:"w-full h-full object-contain relative z-10 transform group-hover:scale-105 transition-transform duration-500",style:{filter:"drop-shadow(0 0 20px rgba(59, 130, 246, 0.5))"},onError:g=>{g.target.onerror=null,g.target.src="/images/logo 4.png"}})]}),a.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-3",children:a.jsx("span",{className:"bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent",children:"Iniciar sesión"})}),a.jsx("p",{className:"text-base",children:a.jsx("span",{className:"bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Ingresa a tu cuenta para continuar"})})]}),a.jsxs("form",{onSubmit:f,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium mb-2",children:a.jsx("span",{className:"bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Correo electrónico"})}),a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/20 via-blue-600/20 to-red-600/20 rounded-xl blur opacity-75 group-hover:opacity-100 transition-opacity duration-300"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-10",children:a.jsx("div",{className:"w-5 h-5 rounded-full bg-gradient-to-r from-blue-400 to-purple-400 flex items-center justify-center",children:a.jsx("svg",{className:"h-3 w-3 text-gray-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})})}),a.jsx("input",{id:"email",type:"email",value:e,onChange:g=>t(g.target.value),required:!0,placeholder:"tu@email.com",className:"block w-full pl-10 pr-4 py-3 bg-gray-700/20 border border-white/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-400 relative z-10 backdrop-blur-xl text-sm placeholder:text-gray-400 text-gray-200"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium mb-2",children:a.jsx("span",{className:"bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Contraseña"})}),a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/20 via-blue-600/20 to-red-600/20 rounded-xl blur opacity-75 group-hover:opacity-100 transition-opacity duration-300"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-10",children:a.jsx("div",{className:"w-5 h-5 rounded-full bg-gradient-to-r from-blue-400 to-purple-400 flex items-center justify-center",children:a.jsx("svg",{className:"h-3 w-3 text-gray-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8V7a4 4 0 00-8 0v4h8z"})})})}),a.jsx("input",{id:"password",type:"password",value:r,onChange:g=>s(g.target.value),required:!0,placeholder:"••••••••",className:"block w-full pl-10 pr-4 py-3 bg-gray-700/20 border border-white/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-400 relative z-10 backdrop-blur-xl text-sm placeholder:text-gray-400 text-gray-200"})]})]}),n&&a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-red-600/50 to-red-700/50 rounded-xl blur-lg opacity-75"}),a.jsxs("div",{className:"relative bg-red-900/30 border border-red-500/50 p-4 rounded-xl text-sm flex items-start backdrop-blur-xl",children:[a.jsx("svg",{className:"h-5 w-5 text-red-400 mr-3 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.jsx("span",{className:"bg-gradient-to-r from-red-200 to-red-300 bg-clip-text text-transparent",children:n})]})]}),a.jsx(He,{type:"submit",disabled:o,loading:o,loadingText:"Iniciando sesión...",variant:"primary",className:"w-full py-3",children:"Iniciar sesión"}),a.jsx("div",{className:"text-center relative",children:a.jsxs("div",{className:"inline-block",children:[a.jsx("span",{className:"text-sm",children:a.jsxs("span",{className:"bg-gradient-to-r from-gray-300 to-gray-400 bg-clip-text text-transparent",children:["¿No tienes cuenta?"," "]})}),a.jsxs(Ae,{to:"/register",className:"relative inline-block font-medium group",children:[a.jsx("span",{className:"relative z-10 text-sm bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent font-bold hover:from-blue-300 hover:to-purple-300 transition-all duration-300",children:"Regístrate"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-blue-400 to-purple-400 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300"})]})]})})]})]})})})]})}function Pu(){const[e,t]=O.useState({name:"",email:"",password:""}),[r,s]=O.useState(""),[n,i]=O.useState(""),[o,l]=O.useState(!1),{showError:d,showSuccess:c}=Er(),u=Ya(),h=f=>{t({...e,[f.target.name]:f.target.value})},m=async f=>{if(f.preventDefault(),s(""),i(""),l(!0),!/^[a-zA-ZÀ-ÿ\s]+$/.test(e.name)){const g="El nombre solo puede contener letras y espacios";s(g),d(g),l(!1);return}if(e.name.length<2||e.name.length>50){const g="El nombre debe tener entre 2 y 50 caracteres";s(g),d(g),l(!1);return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)){const g="Debe proporcionar un email válido";s(g),d(g),l(!1);return}if(e.password.length<6){const g="La contraseña debe tener al menos 6 caracteres";s(g),d(g),l(!1);return}if(!/\d/.test(e.password)){const g="La contraseña debe contener al menos un número";s(g),d(g),l(!1);return}try{const g={name:e.name,email:e.email.toLowerCase(),password:e.password,role:"user"},x=await Nt.register(g);if(x.success===!1){const w=x.message||"Error en el registro";s(w),d(w),l(!1);return}const p="¡Registro exitoso! Redirigiendo al login...";i(p),c(p),x.token&&(localStorage.setItem("token",x.token),localStorage.setItem("user",JSON.stringify(x.user))),setTimeout(()=>{u("/login")},1e3)}catch(g){console.error("Error durante el registro:",g);let x="Error en el registro. Por favor, intenta de nuevo.";g.errors&&Array.isArray(g.errors)?x=g.errors[0].msg||"Error de validación":g.message&&(x=g.message),s(x),d(x)}finally{l(!1)}};return a.jsxs(Ye,{children:[a.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.15) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-8",style:{backgroundImage:"radial-gradient(circle, rgba(239, 68, 68, 0.12) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-6",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.1) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}}),a.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center py-12 px-4",children:a.jsx("div",{className:"w-full max-w-md relative",children:a.jsxs("div",{className:"bg-gray-800/30 backdrop-blur-xl rounded-2xl p-8 sm:p-10 border border-white/10 shadow-xl shadow-blue-500/10 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/10 via-blue-600/10 to-red-600/10 rounded-2xl blur-xl transform rotate-3 scale-105 -z-10"}),a.jsxs("div",{className:"absolute top-0 left-0 right-0 h-20",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-blue-600/20 via-blue-600/10 to-transparent"}),a.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-blue-400 to-transparent"})]}),a.jsxs("div",{className:"text-center mb-8 relative",children:[a.jsxs("div",{className:"w-32 h-32 mx-auto mb-6 relative group",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/20 via-blue-600/20 to-red-600/20 rounded-full blur-xl transform group-hover:scale-110 transition-transform duration-500"}),a.jsx("img",{src:"/images/logo 1.png",alt:"The Brothers Barber Shop",className:"w-full h-full object-contain relative z-10 transform group-hover:scale-105 transition-transform duration-500",style:{filter:"drop-shadow(0 0 20px rgba(59, 130, 246, 0.5))"},onError:f=>{f.target.onerror=null,f.target.src="/images/logo 4.png"}})]}),a.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-3",children:a.jsx("span",{className:"bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent",children:"Crear cuenta"})}),a.jsx("p",{className:"text-base",children:a.jsx("span",{className:"bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Únete a nuestra comunidad"})})]}),a.jsxs("form",{onSubmit:m,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-2",children:a.jsx("span",{className:"bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Nombre completo"})}),a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/20 via-blue-600/20 to-red-600/20 rounded-xl blur opacity-75 group-hover:opacity-100 transition-opacity duration-300"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-10",children:a.jsx("div",{className:"w-5 h-5 rounded-full bg-gradient-to-r from-blue-400 to-purple-400 flex items-center justify-center",children:a.jsx("svg",{className:"h-3 w-3 text-gray-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})}),a.jsx("input",{id:"name",name:"name",type:"text",value:e.name,onChange:h,required:!0,placeholder:"John Doe",className:"block w-full pl-10 pr-4 py-3 bg-gray-700/20 border border-white/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-400 relative z-10 backdrop-blur-xl text-sm placeholder:text-gray-400 text-gray-200"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium mb-2",children:a.jsx("span",{className:"bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Correo electrónico"})}),a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/20 via-blue-600/20 to-red-600/20 rounded-xl blur opacity-75 group-hover:opacity-100 transition-opacity duration-300"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-10",children:a.jsx("div",{className:"w-5 h-5 rounded-full bg-gradient-to-r from-blue-400 to-purple-400 flex items-center justify-center",children:a.jsx("svg",{className:"h-3 w-3 text-gray-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})})}),a.jsx("input",{id:"email",name:"email",type:"email",value:e.email,onChange:h,required:!0,placeholder:"tu@email.com",className:"block w-full pl-10 pr-4 py-3 bg-gray-700/20 border border-white/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-400 relative z-10 backdrop-blur-xl text-sm placeholder:text-gray-400 text-gray-200"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium mb-2",children:a.jsx("span",{className:"bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Contraseña"})}),a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/20 via-blue-600/20 to-red-600/20 rounded-xl blur opacity-75 group-hover:opacity-100 transition-opacity duration-300"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-10",children:a.jsx("div",{className:"w-5 h-5 rounded-full bg-gradient-to-r from-blue-400 to-purple-400 flex items-center justify-center",children:a.jsx("svg",{className:"h-3 w-3 text-gray-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8V7a4 4 0 00-8 0v4h8z"})})})}),a.jsx("input",{id:"password",name:"password",type:"password",value:e.password,onChange:h,required:!0,placeholder:"••••••••",className:"block w-full pl-10 pr-4 py-3 bg-gray-700/20 border border-white/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-400 relative z-10 backdrop-blur-xl text-sm placeholder:text-gray-400 text-gray-200"})]}),a.jsx("p",{className:"mt-2 text-sm",children:a.jsx("span",{className:"bg-gradient-to-r from-gray-400 to-gray-500 bg-clip-text text-transparent",children:"Mínimo 6 caracteres, incluyendo al menos un número"})})]}),r&&a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-red-600/50 to-red-700/50 rounded-xl blur-lg opacity-75"}),a.jsxs("div",{className:"relative bg-red-900/30 border border-red-500/50 p-4 rounded-xl text-sm flex items-start backdrop-blur-xl",children:[a.jsx("svg",{className:"h-5 w-5 text-red-400 mr-3 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.jsx("span",{className:"bg-gradient-to-r from-red-200 to-red-300 bg-clip-text text-transparent",children:r})]})]}),n&&a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-green-600/50 to-green-700/50 rounded-xl blur-lg opacity-75"}),a.jsxs("div",{className:"relative bg-green-900/30 border border-green-500/50 p-4 rounded-xl text-sm flex items-start backdrop-blur-xl",children:[a.jsx("svg",{className:"h-5 w-5 text-green-400 mr-3 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.jsx("span",{className:"bg-gradient-to-r from-green-200 to-green-300 bg-clip-text text-transparent",children:n})]})]}),a.jsx(He,{type:"submit",disabled:o,loading:o,loadingText:"Creando cuenta...",variant:"primary",className:"w-full py-3",children:"Crear cuenta"}),a.jsx("div",{className:"text-center relative",children:a.jsxs("div",{className:"inline-block",children:[a.jsx("span",{className:"text-sm",children:a.jsxs("span",{className:"bg-gradient-to-r from-gray-300 to-gray-400 bg-clip-text text-transparent",children:["¿Ya tienes cuenta?"," "]})}),a.jsxs(Ae,{to:"/login",className:"relative inline-block font-medium group",children:[a.jsx("span",{className:"relative z-10 text-sm bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent font-bold hover:from-blue-300 hover:to-purple-300 transition-all duration-300",children:"Inicia sesión"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-blue-400 to-purple-400 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300"})]})]})})]})]})})})]})}function Hi(){var h,m,f,g,x,p;const{id:e}=dc(),[t,r]=O.useState(null),[s,n]=O.useState(!0),[i,o]=O.useState(null),[l,d]=O.useState(null),{user:c}=er();O.useEffect(()=>{u()},[e]);const u=async()=>{var w;try{n(!0),o(null);const b=await pe.get(`/barbers/${e}`);if(b.success){if(console.log("Datos del barbero recibidos:",b.data),r(b.data),(c==null?void 0:c.role)==="admin")try{const y=await pe.get(`/barbers/${e}/stats`);y.success&&d(y.data)}catch(y){console.warn("No se pudieron cargar las estadísticas:",y)}}else o("Error al cargar los datos del barbero")}catch(b){console.error("Error fetching barber data:",b),((w=b.response)==null?void 0:w.status)===404?o("Barbero no encontrado"):o("Error al conectar con el servidor")}finally{n(!1)}};return s?a.jsx(Ye,{children:a.jsx("div",{className:"flex justify-center items-center min-h-[60vh] p-4",children:a.jsx("div",{className:"bg-gray-800/30 backdrop-blur-sm border border-gray-700/40 rounded-2xl p-8 shadow-xl text-center",children:a.jsx("div",{className:"text-blue-400 mb-4",children:a.jsx("div",{className:"w-16 h-16 border-t-4 border-blue-400/40 rounded-full animate-spin"})})})})}):i?a.jsx(Ye,{children:a.jsx("div",{className:"flex flex-col justify-center items-center min-h-[60vh] p-4",children:a.jsxs("div",{className:"bg-red-900/30 border border-red-500/50 rounded-2xl p-8 max-w-lg w-full text-center shadow-xl shadow-red-500/10",children:[a.jsx("div",{className:"bg-red-800/50 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx("svg",{className:"w-10 h-10 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("h3",{className:"text-2xl font-bold text-red-400 mb-4",children:i}),a.jsxs(Ae,{to:"/barbers",className:"inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-gray-700/50 to-gray-600/50 hover:from-gray-600/50 hover:to-gray-500/50 text-white rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl",children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Volver a la lista de barberos"]})]})})}):t?a.jsx(Ye,{children:a.jsxs("div",{className:"min-h-screen relative",children:[a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/30 rounded-2xl p-8 backdrop-blur-sm",children:[a.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center gap-6",children:[a.jsx("div",{className:"relative",children:(()=>{var y,S,P;const b=c&&t&&(c._id===((y=t.user)==null?void 0:y._id)||c._id===t._id)?c.profilePicture:((S=t==null?void 0:t.user)==null?void 0:S.photo)||(t==null?void 0:t.profilePicture);return b?a.jsx("img",{src:b,alt:((P=t==null?void 0:t.user)==null?void 0:P.name)||(t==null?void 0:t.name),className:"w-32 h-32 rounded-full object-cover shadow-xl"}):a.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-500/20 to-purple-600/20 flex items-center justify-center shadow-xl",children:a.jsx(Nr,{className:"w-16 h-16 text-blue-400"})})})()}),a.jsxs("div",{className:"flex-1",children:[a.jsx(Ze,{className:"text-4xl font-bold mb-2",children:((h=t==null?void 0:t.user)==null?void 0:h.name)||(t==null?void 0:t.name)||"Cargando..."}),a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Nn,{className:"w-5 h-5 text-blue-400"}),a.jsx("span",{className:"text-gray-300 font-medium",children:"Barbero Profesional"})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[(((m=t==null?void 0:t.user)==null?void 0:m.email)||(t==null?void 0:t.email))&&a.jsxs("div",{className:"flex items-center gap-3 text-gray-300",children:[a.jsx(Cn,{className:"w-5 h-5 text-blue-400"}),a.jsx("span",{children:((f=t==null?void 0:t.user)==null?void 0:f.email)||(t==null?void 0:t.email)})]}),(((g=t==null?void 0:t.user)==null?void 0:g.phone)||(t==null?void 0:t.phone))&&a.jsxs("div",{className:"flex items-center gap-3 text-gray-300",children:[a.jsx(An,{className:"w-5 h-5 text-blue-400"}),a.jsx("span",{children:((x=t==null?void 0:t.user)==null?void 0:x.phone)||(t==null?void 0:t.phone)})]}),(t==null?void 0:t.specialties)&&t.specialties.length>0&&a.jsxs("div",{className:"flex items-center gap-3 text-gray-300",children:[a.jsx(Rt,{className:"w-5 h-5 text-blue-400"}),a.jsx("span",{children:t.specialties.join(", ")})]}),(t==null?void 0:t.experience)&&a.jsxs("div",{className:"flex items-center gap-3 text-gray-300",children:[a.jsx(Nn,{className:"w-5 h-5 text-blue-400"}),a.jsxs("span",{children:[t.experience," años de experiencia"]})]})]})]})]}),(t==null?void 0:t.description)&&a.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-700/30",children:[a.jsxs("h3",{className:"text-xl font-semibold text-blue-400 mb-3 flex items-center gap-2",children:[a.jsx(Nr,{className:"w-5 h-5"}),"Sobre mí"]}),a.jsx("p",{className:"text-gray-300 leading-relaxed bg-gray-800/20 rounded-xl p-4",children:t.description})]})]})}),a.jsxs("div",{className:"space-y-8",children:[a.jsx("div",{className:"w-full",children:a.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/30 rounded-2xl p-8 backdrop-blur-sm",children:[a.jsx("h3",{className:"text-xl font-semibold mb-6 flex items-center gap-2",children:a.jsxs(Ze,{children:[a.jsx(ht,{className:"w-6 h-6"}),"Horario de Atención"]})}),t!=null&&t.schedule?a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"grid grid-cols-7 gap-2 min-w-max",children:Object.entries(t.schedule).map(([w,b])=>{const y={monday:"LUN",tuesday:"MAR",wednesday:"MIÉ",thursday:"JUE",friday:"VIE",saturday:"SÁB",sunday:"DOM"};return a.jsxs("div",{className:"text-center min-w-[80px]",children:[a.jsx("div",{className:`p-2 rounded-t-lg font-semibold text-sm ${b.available?"bg-blue-500/20 text-blue-300 border-b-2 border-blue-500/50":"bg-gray-800/30 text-gray-500 border-b-2 border-gray-600/30"}`,children:y[w]}),a.jsx("div",{className:`p-3 rounded-b-lg text-xs leading-tight min-h-[60px] flex flex-col justify-center ${b.available?"bg-gray-700/30 text-gray-200 border border-t-0 border-gray-600/20":"bg-gray-900/30 text-gray-500 border border-t-0 border-gray-800/20"}`,children:b.available?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"font-medium",children:a.jsx(Ze,{className:"text-sm font-bold",children:b.start})}),a.jsx("div",{className:"text-gray-400",children:"a"}),a.jsx("div",{className:"font-medium",children:a.jsx(Ze,{className:"text-sm font-bold",children:b.end})})]}):a.jsx("div",{className:"text-center",children:"Cerrado"})})]},w)})})}):a.jsxs("div",{className:"text-center py-8 text-gray-400",children:[a.jsx(ht,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),a.jsx("p",{children:"Horario no disponible"})]})]})}),a.jsx("div",{className:"w-full",children:a.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/30 rounded-2xl p-8 backdrop-blur-sm",children:[a.jsx("h3",{className:"text-xl font-semibold mb-6 flex items-center gap-2",children:a.jsxs(Ze,{children:[a.jsx(jr,{className:"w-6 h-6"}),"Servicios Disponibles"]})}),((p=t==null?void 0:t.services)==null?void 0:p.length)>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"flex gap-4 pb-2 w-max",children:t.services.map((w,b)=>a.jsx("div",{className:"group bg-gray-800/20 hover:bg-gray-800/40 p-4 rounded-xl transition-all duration-300 border border-gray-700/20 hover:border-blue-500/30 flex-shrink-0 min-w-[200px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"font-medium mb-2 text-sm",children:a.jsx(Ze,{className:"font-bold",children:w.name})}),a.jsxs("div",{className:"text-blue-400 font-bold bg-blue-500/10 px-3 py-2 rounded-full group-hover:bg-blue-500/20 transition-all duration-300 text-lg",children:["$",w.price]}),w.duration&&a.jsxs("div",{className:"text-xs text-gray-400 mt-2",children:[w.duration," min"]})]})},b))})}):a.jsxs("div",{className:"text-center py-8 text-gray-400",children:[a.jsx(jr,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),a.jsx("p",{children:"No hay servicios disponibles"})]}),c&&c.role==="user"&&a.jsx("div",{className:"mt-6 pt-6 border-t border-gray-700/30",children:a.jsxs(Ae,{to:`/appointment?barberId=${t==null?void 0:t._id}`,className:"group w-full flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white rounded-xl transition-all duration-300 transform hover:scale-105 hover:shadow-xl hover:shadow-blue-500/25",children:[a.jsx(nr,{className:"w-5 h-5 group-hover:rotate-12 transition-transform duration-300"}),a.jsx("span",{className:"font-semibold",children:"Reservar Cita"})]})})]})}),(c==null?void 0:c.role)==="admin"&&a.jsx("div",{className:"w-full",children:a.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/30 rounded-2xl p-8 backdrop-blur-sm",children:[a.jsx("h3",{className:"text-xl font-semibold mb-6 flex items-center gap-2",children:a.jsxs(Ze,{children:[a.jsx(fa,{className:"w-6 h-6"}),"Estadísticas"]})}),l?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"group bg-gray-800/20 hover:bg-gray-800/40 p-4 rounded-xl transition-all duration-300 border border-gray-700/20 hover:border-blue-500/30",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(nr,{className:"w-4 h-4 text-blue-400"}),a.jsx("span",{className:"text-sm text-gray-400",children:"Total Citas"})]}),a.jsx("div",{className:"text-2xl font-bold text-white",children:l.totalAppointments||0})]}),a.jsxs("div",{className:"group bg-gray-800/20 hover:bg-gray-800/40 p-4 rounded-xl transition-all duration-300 border border-gray-700/20 hover:border-green-500/30",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Ra,{className:"w-4 h-4 text-green-400"}),a.jsx("span",{className:"text-sm text-gray-400",children:"Ingresos"})]}),a.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["$",l.totalRevenue||0]})]}),a.jsxs("div",{className:"group bg-gray-800/20 hover:bg-gray-800/40 p-4 rounded-xl transition-all duration-300 border border-gray-700/20 hover:border-purple-500/30",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx($s,{className:"w-4 h-4 text-purple-400"}),a.jsx("span",{className:"text-sm text-gray-400",children:"Este Mes"})]}),a.jsx("div",{className:"text-2xl font-bold text-purple-400",children:l.currentMonthAppointments||0})]}),a.jsxs("div",{className:"group bg-gray-800/20 hover:bg-gray-800/40 p-4 rounded-xl transition-all duration-300 border border-gray-700/20 hover:border-yellow-500/30",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Rt,{className:"w-4 h-4 text-yellow-400"}),a.jsx("span",{className:"text-sm text-gray-400",children:"Rating"})]}),a.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:l.averageRating||"0.0"})]})]}),l.appointmentsByService&&l.appointmentsByService.length>0&&a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-blue-400 mb-4 flex items-center gap-2",children:[a.jsx(Rt,{className:"w-5 h-5"}),"Servicios Populares"]}),a.jsx("div",{className:"space-y-3",children:l.appointmentsByService.map((w,b)=>a.jsx("div",{className:"group bg-gray-800/20 hover:bg-gray-800/40 p-4 rounded-xl transition-all duration-300 border border-gray-700/20 hover:border-blue-500/30",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-200 group-hover:text-white",children:w.service}),a.jsxs("div",{className:"text-green-400 text-sm font-medium",children:["$",w.revenue]})]}),a.jsxs("span",{className:"text-blue-400 bg-blue-500/10 px-3 py-1 rounded-full text-sm",children:[w.count," citas"]})]})},b))})]})]}):a.jsxs("div",{className:"text-center py-8 text-gray-400",children:[a.jsx(fa,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),a.jsx("p",{children:"Estadísticas no disponibles"})]})]})})]})]})}):a.jsx(Ye,{children:a.jsx("div",{className:"flex justify-center items-center min-h-[60vh] p-4",children:a.jsxs("div",{className:"bg-yellow-500/20 backdrop-blur-sm border border-yellow-500/40 text-yellow-400 px-8 py-6 rounded-2xl relative max-w-md w-full shadow-xl text-center",children:[a.jsx("div",{className:"bg-yellow-800/50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Barbero no encontrado"}),a.jsx("p",{className:"text-yellow-300 mb-4",children:"El barbero que buscas no existe o ha sido eliminado."}),a.jsx(Ae,{to:"/barbers",className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-gray-700/50 to-gray-600/50 hover:from-gray-600/50 hover:to-gray-500/50 text-white rounded-lg transition-all duration-300",children:"Ver barberos disponibles"})]})})})}const Ou=()=>{const{user:e}=er(),{showSuccess:t,showError:r,showInfo:s}=Er(),{notifySale:n}=Ho(),[i,o]=O.useState([]),[l,d]=O.useState([]),[c,u]=O.useState(!0),[h,m]=O.useState(""),[f,g]=O.useState([]),[x,p]=O.useState("product"),[w,b]=O.useState(null),[y,S]=O.useState(""),[P,L]=O.useState(""),[I,H]=O.useState("all"),[W,J]=O.useState(!1),[ee,R]=O.useState(!1),q=()=>(console.log("🔍 Datos del usuario:",e),console.log("🔍 Role:",e.role),console.log("🔍 user._id:",e._id),console.log("🔍 user.barberId:",e.barberId),e.role==="barber"?e.barberId?(console.log("✅ Usando user.barberId:",e.barberId),e.barberId):(console.log("⚠️ No hay barberId, usando user._id:",e._id),e._id):(console.log("👤 Usuario admin, usando user._id:",e._id),e._id));O.useEffect(()=>{be()},[]);const be=async()=>{u(!0),m("");try{console.log("🔄 Cargando datos iniciales...");const N=Date.now(),[_,U]=await Promise.all([lt.getInventory({_t:N}),Mn.getAllServices()]);console.log("📦 Respuesta de inventario:",_);let re=[];_!=null&&_.success&&(_!=null&&_.data)?re=Array.isArray(_.data)?_.data:[_.data]:Array.isArray(_)&&(re=_),console.log("📦 Productos procesados:",re.length);const z=re.filter(de=>{const ge=de.currentStock||de.stock||de.quantity||0;return console.log(`📦 ${de.name}: stock=${ge}`),de&&ge>0});console.log("📦 Productos disponibles:",z.length);let K=[];U!=null&&U.success&&(U!=null&&U.data)?K=Array.isArray(U.data)?U.data:[U.data]:Array.isArray(U)&&(K=U);const Z=K.filter(de=>de&&de.isActive!==!1);o(z),d(Z),console.log("✅ Datos cargados - Productos:",z.length,"Servicios:",Z.length)}catch(N){console.error("❌ Error cargando datos:",N),m("Error al cargar los productos y servicios"),r("Error al cargar los datos iniciales")}finally{u(!1)}},he=i.filter(N=>{var re,z,K;const _=((re=N.name)==null?void 0:re.toLowerCase().includes(P.toLowerCase()))||((z=N.description)==null?void 0:z.toLowerCase().includes(P.toLowerCase())),U=I==="all"||((K=N.category)==null?void 0:K.toLowerCase())===I.toLowerCase();return _&&U}),je=[...new Set(i.map(N=>N.category).filter(Boolean))],le=(N,_=1)=>{const U=f.find(re=>re.id===N._id&&re.type==="product");if(U){const re=U.quantity+_,z=N.quantity||N.stock||0;if(re>z){r(`Solo hay ${z} unidades disponibles`);return}g(f.map(K=>K.id===N._id&&K.type==="product"?{...K,quantity:re}:K))}else{const re=N.quantity||N.stock||0;if(_>re){r(`Solo hay ${re} unidades disponibles`);return}g([...f,{id:N._id,type:"product",name:N.name,price:N.price,quantity:_,stock:re}])}s(`${N.name} agregado al carrito`)},M=()=>{if(!w||!y){r("Selecciona un servicio y establece el precio");return}const N=parseFloat(y);if(isNaN(N)||N<=0){r("Ingresa un precio válido");return}g([...f,{id:`walkin-${Date.now()}`,type:"walkIn",name:w.name,serviceId:w._id,price:N,quantity:1}]),b(null),S(""),s(`Servicio ${w.name} agregado`)},ie=(N,_)=>{g(f.filter(U=>!(U.id===N&&U.type===_)))},B=(N,_,U)=>{if(U<=0){ie(N,_);return}g(f.map(re=>re.id===N&&re.type===_?re.type==="product"&&U>re.stock?(r(`Solo hay ${re.stock} unidades disponibles`),re):{...re,quantity:U}:re))},ne=f.reduce((N,_)=>N+_.price*_.quantity,0),C=async()=>{if(f.length===0){r("El carrito está vacío");return}J(!0);try{const N=f.filter(de=>de.type==="product"),_=f.filter(de=>de.type==="walkIn"),U=[];if(N.length>0){const de={barberId:q(),items:N.map(ge=>({productId:ge.id,quantity:ge.quantity,price:ge.price})),total:N.reduce((ge,Se)=>ge+Se.price*Se.quantity,0),type:"product"};U.push(bt.createSale(de))}if(_.length>0)for(const de of _){const ge={barberId:q(),serviceId:de.serviceId,serviceName:de.name,price:de.price,total:de.price,type:"walkIn"};U.push(bt.createWalkInSale(ge))}await Promise.all(U);const re=f.length,z=f.filter(de=>de.type==="product").length,K=f.filter(de=>de.type==="service").length;let Z=`✅ Venta completada exitosamente
`;Z+=`💰 Total: $${ne.toLocaleString()}
`,Z+=`📦 Items vendidos: ${re}`,z>0&&(Z+=`
🛍️ Productos: ${z}`),K>0&&(Z+=`
✂️ Servicios: ${K}`),Z+=`
📊 Inventario actualizado automáticamente`,t(Z),R(!0),setTimeout(()=>R(!1),3e3),g([]),b(null),S(""),p("product"),n(),console.log("🔄 Recargando inventario para mostrar stock actualizado..."),setTimeout(async()=>{try{console.log("🔄 Iniciando recarga de inventario después de venta..."),await be(),console.log("✅ Inventario recargado exitosamente después de venta")}catch(de){console.error("❌ Error recargando inventario:",de)}},1500)}catch(N){console.error("Error procesando venta:",N),r("Error al procesar la venta")}finally{J(!1)}},A=N=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(N||0);return c?a.jsx(Ye,{children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mb-4"}),a.jsx("p",{className:"text-gray-400",children:"Cargando productos y servicios..."})]})})}):a.jsx(Ye,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-green-500/20 to-blue-500/20 rounded-2xl mb-4",children:a.jsx(Aa,{className:"w-8 h-8 text-green-400"})}),a.jsx("h1",{className:"text-3xl font-bold mb-2",children:a.jsx(Ze,{children:"Punto de Venta"})}),a.jsx("p",{className:"text-gray-400 text-lg",children:"Registra ventas de productos y servicios walk-in"}),e&&a.jsxs("div",{className:"mt-3 inline-flex items-center px-4 py-2 bg-blue-500/20 text-blue-300 rounded-full text-sm",children:[a.jsx(Nr,{className:"w-4 h-4 mr-2"}),"Barbero: ",e.name||e.email]})]}),h&&a.jsx("div",{className:"bg-red-500/20 border border-red-500/50 rounded-xl p-4 text-red-300",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(qr,{className:"h-5 w-5 mr-2"}),h]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsx("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-700/50",children:a.jsxs("div",{className:"flex space-x-4",children:[a.jsxs("button",{onClick:()=>p("product"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${x==="product"?"bg-blue-500/80 text-white":"bg-gray-700/50 text-gray-300 hover:bg-gray-600/50"}`,children:[a.jsx(Ns,{className:"w-4 h-4 mr-2"}),"Productos"]}),a.jsxs("button",{onClick:()=>p("walkIn"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${x==="walkIn"?"bg-blue-500/80 text-white":"bg-gray-700/50 text-gray-300 hover:bg-gray-600/50"}`,children:[a.jsx(jr,{className:"w-4 h-4 mr-2"}),"Servicios Walk-in"]})]})}),x==="product"?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-700/50",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Fn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Buscar productos...",value:P,onChange:N=>L(N.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsxs("select",{value:I,onChange:N=>H(N.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none",children:[a.jsx("option",{value:"all",children:"Todas las categorías"}),je.map(N=>a.jsx("option",{value:N,children:N},N))]})]})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:he.length===0?a.jsxs("div",{className:"col-span-full text-center py-8",children:[a.jsx(Ns,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-400",children:P||I!=="all"?"No se encontraron productos con los filtros aplicados":"No hay productos disponibles"})]}):he.map(N=>a.jsx("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-700/50 hover:border-blue-500/50 transition-colors",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-white text-sm",children:N.name}),N.description&&a.jsx("p",{className:"text-gray-400 text-xs mt-1",children:N.description}),N.category&&a.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-blue-500/20 text-blue-300 text-xs rounded-full",children:N.category})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-green-400 font-bold",children:A(N.price)}),a.jsxs("p",{className:"text-gray-500 text-xs",children:["Stock: ",N.quantity||N.stock||0]})]}),a.jsx("button",{onClick:()=>le(N),disabled:(N.quantity||N.stock||0)===0,className:"p-2 bg-blue-500/80 hover:bg-blue-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:a.jsx(Ca,{className:"w-4 h-4"})})]})]})},N._id))})]}):a.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-6 border border-gray-700/50",children:[a.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[a.jsx(jr,{className:"w-5 h-5 mr-2 text-green-400"}),"Agregar Servicio Walk-in"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Servicio"}),a.jsxs("select",{value:(w==null?void 0:w._id)||"",onChange:N=>{const _=l.find(U=>U._id===N.target.value);b(_),S((_==null?void 0:_.price)||"")},className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Selecciona un servicio"}),l.map(N=>a.jsxs("option",{value:N._id,children:[N.name," - ",A(N.price)]},N._id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Precio (puedes ajustarlo)"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"number",value:y,onChange:N=>S(N.target.value),placeholder:"0",min:"0",step:"1000",className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),a.jsxs("button",{onClick:M,disabled:!w||!y,className:"w-full py-2 bg-green-500/80 hover:bg-green-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center justify-center",children:[a.jsx(Ca,{className:"w-4 h-4 mr-2"}),"Agregar al Carrito"]})]})]})]}),a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-700/50",children:[a.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[a.jsx(Aa,{className:"w-5 h-5 mr-2 text-green-400"}),"Carrito (",f.length,")"]}),f.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Aa,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-400",children:"El carrito está vacío"})]}):a.jsxs("div",{className:"space-y-3",children:[f.map((N,_)=>a.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3 border border-gray-600/50",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-white text-sm font-medium truncate",children:N.name}),a.jsxs("p",{className:"text-gray-400 text-xs",children:[A(N.price),N.type==="product"&&` • Stock: ${N.stock}`]})]}),a.jsxs("div",{className:"flex items-center space-x-2 ml-3",children:[N.type==="product"?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>B(N.id,N.type,N.quantity-1),className:"p-1 text-gray-400 hover:text-white",children:a.jsx(Bo,{className:"w-3 h-3"})}),a.jsx("span",{className:"text-white text-sm w-8 text-center",children:N.quantity}),a.jsx("button",{onClick:()=>B(N.id,N.type,N.quantity+1),className:"p-1 text-gray-400 hover:text-white",children:a.jsx(Ca,{className:"w-3 h-3"})})]}):a.jsx("span",{className:"text-white text-sm",children:"x1"}),a.jsx("button",{onClick:()=>ie(N.id,N.type),className:"p-1 text-red-400 hover:text-red-300 ml-2",children:a.jsx(qr,{className:"w-3 h-3"})})]})]}),a.jsxs("div",{className:"flex justify-between items-center mt-2",children:[a.jsx("span",{className:"text-xs text-gray-500",children:N.type==="product"?"Producto":"Servicio Walk-in"}),a.jsx("span",{className:"text-green-400 font-semibold text-sm",children:A(N.price*N.quantity)})]})]},`${N.id}-${N.type}-${_}`)),a.jsx("div",{className:"border-t border-gray-600 pt-3 mt-3",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-lg font-semibold text-white",children:"Total:"}),a.jsx("span",{className:"text-lg font-bold text-green-400",children:A(ne)})]})}),a.jsx("button",{onClick:C,disabled:W||f.length===0||ee,className:`w-full mt-4 py-3 rounded-lg transition-all duration-300 flex items-center justify-center font-semibold ${ee?"bg-green-600 text-white":W?"bg-blue-500 text-white":f.length===0?"bg-gray-600 cursor-not-allowed text-gray-300":"bg-green-500/80 hover:bg-green-500 text-white hover:scale-105"}`,children:ee?a.jsxs(a.Fragment,{children:[a.jsx(aa,{className:"w-4 h-4 mr-2"}),"¡Venta Completada!"]}):W?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Procesando Venta..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ra,{className:"w-4 h-4 mr-2"}),"Procesar Venta"]})})]})]})})]})]})})};function Mu(){const{user:e,token:t}=er(),{showSuccess:r,showError:s}=Er(),[n,i]=O.useState([]),[o,l]=O.useState(!0),[d,c]=O.useState(null),[u,h]=O.useState(!1);O.useEffect(()=>{(async()=>{if((e==null?void 0:e.role)==="admin")try{const w=await pe.get("/users"),b=await pe.get("/barbers");if(!b.success||!Array.isArray(b.data))console.warn("Respuesta de barberos inválida:",b);else{const y=b.data.filter(S=>S.isActive&&S.user&&S.user.isActive);console.log("Barberos activos encontrados:",y.length)}if(!w.success||!Array.isArray(w.data))throw new Error("Respuesta de usuarios inválida");i(w.data||[])}catch(w){console.error("Error al cargar usuarios:",w),s("Error al cargar la lista de usuarios")}finally{l(!1)}})()},[e,t]);const m=async()=>{try{const p=await pe.get("/barbers",!1);return!p.success||!Array.isArray(p.data)?(console.warn("Respuesta de barberos inválida en refresh:",p),[]):p.data.filter(b=>b.user&&b.user.role==="barber"&&b.user.isActive&&b.isActive)}catch(p){console.error("Error al refrescar barberos:",p)}},f=async(p,w)=>{try{await pe.put(`/users/${p}/role`,{role:w}),w==="barber"&&(await pe.get(`/barbers/by-user/${p}`),await new Promise(y=>setTimeout(y,1e3)),await m());const b=await pe.get("/users");b.success&&Array.isArray(b.data)?i(b.data):console.warn("Respuesta de usuarios inválida después de cambio de rol:",b),r("Rol actualizado correctamente")}catch(b){console.error("Error al cambiar rol:",b),s(b.message||"Error al cambiar el rol del usuario")}},g=async p=>{const w=n.find(b=>b._id===p);c(w),h(!0)},x=async()=>{if(d)try{await pe.delete(`/users/${d._id}`),i(n.filter(p=>p._id!==d._id)),r("Usuario eliminado correctamente")}catch(p){console.error("Error al eliminar usuario:",p),s(p.message||"Error al eliminar el usuario")}finally{h(!1),c(null)}};return(e==null?void 0:e.role)!=="admin"?null:a.jsx(Ye,{children:a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 py-8 px-4",children:[a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"bg-blue-600/20 w-16 h-16 rounded-2xl mx-auto mb-4 flex items-center justify-center",children:a.jsx("svg",{className:"w-8 h-8 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),a.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-blue-400",children:"Gestión de roles de usuarios"}),a.jsx("p",{className:"mt-2 text-gray-400 text-sm sm:text-base",children:"Administra los roles y permisos de los usuarios de la plataforma"})]}),o?a.jsx("div",{className:"bg-gray-800/50 rounded-xl p-8 border border-gray-700",children:a.jsxs("div",{className:"flex flex-col items-center justify-center",children:[a.jsx("div",{className:"relative w-16 h-16",children:a.jsxs("div",{className:"absolute inset-0",children:[a.jsx("div",{className:"w-full h-full border-4 border-blue-500/20 rounded-full"}),a.jsx("div",{className:"w-full h-full border-4 border-transparent border-t-blue-500 rounded-full animate-spin"})]})}),a.jsx("p",{className:"mt-4 text-lg text-blue-400",children:"Cargando usuarios..."})]})}):a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"inline-block min-w-full align-middle",children:a.jsx("div",{className:"bg-gray-800/50 backdrop-blur-sm overflow-hidden border border-gray-700 rounded-xl shadow-xl",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3.5 text-left text-sm font-semibold text-blue-400",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Usuario"]})}),a.jsx("th",{className:"px-4 py-3.5 text-left text-sm font-semibold text-blue-400 hidden sm:table-cell",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})}),"Email"]})}),a.jsx("th",{className:"px-4 py-3.5 text-left text-sm font-semibold text-blue-400",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),"Rol"]})}),a.jsx("th",{className:"px-4 py-3.5 text-right text-sm font-semibold text-blue-400",children:"Acciones"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-700",children:n.map(p=>a.jsxs("tr",{className:"hover:bg-gray-700/30 transition-colors",children:[a.jsx("td",{className:"px-4 py-4 text-sm sm:text-base whitespace-nowrap text-white",children:p.name||p.email}),a.jsx("td",{className:"px-4 py-4 text-sm sm:text-base whitespace-nowrap text-gray-300 hidden sm:table-cell",children:p.email}),a.jsx("td",{className:"px-4 py-4 text-sm sm:text-base whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                            ${p.role==="admin"?"bg-purple-900/50 text-purple-200 border border-purple-700":p.role==="barber"?"bg-blue-900/50 text-blue-200 border border-blue-700":"bg-green-900/50 text-green-200 border border-green-700"}`,children:p.role})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right text-sm",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsxs("select",{value:p.role,onChange:w=>f(p._id,w.target.value),className:"block w-32 px-3 py-1.5 text-sm text-white bg-gray-700/50 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"user",children:"Usuario"}),a.jsx("option",{value:"barber",children:"Barbero"}),a.jsx("option",{value:"admin",children:"Admin"})]}),p._id!==(e._id||e.id)&&p.role!=="admin"&&a.jsx("button",{onClick:()=>g(p._id),className:"inline-flex items-center p-1.5 border border-red-600/30 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600/30 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500/50",title:"Eliminar usuario",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},p._id))})]})})})}),u&&a.jsxs("div",{className:"fixed inset-0 z-50",children:[a.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>{h(!1),c(null)}}),a.jsx("div",{className:"absolute inset-0 overflow-y-auto",children:a.jsx("div",{className:"flex min-h-full items-end sm:items-center justify-center p-4",children:a.jsxs("div",{className:"relative bg-gray-800 border border-gray-700 rounded-xl shadow-xl w-full max-w-md transform transition-all animate-modal",children:[a.jsx("div",{className:"border-b border-gray-700 px-6 py-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"mr-3 flex-shrink-0",children:a.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-red-900/50 border border-red-700",children:a.jsx("svg",{className:"h-6 w-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-red-400",children:"Confirmar eliminación"}),a.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Esta acción no se puede deshacer"})]})]})}),a.jsx("div",{className:"px-6 py-4",children:a.jsxs("p",{className:"text-gray-300",children:["¿Estás seguro que deseas eliminar al usuario"," ",a.jsx("span",{className:"font-semibold text-blue-400",children:(d==null?void 0:d.name)||(d==null?void 0:d.email)}),"?"]})}),a.jsx("div",{className:"border-t border-gray-700 px-6 py-4",children:a.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-3",children:[a.jsx("button",{onClick:()=>{h(!1),c(null)},className:"w-full sm:w-auto px-4 py-2 rounded-lg bg-gray-700 text-gray-300 hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500/50 text-sm",children:"Cancelar"}),a.jsxs("button",{onClick:x,className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500/50 text-sm",children:[a.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Eliminar usuario"]})]})})]})})})]})]}),a.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; transform: translateY(-10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
          animation: fade-in 0.5s ease;
        }

        @keyframes modal {
          from { opacity: 0; transform: scale(0.95); }
          to { opacity: 1; transform: scale(1); }
        }
        .animate-modal {
          animation: modal 0.2s ease-out;
        }
      `})]})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Es={};Es.version="0.18.5";var el=1252,Iu=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],rl=function(e){Iu.indexOf(e)!=-1&&(el=e)};function Ru(){rl(1252)}var Wa=function(e){rl(e)};function Lu(){Wa(1200),Ru()}var cs=function(t){return String.fromCharCode(t)},Vi=function(t){return String.fromCharCode(t)},Ss,Et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ua(e){for(var t="",r=0,s=0,n=0,i=0,o=0,l=0,d=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,s=e.charCodeAt(c++),o=(r&3)<<4|s>>4,n=e.charCodeAt(c++),l=(s&15)<<2|n>>6,d=n&63,isNaN(s)?l=d=64:isNaN(n)&&(d=64),t+=Et.charAt(i)+Et.charAt(o)+Et.charAt(l)+Et.charAt(d);return t}function xt(e){var t="",r=0,s=0,n=0,i=0,o=0,l=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=Et.indexOf(e.charAt(c++)),o=Et.indexOf(e.charAt(c++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=Et.indexOf(e.charAt(c++)),s=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(s)),d=Et.indexOf(e.charAt(c++)),n=(l&3)<<6|d,d!==64&&(t+=String.fromCharCode(n));return t}var Me=(function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node})(),pt=(function(){if(typeof Buffer!="undefined"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Ut(e){return Me?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}function Gi(e){return Me?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}var Gr=function(t){return Me?pt(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function zs(e){if(typeof ArrayBuffer=="undefined")return Gr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function Ka(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Bu(e){if(typeof Uint8Array=="undefined")throw new Error("Unsupported");return new Uint8Array(e)}var ur=Me?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:pt(t)}))}:function(e){if(typeof Uint8Array!="undefined"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Wu(e){for(var t=[],r=0,s=e.length+250,n=Ut(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|l>>6&15|(o&3)<<4,n[r++]=128|l&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>s&&(t.push(n.slice(0,r)),r=0,n=Ut(65535),s=65530)}return t.push(n.slice(0,r)),ur(t)}var Da=/\u0000/g,ds=/[\u0001-\u0006]/g;function oa(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Yr(e,t){var r=""+e;return r.length>=t?r:Je("0",t-r.length)+r}function zn(e,t){var r=""+e;return r.length>=t?r:Je(" ",t-r.length)+r}function ks(e,t){var r=""+e;return r.length>=t?r:r+Je(" ",t-r.length)}function Uu(e,t){var r=""+Math.round(e);return r.length>=t?r:Je("0",t-r.length)+r}function $u(e,t){var r=""+e;return r.length>=t?r:Je("0",t-r.length)+r}var Yi=Math.pow(2,32);function Jt(e,t){if(e>Yi||e<-Yi)return Uu(e,t);var r=Math.round(e);return $u(r,t)}function Ts(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Xi=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ln=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zu(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Qe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},qi={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Hu={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Cs(e,t,r){for(var s=e<0?-1:1,n=e*s,i=0,o=1,l=0,d=1,c=0,u=0,h=Math.floor(n);c<t&&(h=Math.floor(n),l=h*o+i,u=h*c+d,!(n-h<5e-8));)n=1/(n-h),i=o,o=l,d=c,c=u;if(u>t&&(c>t?(u=d,l=i):(u=c,l=o)),!r)return[0,s*l,u];var m=Math.floor(s*l/u);return[m,s*l-m*u,u]}function us(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),i=0,o=[],l={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++s,++l.D)),s===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(s===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var d=new Date(1900,0,1);d.setDate(d.getDate()+s-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],i=d.getDay(),s<60&&(i=(i+6)%7),r&&(i=Ju(d,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=i,l}var tl=new Date(1899,11,31,0,0,0),Vu=tl.getTime(),Gu=new Date(1900,2,1,0,0,0);function al(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Gu&&(r+=1440*60*1e3),(r-(Vu+(e.getTimezoneOffset()-tl.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Hn(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Yu(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Xu(e){var t=e<0?12:11,r=Hn(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function qu(e){var t=Hn(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ku(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Xu(e):t===10?r=e.toFixed(10).substr(0,12):r=qu(e),Hn(Yu(r.toUpperCase()))}function _n(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ku(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return kt(14,al(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Ju(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Qu(e,t,r,s){var n="",i=0,o=0,l=r.y,d,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:d=l%100,c=2;break;default:d=l%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,c=t.length;break;case 3:return ln[r.m-1][1];case 5:return ln[r.m-1][0];default:return ln[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,c=t.length;break;case 3:return Xi[r.q][0];default:return Xi[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Yr(r.S,t.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(n=Yr(i,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:d=l,c=1;break}var u=c>0?Yr(d,c):"";return u}function St(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var sl=/%/g;function Zu(e,t,r){var s=t.replace(sl,""),n=t.length-s.length;return dt(e,s,r*Math.pow(10,2*n))+Je("%",n)}function ef(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return dt(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function nl(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+nl(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,u){return d+c+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var il=/# (\?+)( ?)\/( ?)(\d+)/;function rf(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),i=Math.floor(n/s),o=n-i*s,l=s;return r+(i===0?"":""+i)+" "+(o===0?Je(" ",e[1].length+1+e[4].length):zn(o,e[1].length)+e[2]+"/"+e[3]+Yr(l,e[4].length))}function tf(e,t,r){return r+(t===0?"":""+t)+Je(" ",e[1].length+2+e[4].length)}var ol=/^#*0*\.([0#]+)/,ll=/\).*[0#]/,cl=/\(###\) ###\\?-####/;function br(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ki(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ji(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function af(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function sf(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ur(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ll)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ur("n",s,r):"("+Ur("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ef(e,t,r);if(t.indexOf("%")!==-1)return Zu(e,t,r);if(t.indexOf("E")!==-1)return nl(t,r);if(t.charCodeAt(0)===36)return"$"+Ur(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Jt(d,t.length);if(t.match(/^[#?]+$/))return n=Jt(r,0),n==="0"&&(n=""),n.length>t.length?n:br(t.substr(0,t.length-n.length))+n;if(i=t.match(il))return rf(i,d,c);if(t.match(/^#+0+$/))return c+Jt(d,t.length-t.indexOf("0"));if(i=t.match(ol))return n=Ki(r,i[1].length).replace(/^([^\.]+)$/,"$1."+br(i[1])).replace(/\.$/,"."+br(i[1])).replace(/\.(\d*)$/,function(g,x){return"."+x+Je("0",br(i[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+Ki(d,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+St(Jt(d,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ur(e,t,-r):St(""+(Math.floor(r)+af(r,i[1].length)))+"."+Yr(Ji(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ur(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=oa(Ur(e,t.replace(/[\\-]/g,""),r)),o=0,oa(oa(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<n.length?n.charAt(o++):g==="0"?"0":""}));if(t.match(cl))return n=Ur(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Cs(d,Math.pow(10,o)-1,!1),n=""+c,u=dt("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=ks(l[2],o),u.length<i[4].length&&(u=br(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Cs(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?zn(l[1],o)+i[2]+"/"+i[3]+ks(l[2],o):Je(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=Jt(r,0),t.length<=n.length?n:br(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var h=t.indexOf(".")-o,m=t.length-n.length-h;return br(t.substr(0,h)+n+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=Ji(r,i[1].length),r<0?"-"+Ur(e,t,-r):St(sf(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Yr(0,3-g.length):"")+g})+"."+Yr(o,i[1].length);switch(t){case"###,##0.00":return Ur(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=St(Jt(d,0));return f!=="0"?c+f:"";case"###,###.00":return Ur(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ur(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function nf(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return dt(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function of(e,t,r){var s=t.replace(sl,""),n=t.length-s.length;return dt(e,s,r*Math.pow(10,2*n))+Je("%",n)}function dl(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+dl(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,u){return d+c+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Zr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ll)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zr("n",s,r):"("+Zr("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return nf(e,t,r);if(t.indexOf("%")!==-1)return of(e,t,r);if(t.indexOf("E")!==-1)return dl(t,r);if(t.charCodeAt(0)===36)return"$"+Zr(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Yr(d,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:br(t.substr(0,t.length-n.length))+n;if(i=t.match(il))return tf(i,d,c);if(t.match(/^#+0+$/))return c+Yr(d,t.length-t.indexOf("0"));if(i=t.match(ol))return n=(""+r).replace(/^([^\.]+)$/,"$1."+br(i[1])).replace(/\.$/,"."+br(i[1])),n=n.replace(/\.(\d*)$/,function(g,x){return"."+x+Je("0",br(i[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+St(""+d);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zr(e,t,-r):St(""+r)+"."+Je("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Zr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=oa(Zr(e,t.replace(/[\\-]/g,""),r)),o=0,oa(oa(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<n.length?n.charAt(o++):g==="0"?"0":""}));if(t.match(cl))return n=Zr(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Cs(d,Math.pow(10,o)-1,!1),n=""+c,u=dt("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=ks(l[2],o),u.length<i[4].length&&(u=br(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Cs(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?zn(l[1],o)+i[2]+"/"+i[3]+ks(l[2],o):Je(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:br(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var h=t.indexOf(".")-o,m=t.length-n.length-h;return br(t.substr(0,h)+n+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Zr(e,t,-r):St(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Yr(0,3-g.length):"")+g})+"."+Yr(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=St(""+d);return f!=="0"?c+f:"";default:if(t.match(/\.[0#?]*$/))return Zr(e,t.slice(0,t.lastIndexOf(".")),r)+br(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function dt(e,t,r){return(r|0)===r?Zr(e,t,r):Ur(e,t,r)}function lf(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ul=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fl(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":Ts(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(ul))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function cf(e,t,r,s){for(var n=[],i="",o=0,l="",d="t",c,u,h,m="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Ts(e,o))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(h=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(h);n[n.length]={t:"t",v:i},++o;break;case"\\":var f=e.charAt(++o),g=f==="("||f===")"?f:"t";n[n.length]={t:g,v:f},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=us(t,r,e.charAt(o+1)==="2"),c==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},d=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=us(t,r),c==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&d.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),n[n.length]={t:l,v:i},d=l;break;case"A":case"a":case"上":var x={t:l,v:l};if(c==null&&(c=us(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(c!=null&&(x.v=c.H>=12?"下午":"上午"),x.t="T",o+=5,m="h"):(x.t="t",++o),c==null&&x.t==="T")return"";n[n.length]=x,d=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(ul)){if(c==null&&(c=us(t,r),c==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},d=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",fl(e)||(n[n.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;n[n.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;n[n.length]={t:l,v:i},d=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:s===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:l,v:l},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++o;break}var p=0,w=0,b;for(o=n.length-1,d="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=m,d="h",p<1&&(p=1);break;case"s":(b=n[o].v.match(/\.0+$/))&&(w=Math.max(w,b[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":d=n[o].t;break;case"m":d==="s"&&(n[o].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&n[o].v.match(/[Hh]/)&&(p=1),p<2&&n[o].v.match(/[Mm]/)&&(p=2),p<3&&n[o].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",S;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=Qu(n[o].t.charCodeAt(0),n[o].v,c,w),n[o].t="t";break;case"n":case"?":for(S=o+1;n[S]!=null&&((l=n[S].t)==="?"||l==="D"||(l===" "||l==="t")&&n[S+1]!=null&&(n[S+1].t==="?"||n[S+1].t==="t"&&n[S+1].v==="/")||n[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[S].v==="/"||n[S].v===" "&&n[S+1]!=null&&n[S+1].t=="?"));)n[o].v+=n[S].v,n[S]={v:"",t:";"},++S;y+=n[o].v,o=S-1;break;case"G":n[o].t="t",n[o].v=_n(t,r);break}var P="",L,I;if(y.length>0){y.charCodeAt(0)==40?(L=t<0&&y.charCodeAt(0)===45?-t:t,I=dt("n",y,L)):(L=t<0&&s>1?-t:t,I=dt("n",y,L),L<0&&n[0]&&n[0].t=="t"&&(I=I.substr(1),n[0].v="-"+n[0].v)),S=I.length-1;var H=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){H=o;break}var W=n.length;if(H===n.length&&I.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(S>=n[o].v.length-1?(S-=n[o].v.length,n[o].v=I.substr(S+1,n[o].v.length)):S<0?n[o].v="":(n[o].v=I.substr(0,S+1),S=-1),n[o].t="t",W=o);S>=0&&W<n.length&&(n[W].v=I.substr(0,S+1)+n[W].v)}else if(H!==n.length&&I.indexOf("E")===-1){for(S=I.indexOf(".")-1,o=H;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(u=n[o].v.indexOf(".")>-1&&o===H?n[o].v.indexOf(".")-1:n[o].v.length-1,P=n[o].v.substr(u+1);u>=0;--u)S>=0&&(n[o].v.charAt(u)==="0"||n[o].v.charAt(u)==="#")&&(P=I.charAt(S--)+P);n[o].v=P,n[o].t="t",W=o}for(S>=0&&W<n.length&&(n[W].v=I.substr(0,S+1)+n[W].v),S=I.indexOf(".")+1,o=H;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==H)){for(u=n[o].v.indexOf(".")>-1&&o===H?n[o].v.indexOf(".")+1:0,P=n[o].v.substr(0,u);u<n[o].v.length;++u)S<I.length&&(P+=I.charAt(S++));n[o].v=P,n[o].t="t",W=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(L=s>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=dt(n[o].t,n[o].v,L),n[o].t="t");var J="";for(o=0;o!==n.length;++o)n[o]!=null&&(J+=n[o].v);return J}var Qi=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Zi(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function df(e,t){var r=lf(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Qi),l=r[1].match(Qi);return Zi(t,o)?[s,r[0]]:Zi(t,l)?[s,r[1]]:[s,r[o!=null&&l!=null?2:1]]}return[s,i]}function kt(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:Qe)[e],s==null&&(s=r.table&&r.table[qi[e]]||Qe[qi[e]]),s==null&&(s=Hu[e]||"General");break}if(Ts(s,0))return _n(t,r);t instanceof Date&&(t=al(t,r.date1904));var n=df(s,t);if(Ts(n[1]))return _n(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return cf(n[1],t,r,n[0])}function hl(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Qe[r]==null){t<0&&(t=r);continue}if(Qe[r]==e){t=r;break}}t<0&&(t=391)}return Qe[t]=e,t}function Hs(e){for(var t=0;t!=392;++t)e[t]!==void 0&&hl(e[t],t)}function Vs(){Qe=zu()}var xl=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function uf(e){var t=typeof e=="number"?Qe[e]:e;return t=t.replace(xl,"(\\d+)"),new RegExp("^"+t+"$")}function ff(e,t,r){var s=-1,n=-1,i=-1,o=-1,l=-1,d=-1;(t.match(xl)||[]).forEach(function(h,m){var f=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":s=f;break;case"d":i=f;break;case"h":o=f;break;case"s":d=f;break;case"m":o>=0?l=f:n=f;break}}),d>=0&&l==-1&&n>=0&&(l=n,n=-1);var c=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&l==-1&&d==-1?c:s==-1&&n==-1&&i==-1?u:c+"T"+u}var hf=(function(){var e={};e.version="1.2.0";function t(){for(var I=0,H=new Array(256),W=0;W!=256;++W)I=W,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,H[W]=I;return typeof Int32Array!="undefined"?new Int32Array(H):H}var r=t();function s(I){var H=0,W=0,J=0,ee=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(J=0;J!=256;++J)ee[J]=I[J];for(J=0;J!=256;++J)for(W=I[J],H=256+J;H<4096;H+=256)W=ee[H]=W>>>8^I[W&255];var R=[];for(J=1;J!=16;++J)R[J-1]=typeof Int32Array!="undefined"?ee.subarray(J*256,J*256+256):ee.slice(J*256,J*256+256);return R}var n=s(r),i=n[0],o=n[1],l=n[2],d=n[3],c=n[4],u=n[5],h=n[6],m=n[7],f=n[8],g=n[9],x=n[10],p=n[11],w=n[12],b=n[13],y=n[14];function S(I,H){for(var W=H^-1,J=0,ee=I.length;J<ee;)W=W>>>8^r[(W^I.charCodeAt(J++))&255];return~W}function P(I,H){for(var W=H^-1,J=I.length-15,ee=0;ee<J;)W=y[I[ee++]^W&255]^b[I[ee++]^W>>8&255]^w[I[ee++]^W>>16&255]^p[I[ee++]^W>>>24]^x[I[ee++]]^g[I[ee++]]^f[I[ee++]]^m[I[ee++]]^h[I[ee++]]^u[I[ee++]]^c[I[ee++]]^d[I[ee++]]^l[I[ee++]]^o[I[ee++]]^i[I[ee++]]^r[I[ee++]];for(J+=15;ee<J;)W=W>>>8^r[(W^I[ee++])&255];return~W}function L(I,H){for(var W=H^-1,J=0,ee=I.length,R=0,q=0;J<ee;)R=I.charCodeAt(J++),R<128?W=W>>>8^r[(W^R)&255]:R<2048?(W=W>>>8^r[(W^(192|R>>6&31))&255],W=W>>>8^r[(W^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,q=I.charCodeAt(J++)&1023,W=W>>>8^r[(W^(240|R>>8&7))&255],W=W>>>8^r[(W^(128|R>>2&63))&255],W=W>>>8^r[(W^(128|q>>6&15|(R&3)<<4))&255],W=W>>>8^r[(W^(128|q&63))&255]):(W=W>>>8^r[(W^(224|R>>12&15))&255],W=W>>>8^r[(W^(128|R>>6&63))&255],W=W>>>8^r[(W^(128|R&63))&255]);return~W}return e.table=r,e.bstr=S,e.buf=P,e.str=L,e})(),$e=(function(){var t={};t.version="1.2.1";function r(v,k){for(var j=v.split("/"),E=k.split("/"),T=0,F=0,G=Math.min(j.length,E.length);T<G;++T){if(F=j[T].length-E[T].length)return F;if(j[T]!=E[T])return j[T]<E[T]?-1:1}return j.length-E.length}function s(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:s(v.slice(0,-1));var k=v.lastIndexOf("/");return k===-1?v:v.slice(0,k+1)}function n(v){if(v.charAt(v.length-1)=="/")return n(v.slice(0,-1));var k=v.lastIndexOf("/");return k===-1?v:v.slice(k+1)}function i(v,k){typeof k=="string"&&(k=new Date(k));var j=k.getHours();j=j<<6|k.getMinutes(),j=j<<5|k.getSeconds()>>>1,v.write_shift(2,j);var E=k.getFullYear()-1980;E=E<<4|k.getMonth()+1,E=E<<5|k.getDate(),v.write_shift(2,E)}function o(v){var k=v.read_shift(2)&65535,j=v.read_shift(2)&65535,E=new Date,T=j&31;j>>>=5;var F=j&15;j>>>=4,E.setMilliseconds(0),E.setFullYear(j+1980),E.setMonth(F-1),E.setDate(T);var G=k&31;k>>>=5;var se=k&63;return k>>>=6,E.setHours(k),E.setMinutes(se),E.setSeconds(G<<1),E}function l(v){Mr(v,0);for(var k={},j=0;v.l<=v.length-4;){var E=v.read_shift(2),T=v.read_shift(2),F=v.l+T,G={};switch(E){case 21589:j=v.read_shift(1),j&1&&(G.mtime=v.read_shift(4)),T>5&&(j&2&&(G.atime=v.read_shift(4)),j&4&&(G.ctime=v.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}v.l=F,k[E]=G}return k}var d;function c(){return d||(d={})}function u(v,k){if(v[0]==80&&v[1]==75)return Ei(v,k);if((v[0]|32)==109&&(v[1]|32)==105)return ec(v,k);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var j=3,E=512,T=0,F=0,G=0,se=0,V=0,Y=[],X=v.slice(0,512);Mr(X,0);var ue=h(X);switch(j=ue[0],j){case 3:E=512;break;case 4:E=4096;break;case 0:if(ue[1]==0)return Ei(v,k);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}E!==512&&(X=v.slice(0,E),Mr(X,28));var ve=v.slice(0,E);m(X,j);var ye=X.read_shift(4,"i");if(j===3&&ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ye);X.l+=4,G=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),se=X.read_shift(4,"i"),T=X.read_shift(4,"i"),V=X.read_shift(4,"i"),F=X.read_shift(4,"i");for(var fe=-1,we=0;we<109&&(fe=X.read_shift(4,"i"),!(fe<0));++we)Y[we]=fe;var ke=f(v,E);p(V,F,ke,E,Y);var Xe=b(ke,G,Y,E);Xe[G].name="!Directory",T>0&&se!==q&&(Xe[se].name="!MiniFAT"),Xe[Y[0]].name="!FAT",Xe.fat_addrs=Y,Xe.ssz=E;var qe={},mr=[],va=[],ba=[];y(G,Xe,ke,mr,T,qe,va,se),g(va,ba,mr),mr.shift();var wa={FileIndex:va,FullPaths:ba};return k&&k.raw&&(wa.raw={header:ve,sectors:ke}),wa}function h(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(be,"Header Signature: "),v.l+=16;var k=v.read_shift(2,"u");return[v.read_shift(2,"u"),k]}function m(v,k){var j=9;switch(v.l+=2,j=v.read_shift(2)){case 9:if(k!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(k!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function f(v,k){for(var j=Math.ceil(v.length/k)-1,E=[],T=1;T<j;++T)E[T-1]=v.slice(T*k,(T+1)*k);return E[j-1]=v.slice(j*k),E}function g(v,k,j){for(var E=0,T=0,F=0,G=0,se=0,V=j.length,Y=[],X=[];E<V;++E)Y[E]=X[E]=E,k[E]=j[E];for(;se<X.length;++se)E=X[se],T=v[E].L,F=v[E].R,G=v[E].C,Y[E]===E&&(T!==-1&&Y[T]!==T&&(Y[E]=Y[T]),F!==-1&&Y[F]!==F&&(Y[E]=Y[F])),G!==-1&&(Y[G]=E),T!==-1&&E!=Y[E]&&(Y[T]=Y[E],X.lastIndexOf(T)<se&&X.push(T)),F!==-1&&E!=Y[E]&&(Y[F]=Y[E],X.lastIndexOf(F)<se&&X.push(F));for(E=1;E<V;++E)Y[E]===E&&(F!==-1&&Y[F]!==F?Y[E]=Y[F]:T!==-1&&Y[T]!==T&&(Y[E]=Y[T]));for(E=1;E<V;++E)if(v[E].type!==0){if(se=E,se!=Y[se])do se=Y[se],k[E]=k[se]+"/"+k[E];while(se!==0&&Y[se]!==-1&&se!=Y[se]);Y[E]=-1}for(k[0]+="/",E=1;E<V;++E)v[E].type!==2&&(k[E]+="/")}function x(v,k,j){for(var E=v.start,T=v.size,F=[],G=E;j&&T>0&&G>=0;)F.push(k.slice(G*R,G*R+R)),T-=R,G=Mt(j,G*4);return F.length===0?te(0):ur(F).slice(0,v.size)}function p(v,k,j,E,T){var F=q;if(v===q){if(k!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var G=j[v],se=(E>>>2)-1;if(!G)return;for(var V=0;V<se&&(F=Mt(G,V*4))!==q;++V)T.push(F);p(Mt(G,E-4),k-1,j,E,T)}}function w(v,k,j,E,T){var F=[],G=[];T||(T=[]);var se=E-1,V=0,Y=0;for(V=k;V>=0;){T[V]=!0,F[F.length]=V,G.push(v[V]);var X=j[Math.floor(V*4/E)];if(Y=V*4&se,E<4+Y)throw new Error("FAT boundary crossed: "+V+" 4 "+E);if(!v[X])break;V=Mt(v[X],Y)}return{nodes:F,data:oo([G])}}function b(v,k,j,E){var T=v.length,F=[],G=[],se=[],V=[],Y=E-1,X=0,ue=0,ve=0,ye=0;for(X=0;X<T;++X)if(se=[],ve=X+k,ve>=T&&(ve-=T),!G[ve]){V=[];var fe=[];for(ue=ve;ue>=0;){fe[ue]=!0,G[ue]=!0,se[se.length]=ue,V.push(v[ue]);var we=j[Math.floor(ue*4/E)];if(ye=ue*4&Y,E<4+ye)throw new Error("FAT boundary crossed: "+ue+" 4 "+E);if(!v[we]||(ue=Mt(v[we],ye),fe[ue]))break}F[ve]={nodes:se,data:oo([V])}}return F}function y(v,k,j,E,T,F,G,se){for(var V=0,Y=E.length?2:0,X=k[v].data,ue=0,ve=0,ye;ue<X.length;ue+=128){var fe=X.slice(ue,ue+128);Mr(fe,64),ve=fe.read_shift(2),ye=qn(fe,0,ve-Y),E.push(ye);var we={name:ye,type:fe.read_shift(1),color:fe.read_shift(1),L:fe.read_shift(4,"i"),R:fe.read_shift(4,"i"),C:fe.read_shift(4,"i"),clsid:fe.read_shift(16),state:fe.read_shift(4,"i"),start:0,size:0},ke=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);ke!==0&&(we.ct=S(fe,fe.l-8));var Xe=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);Xe!==0&&(we.mt=S(fe,fe.l-8)),we.start=fe.read_shift(4,"i"),we.size=fe.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=q,we.name=""),we.type===5?(V=we.start,T>0&&V!==q&&(k[V].name="!StreamData")):we.size>=4096?(we.storage="fat",k[we.start]===void 0&&(k[we.start]=w(j,we.start,k.fat_addrs,k.ssz)),k[we.start].name=we.name,we.content=k[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:V!==q&&we.start!==q&&k[V]&&(we.content=x(we,k[V].data,(k[se]||{}).data))),we.content&&Mr(we.content,0),F[ye]=we,G.push(we)}}function S(v,k){return new Date((Rr(v,k+4)/1e7*Math.pow(2,32)+Rr(v,k)/1e7-11644473600)*1e3)}function P(v,k){return c(),u(d.readFileSync(v),k)}function L(v,k){var j=k&&k.type;switch(j||Me&&Buffer.isBuffer(v)&&(j="buffer"),j||"base64"){case"file":return P(v,k);case"base64":return u(Gr(xt(v)),k);case"binary":return u(Gr(v),k)}return u(v,k)}function I(v,k){var j=k||{},E=j.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=E+"/",v.FileIndex[0]={name:E,type:5}),j.CLSID&&(v.FileIndex[0].clsid=j.CLSID),H(v)}function H(v){var k="Sh33tJ5";if(!$e.find(v,"/"+k)){var j=te(4);j[0]=55,j[1]=j[3]=50,j[2]=54,v.FileIndex.push({name:k,type:2,content:j,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+k),W(v)}}function W(v,k){I(v);for(var j=!1,E=!1,T=v.FullPaths.length-1;T>=0;--T){var F=v.FileIndex[T];switch(F.type){case 0:E?j=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(F.R*F.L*F.C)&&(j=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!k)){var G=new Date(1987,1,19),se=0,V=Object.create?Object.create(null):{},Y=[];for(T=0;T<v.FullPaths.length;++T)V[v.FullPaths[T]]=!0,v.FileIndex[T].type!==0&&Y.push([v.FullPaths[T],v.FileIndex[T]]);for(T=0;T<Y.length;++T){var X=s(Y[T][0]);E=V[X],E||(Y.push([X,{name:n(X).replace("/",""),type:1,clsid:je,ct:G,mt:G,content:null}]),V[X]=!0)}for(Y.sort(function(ye,fe){return r(ye[0],fe[0])}),v.FullPaths=[],v.FileIndex=[],T=0;T<Y.length;++T)v.FullPaths[T]=Y[T][0],v.FileIndex[T]=Y[T][1];for(T=0;T<Y.length;++T){var ue=v.FileIndex[T],ve=v.FullPaths[T];if(ue.name=n(ve).replace("/",""),ue.L=ue.R=ue.C=-(ue.color=1),ue.size=ue.content?ue.content.length:0,ue.start=0,ue.clsid=ue.clsid||je,T===0)ue.C=Y.length>1?1:-1,ue.size=0,ue.type=5;else if(ve.slice(-1)=="/"){for(se=T+1;se<Y.length&&s(v.FullPaths[se])!=ve;++se);for(ue.C=se>=Y.length?-1:se,se=T+1;se<Y.length&&s(v.FullPaths[se])!=s(ve);++se);ue.R=se>=Y.length?-1:se,ue.type=1}else s(v.FullPaths[T+1]||"")==s(ve)&&(ue.R=T+1),ue.type=2}}}function J(v,k){var j=k||{};if(j.fileType=="mad")return rc(v,j);switch(W(v),j.fileType){case"zip":return X0(v,j)}var E=(function(ye){for(var fe=0,we=0,ke=0;ke<ye.FileIndex.length;++ke){var Xe=ye.FileIndex[ke];if(Xe.content){var qe=Xe.content.length;qe>0&&(qe<4096?fe+=qe+63>>6:we+=qe+511>>9)}}for(var mr=ye.FullPaths.length+3>>2,va=fe+7>>3,ba=fe+127>>7,wa=va+we+mr+ba,Pt=wa+127>>7,rn=Pt<=109?0:Math.ceil((Pt-109)/127);wa+Pt+rn+127>>7>Pt;)rn=++Pt<=109?0:Math.ceil((Pt-109)/127);var it=[1,rn,Pt,ba,mr,we,fe,0];return ye.FileIndex[0].size=fe<<6,it[7]=(ye.FileIndex[0].start=it[0]+it[1]+it[2]+it[3]+it[4]+it[5])+(it[6]+7>>3),it})(v),T=te(E[7]<<9),F=0,G=0;{for(F=0;F<8;++F)T.write_shift(1,he[F]);for(F=0;F<8;++F)T.write_shift(2,0);for(T.write_shift(2,62),T.write_shift(2,3),T.write_shift(2,65534),T.write_shift(2,9),T.write_shift(2,6),F=0;F<3;++F)T.write_shift(2,0);for(T.write_shift(4,0),T.write_shift(4,E[2]),T.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),T.write_shift(4,0),T.write_shift(4,4096),T.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:q),T.write_shift(4,E[3]),T.write_shift(-4,E[1]?E[0]-1:q),T.write_shift(4,E[1]),F=0;F<109;++F)T.write_shift(-4,F<E[2]?E[1]+F:-1)}if(E[1])for(G=0;G<E[1];++G){for(;F<236+G*127;++F)T.write_shift(-4,F<E[2]?E[1]+F:-1);T.write_shift(-4,G===E[1]-1?q:G+1)}var se=function(ye){for(G+=ye;F<G-1;++F)T.write_shift(-4,F+1);ye&&(++F,T.write_shift(-4,q))};for(G=F=0,G+=E[1];F<G;++F)T.write_shift(-4,le.DIFSECT);for(G+=E[2];F<G;++F)T.write_shift(-4,le.FATSECT);se(E[3]),se(E[4]);for(var V=0,Y=0,X=v.FileIndex[0];V<v.FileIndex.length;++V)X=v.FileIndex[V],X.content&&(Y=X.content.length,!(Y<4096)&&(X.start=G,se(Y+511>>9)));for(se(E[6]+7>>3);T.l&511;)T.write_shift(-4,le.ENDOFCHAIN);for(G=F=0,V=0;V<v.FileIndex.length;++V)X=v.FileIndex[V],X.content&&(Y=X.content.length,!(!Y||Y>=4096)&&(X.start=G,se(Y+63>>6)));for(;T.l&511;)T.write_shift(-4,le.ENDOFCHAIN);for(F=0;F<E[4]<<2;++F){var ue=v.FullPaths[F];if(!ue||ue.length===0){for(V=0;V<17;++V)T.write_shift(4,0);for(V=0;V<3;++V)T.write_shift(4,-1);for(V=0;V<12;++V)T.write_shift(4,0);continue}X=v.FileIndex[F],F===0&&(X.start=X.size?X.start-1:q);var ve=F===0&&j.root||X.name;if(Y=2*(ve.length+1),T.write_shift(64,ve,"utf16le"),T.write_shift(2,Y),T.write_shift(1,X.type),T.write_shift(1,X.color),T.write_shift(-4,X.L),T.write_shift(-4,X.R),T.write_shift(-4,X.C),X.clsid)T.write_shift(16,X.clsid,"hex");else for(V=0;V<4;++V)T.write_shift(4,0);T.write_shift(4,X.state||0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,X.start),T.write_shift(4,X.size),T.write_shift(4,0)}for(F=1;F<v.FileIndex.length;++F)if(X=v.FileIndex[F],X.size>=4096)if(T.l=X.start+1<<9,Me&&Buffer.isBuffer(X.content))X.content.copy(T,T.l,0,X.size),T.l+=X.size+511&-512;else{for(V=0;V<X.size;++V)T.write_shift(1,X.content[V]);for(;V&511;++V)T.write_shift(1,0)}for(F=1;F<v.FileIndex.length;++F)if(X=v.FileIndex[F],X.size>0&&X.size<4096)if(Me&&Buffer.isBuffer(X.content))X.content.copy(T,T.l,0,X.size),T.l+=X.size+63&-64;else{for(V=0;V<X.size;++V)T.write_shift(1,X.content[V]);for(;V&63;++V)T.write_shift(1,0)}if(Me)T.l=T.length;else for(;T.l<T.length;)T.write_shift(1,0);return T}function ee(v,k){var j=v.FullPaths.map(function(V){return V.toUpperCase()}),E=j.map(function(V){var Y=V.split("/");return Y[Y.length-(V.slice(-1)=="/"?2:1)]}),T=!1;k.charCodeAt(0)===47?(T=!0,k=j[0].slice(0,-1)+k):T=k.indexOf("/")!==-1;var F=k.toUpperCase(),G=T===!0?j.indexOf(F):E.indexOf(F);if(G!==-1)return v.FileIndex[G];var se=!F.match(ds);for(F=F.replace(Da,""),se&&(F=F.replace(ds,"!")),G=0;G<j.length;++G)if((se?j[G].replace(ds,"!"):j[G]).replace(Da,"")==F||(se?E[G].replace(ds,"!"):E[G]).replace(Da,"")==F)return v.FileIndex[G];return null}var R=64,q=-2,be="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],je="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:je,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function M(v,k,j){c();var E=J(v,j);d.writeFileSync(k,E)}function ie(v){for(var k=new Array(v.length),j=0;j<v.length;++j)k[j]=String.fromCharCode(v[j]);return k.join("")}function B(v,k){var j=J(v,k);switch(k&&k.type||"buffer"){case"file":return c(),d.writeFileSync(k.filename,j),j;case"binary":return typeof j=="string"?j:ie(j);case"base64":return Ua(typeof j=="string"?j:ie(j));case"buffer":if(Me)return Buffer.isBuffer(j)?j:pt(j);case"array":return typeof j=="string"?Gr(j):j}return j}var ne;function C(v){try{var k=v.InflateRaw,j=new k;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)ne=v;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function A(v,k){if(!ne)return ji(v,k);var j=ne.InflateRaw,E=new j,T=E._processChunk(v.slice(v.l),E._finishFlushFlag);return v.l+=E.bytesRead,T}function N(v){return ne?ne.deflateRawSync(v):gi(v)}var _=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function z(v){var k=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(k>>16|k>>8|k)&255}for(var K=typeof Uint8Array!="undefined",Z=K?new Uint8Array(256):[],de=0;de<256;++de)Z[de]=z(de);function ge(v,k){var j=Z[v&255];return k<=8?j>>>8-k:(j=j<<8|Z[v>>8&255],k<=16?j>>>16-k:(j=j<<8|Z[v>>16&255],j>>>24-k))}function Se(v,k){var j=k&7,E=k>>>3;return(v[E]|(j<=6?0:v[E+1]<<8))>>>j&3}function Ne(v,k){var j=k&7,E=k>>>3;return(v[E]|(j<=5?0:v[E+1]<<8))>>>j&7}function Q(v,k){var j=k&7,E=k>>>3;return(v[E]|(j<=4?0:v[E+1]<<8))>>>j&15}function ce(v,k){var j=k&7,E=k>>>3;return(v[E]|(j<=3?0:v[E+1]<<8))>>>j&31}function D(v,k){var j=k&7,E=k>>>3;return(v[E]|(j<=1?0:v[E+1]<<8))>>>j&127}function ae(v,k,j){var E=k&7,T=k>>>3,F=(1<<j)-1,G=v[T]>>>E;return j<8-E||(G|=v[T+1]<<8-E,j<16-E)||(G|=v[T+2]<<16-E,j<24-E)||(G|=v[T+3]<<24-E),G&F}function _e(v,k,j){var E=k&7,T=k>>>3;return E<=5?v[T]|=(j&7)<<E:(v[T]|=j<<E&255,v[T+1]=(j&7)>>8-E),k+3}function Pe(v,k,j){var E=k&7,T=k>>>3;return j=(j&1)<<E,v[T]|=j,k+1}function De(v,k,j){var E=k&7,T=k>>>3;return j<<=E,v[T]|=j&255,j>>>=8,v[T+1]=j,k+8}function Ce(v,k,j){var E=k&7,T=k>>>3;return j<<=E,v[T]|=j&255,j>>>=8,v[T+1]=j&255,v[T+2]=j>>>8,k+16}function Wr(v,k){var j=v.length,E=2*j>k?2*j:k+5,T=0;if(j>=k)return v;if(Me){var F=Gi(E);if(v.copy)v.copy(F);else for(;T<v.length;++T)F[T]=v[T];return F}else if(K){var G=new Uint8Array(E);if(G.set)G.set(v);else for(;T<j;++T)G[T]=v[T];return G}return v.length=E,v}function Pr(v){for(var k=new Array(v),j=0;j<v;++j)k[j]=0;return k}function Dt(v,k,j){var E=1,T=0,F=0,G=0,se=0,V=v.length,Y=K?new Uint16Array(32):Pr(32);for(F=0;F<32;++F)Y[F]=0;for(F=V;F<j;++F)v[F]=0;V=v.length;var X=K?new Uint16Array(V):Pr(V);for(F=0;F<V;++F)Y[T=v[F]]++,E<T&&(E=T),X[F]=0;for(Y[0]=0,F=1;F<=E;++F)Y[F+16]=se=se+Y[F-1]<<1;for(F=0;F<V;++F)se=v[F],se!=0&&(X[F]=Y[se+16]++);var ue=0;for(F=0;F<V;++F)if(ue=v[F],ue!=0)for(se=ge(X[F],E)>>E-ue,G=(1<<E+4-ue)-1;G>=0;--G)k[se|G<<ue]=ue&15|F<<4;return E}var Qs=K?new Uint16Array(512):Pr(512),Zs=K?new Uint16Array(32):Pr(32);if(!K){for(var Ft=0;Ft<512;++Ft)Qs[Ft]=0;for(Ft=0;Ft<32;++Ft)Zs[Ft]=0}(function(){for(var v=[],k=0;k<32;k++)v.push(5);Dt(v,Zs,32);var j=[];for(k=0;k<=143;k++)j.push(8);for(;k<=255;k++)j.push(9);for(;k<=279;k++)j.push(7);for(;k<=287;k++)j.push(8);Dt(j,Qs,288)})();var H0=(function(){for(var k=K?new Uint8Array(32768):[],j=0,E=0;j<re.length-1;++j)for(;E<re[j+1];++E)k[E]=j;for(;E<32768;++E)k[E]=29;var T=K?new Uint8Array(259):[];for(j=0,E=0;j<U.length-1;++j)for(;E<U[j+1];++E)T[E]=j;function F(se,V){for(var Y=0;Y<se.length;){var X=Math.min(65535,se.length-Y),ue=Y+X==se.length;for(V.write_shift(1,+ue),V.write_shift(2,X),V.write_shift(2,~X&65535);X-- >0;)V[V.l++]=se[Y++]}return V.l}function G(se,V){for(var Y=0,X=0,ue=K?new Uint16Array(32768):[];X<se.length;){var ve=Math.min(65535,se.length-X);if(ve<10){for(Y=_e(V,Y,+(X+ve==se.length)),Y&7&&(Y+=8-(Y&7)),V.l=Y/8|0,V.write_shift(2,ve),V.write_shift(2,~ve&65535);ve-- >0;)V[V.l++]=se[X++];Y=V.l*8;continue}Y=_e(V,Y,+(X+ve==se.length)+2);for(var ye=0;ve-- >0;){var fe=se[X];ye=(ye<<5^fe)&32767;var we=-1,ke=0;if((we=ue[ye])&&(we|=X&-32768,we>X&&(we-=32768),we<X))for(;se[we+ke]==se[X+ke]&&ke<250;)++ke;if(ke>2){fe=T[ke],fe<=22?Y=De(V,Y,Z[fe+1]>>1)-1:(De(V,Y,3),Y+=5,De(V,Y,Z[fe-23]>>5),Y+=3);var Xe=fe<8?0:fe-4>>2;Xe>0&&(Ce(V,Y,ke-U[fe]),Y+=Xe),fe=k[X-we],Y=De(V,Y,Z[fe]>>3),Y-=3;var qe=fe<4?0:fe-2>>1;qe>0&&(Ce(V,Y,X-we-re[fe]),Y+=qe);for(var mr=0;mr<ke;++mr)ue[ye]=X&32767,ye=(ye<<5^se[X])&32767,++X;ve-=ke-1}else fe<=143?fe=fe+48:Y=Pe(V,Y,1),Y=De(V,Y,Z[fe]),ue[ye]=X&32767,++X}Y=De(V,Y,0)-1}return V.l=(Y+7)/8|0,V.l}return function(V,Y){return V.length<8?F(V,Y):G(V,Y)}})();function gi(v){var k=te(50+Math.floor(v.length*1.1)),j=H0(v,k);return k.slice(0,j)}var vi=K?new Uint16Array(32768):Pr(32768),bi=K?new Uint16Array(32768):Pr(32768),wi=K?new Uint16Array(128):Pr(128),yi=1,Ni=1;function V0(v,k){var j=ce(v,k)+257;k+=5;var E=ce(v,k)+1;k+=5;var T=Q(v,k)+4;k+=4;for(var F=0,G=K?new Uint8Array(19):Pr(19),se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,Y=K?new Uint8Array(8):Pr(8),X=K?new Uint8Array(8):Pr(8),ue=G.length,ve=0;ve<T;++ve)G[_[ve]]=F=Ne(v,k),V<F&&(V=F),Y[F]++,k+=3;var ye=0;for(Y[0]=0,ve=1;ve<=V;++ve)X[ve]=ye=ye+Y[ve-1]<<1;for(ve=0;ve<ue;++ve)(ye=G[ve])!=0&&(se[ve]=X[ye]++);var fe=0;for(ve=0;ve<ue;++ve)if(fe=G[ve],fe!=0){ye=Z[se[ve]]>>8-fe;for(var we=(1<<7-fe)-1;we>=0;--we)wi[ye|we<<fe]=fe&7|ve<<3}var ke=[];for(V=1;ke.length<j+E;)switch(ye=wi[D(v,k)],k+=ye&7,ye>>>=3){case 16:for(F=3+Se(v,k),k+=2,ye=ke[ke.length-1];F-- >0;)ke.push(ye);break;case 17:for(F=3+Ne(v,k),k+=3;F-- >0;)ke.push(0);break;case 18:for(F=11+D(v,k),k+=7;F-- >0;)ke.push(0);break;default:ke.push(ye),V<ye&&(V=ye);break}var Xe=ke.slice(0,j),qe=ke.slice(j);for(ve=j;ve<286;++ve)Xe[ve]=0;for(ve=E;ve<30;++ve)qe[ve]=0;return yi=Dt(Xe,vi,286),Ni=Dt(qe,bi,30),k}function G0(v,k){if(v[0]==3&&!(v[1]&3))return[Ut(k),2];for(var j=0,E=0,T=Gi(k||1<<18),F=0,G=T.length>>>0,se=0,V=0;(E&1)==0;){if(E=Ne(v,j),j+=3,E>>>1)E>>1==1?(se=9,V=5):(j=V0(v,j),se=yi,V=Ni);else{j&7&&(j+=8-(j&7));var Y=v[j>>>3]|v[(j>>>3)+1]<<8;if(j+=32,Y>0)for(!k&&G<F+Y&&(T=Wr(T,F+Y),G=T.length);Y-- >0;)T[F++]=v[j>>>3],j+=8;continue}for(;;){!k&&G<F+32767&&(T=Wr(T,F+32767),G=T.length);var X=ae(v,j,se),ue=E>>>1==1?Qs[X]:vi[X];if(j+=ue&15,ue>>>=4,(ue>>>8&255)===0)T[F++]=ue;else{if(ue==256)break;ue-=257;var ve=ue<8?0:ue-4>>2;ve>5&&(ve=0);var ye=F+U[ue];ve>0&&(ye+=ae(v,j,ve),j+=ve),X=ae(v,j,V),ue=E>>>1==1?Zs[X]:bi[X],j+=ue&15,ue>>>=4;var fe=ue<4?0:ue-2>>1,we=re[ue];for(fe>0&&(we+=ae(v,j,fe),j+=fe),!k&&G<ye&&(T=Wr(T,ye+100),G=T.length);F<ye;)T[F]=T[F-we],++F}}}return k?[T,j+7>>>3]:[T.slice(0,F),j+7>>>3]}function ji(v,k){var j=v.slice(v.l||0),E=G0(j,k);return v.l+=E[1],E[0]}function _i(v,k){if(v)typeof console!="undefined"&&console.error(k);else throw new Error(k)}function Ei(v,k){var j=v;Mr(j,0);var E=[],T=[],F={FileIndex:E,FullPaths:T};I(F,{root:k.root});for(var G=j.length-4;(j[G]!=80||j[G+1]!=75||j[G+2]!=5||j[G+3]!=6)&&G>=0;)--G;j.l=G+4,j.l+=4;var se=j.read_shift(2);j.l+=6;var V=j.read_shift(4);for(j.l=V,G=0;G<se;++G){j.l+=20;var Y=j.read_shift(4),X=j.read_shift(4),ue=j.read_shift(2),ve=j.read_shift(2),ye=j.read_shift(2);j.l+=8;var fe=j.read_shift(4),we=l(j.slice(j.l+ue,j.l+ue+ve));j.l+=ue+ve+ye;var ke=j.l;j.l=fe+4,Y0(j,Y,X,F,we),j.l=ke}return F}function Y0(v,k,j,E,T){v.l+=2;var F=v.read_shift(2),G=v.read_shift(2),se=o(v);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var V=v.read_shift(4),Y=v.read_shift(4),X=v.read_shift(4),ue=v.read_shift(2),ve=v.read_shift(2),ye="",fe=0;fe<ue;++fe)ye+=String.fromCharCode(v[v.l++]);if(ve){var we=l(v.slice(v.l,v.l+ve));(we[21589]||{}).mt&&(se=we[21589].mt),((T||{})[21589]||{}).mt&&(se=T[21589].mt)}v.l+=ve;var ke=v.slice(v.l,v.l+Y);switch(G){case 8:ke=A(v,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var Xe=!1;F&8&&(V=v.read_shift(4),V==134695760&&(V=v.read_shift(4),Xe=!0),Y=v.read_shift(4),X=v.read_shift(4)),Y!=k&&_i(Xe,"Bad compressed size: "+k+" != "+Y),X!=j&&_i(Xe,"Bad uncompressed size: "+j+" != "+X),en(E,ye,ke,{unsafe:!0,mt:se})}function X0(v,k){var j=k||{},E=[],T=[],F=te(1),G=j.compression?8:0,se=0,V=0,Y=0,X=0,ue=0,ve=v.FullPaths[0],ye=ve,fe=v.FileIndex[0],we=[],ke=0;for(V=1;V<v.FullPaths.length;++V)if(ye=v.FullPaths[V].slice(ve.length),fe=v.FileIndex[V],!(!fe.size||!fe.content||ye=="Sh33tJ5")){var Xe=X,qe=te(ye.length);for(Y=0;Y<ye.length;++Y)qe.write_shift(1,ye.charCodeAt(Y)&127);qe=qe.slice(0,qe.l),we[ue]=hf.buf(fe.content,0);var mr=fe.content;G==8&&(mr=N(mr)),F=te(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,se),F.write_shift(2,G),fe.mt?i(F,fe.mt):F.write_shift(4,0),F.write_shift(-4,we[ue]),F.write_shift(4,mr.length),F.write_shift(4,fe.content.length),F.write_shift(2,qe.length),F.write_shift(2,0),X+=F.length,E.push(F),X+=qe.length,E.push(qe),X+=mr.length,E.push(mr),F=te(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,se),F.write_shift(2,G),F.write_shift(4,0),F.write_shift(-4,we[ue]),F.write_shift(4,mr.length),F.write_shift(4,fe.content.length),F.write_shift(2,qe.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,Xe),ke+=F.l,T.push(F),ke+=qe.length,T.push(qe),++ue}return F=te(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,ue),F.write_shift(2,ue),F.write_shift(4,ke),F.write_shift(4,X),F.write_shift(2,0),ur([ur(E),ur(T),F])}var ns={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function q0(v,k){if(v.ctype)return v.ctype;var j=v.name||"",E=j.match(/\.([^\.]+)$/);return E&&ns[E[1]]||k&&(E=(j=k).match(/[\.\\]([^\.\\])+$/),E&&ns[E[1]])?ns[E[1]]:"application/octet-stream"}function K0(v){for(var k=Ua(v),j=[],E=0;E<k.length;E+=76)j.push(k.slice(E,E+76));return j.join(`\r
`)+`\r
`}function J0(v){var k=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Y){var X=Y.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});k=k.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),k.charAt(0)==`
`&&(k="=0D"+k.slice(1)),k=k.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],E=k.split(`\r
`),T=0;T<E.length;++T){var F=E[T];if(F.length==0){j.push("");continue}for(var G=0;G<F.length;){var se=76,V=F.slice(G,G+se);V.charAt(se-1)=="="?se--:V.charAt(se-2)=="="?se-=2:V.charAt(se-3)=="="&&(se-=3),V=F.slice(G,G+se),G+=se,G<F.length&&(V+="="),j.push(V)}}return j.join(`\r
`)}function Q0(v){for(var k=[],j=0;j<v.length;++j){for(var E=v[j];j<=v.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+v[++j];k.push(E)}for(var T=0;T<k.length;++T)k[T]=k[T].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return Gr(k.join(`\r
`))}function Z0(v,k,j){for(var E="",T="",F="",G,se=0;se<10;++se){var V=k[se];if(!V||V.match(/^\s*$/))break;var Y=V.match(/^(.*?):\s*([^\s].*)$/);if(Y)switch(Y[1].toLowerCase()){case"content-location":E=Y[2].trim();break;case"content-type":F=Y[2].trim();break;case"content-transfer-encoding":T=Y[2].trim();break}}switch(++se,T.toLowerCase()){case"base64":G=Gr(xt(k.slice(se).join("")));break;case"quoted-printable":G=Q0(k.slice(se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+T)}var X=en(v,E.slice(j.length),G,{unsafe:!0});F&&(X.ctype=F)}function ec(v,k){if(ie(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=k&&k.root||"",E=(Me&&Buffer.isBuffer(v)?v.toString("binary"):ie(v)).split(`\r
`),T=0,F="";for(T=0;T<E.length;++T)if(F=E[T],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),j||(j=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),F.slice(0,j.length)!=j););var G=(E[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var se="--"+(G[1]||""),V=[],Y=[],X={FileIndex:V,FullPaths:Y};I(X);var ue,ve=0;for(T=0;T<E.length;++T){var ye=E[T];ye!==se&&ye!==se+"--"||(ve++&&Z0(X,E.slice(ue,T),j),ue=T)}return X}function rc(v,k){var j=k||{},E=j.boundary||"SheetJS";E="------="+E;for(var T=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],F=v.FullPaths[0],G=F,se=v.FileIndex[0],V=1;V<v.FullPaths.length;++V)if(G=v.FullPaths[V].slice(F.length),se=v.FileIndex[V],!(!se.size||!se.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ke){return"_x"+ke.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ke){return"_u"+ke.charCodeAt(0).toString(16)+"_"});for(var Y=se.content,X=Me&&Buffer.isBuffer(Y)?Y.toString("binary"):ie(Y),ue=0,ve=Math.min(1024,X.length),ye=0,fe=0;fe<=ve;++fe)(ye=X.charCodeAt(fe))>=32&&ye<128&&++ue;var we=ue>=ve*4/5;T.push(E),T.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+G),T.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),T.push("Content-Type: "+q0(se,G)),T.push(""),T.push(we?J0(X):K0(X))}return T.push(E+`--\r
`),T.join(`\r
`)}function tc(v){var k={};return I(k,v),k}function en(v,k,j,E){var T=E&&E.unsafe;T||I(v);var F=!T&&$e.find(v,k);if(!F){var G=v.FullPaths[0];k.slice(0,G.length)==G?G=k:(G.slice(-1)!="/"&&(G+="/"),G=(G+k).replace("//","/")),F={name:n(k),type:2},v.FileIndex.push(F),v.FullPaths.push(G),T||$e.utils.cfb_gc(v)}return F.content=j,F.size=j?j.length:0,E&&(E.CLSID&&(F.clsid=E.CLSID),E.mt&&(F.mt=E.mt),E.ct&&(F.ct=E.ct)),F}function ac(v,k){I(v);var j=$e.find(v,k);if(j){for(var E=0;E<v.FileIndex.length;++E)if(v.FileIndex[E]==j)return v.FileIndex.splice(E,1),v.FullPaths.splice(E,1),!0}return!1}function sc(v,k,j){I(v);var E=$e.find(v,k);if(E){for(var T=0;T<v.FileIndex.length;++T)if(v.FileIndex[T]==E)return v.FileIndex[T].name=n(j),v.FullPaths[T]=j,!0}return!1}function nc(v){W(v,!0)}return t.find=ee,t.read=L,t.parse=u,t.write=B,t.writeFile=M,t.utils={cfb_new:tc,cfb_add:en,cfb_del:ac,cfb_mov:sc,cfb_gc:nc,ReadShift:Pa,CheckField:Fl,prep_blob:Mr,bconcat:ur,use_zlib:C,_deflateRaw:gi,_inflateRaw:ji,consts:le},t})();function xf(e){return typeof e=="string"?zs(e):Array.isArray(e)?Bu(e):e}function Ja(e,t,r){if(typeof Deno!="undefined"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=zs(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?za(t):t;if(typeof IE_SaveFile!="undefined")return IE_SaveFile(s,e);if(typeof Blob!="undefined"){var n=new Blob([xf(s)],{type:"application/octet-stream"});if(typeof navigator!="undefined"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs!="undefined")return saveAs(n,e);if(typeof URL!="undefined"&&typeof document!="undefined"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Ka(t)),l.write(t),l.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function xr(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function eo(e,t){for(var r=[],s=xr(e),n=0;n!==s.length;++n)r[e[s[n]][t]]==null&&(r[e[s[n]][t]]=s[n]);return r}function Vn(e){for(var t=[],r=xr(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function Gs(e){for(var t=[],r=xr(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function mf(e){for(var t=[],r=xr(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var As=new Date(1899,11,30,0,0,0);function Dr(e,t){var r=e.getTime(),s=As.getTime()+(e.getTimezoneOffset()-As.getTimezoneOffset())*6e4;return(r-s)/(1440*60*1e3)}var ml=new Date,pf=As.getTime()+(ml.getTimezoneOffset()-As.getTimezoneOffset())*6e4,ro=ml.getTimezoneOffset();function pl(e){var t=new Date;return t.setTime(e*24*60*60*1e3+pf),t.getTimezoneOffset()!==ro&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ro)*6e4),t}var to=new Date("2017-02-19T19:06:09.000Z"),gl=isNaN(to.getFullYear())?new Date("2/19/17"):to,gf=gl.getFullYear()==2017;function _r(e,t){var r=new Date(e);if(gf)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(gl.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Ys(e,t){if(Me&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder!="undefined")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function Fr(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Fr(e[r]));return t}function Je(e,t){for(var r="";r.length<t;)r+=e;return r}function ut(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(s)))?t/r:t}var vf=["january","february","march","april","may","june","july","august","september","october","november","december"];function $a(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&vf.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||i>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Te(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return Me?s=pt(r):s=Wu(r),$e.utils.cfb_add(e,t,s)}$e.utils.cfb_add(e,t,r)}else e.file(t,r)}function Gn(){return $e.utils.cfb_new()}var ar=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,bf={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Yn=Vn(bf),Xn=/[&<>'"]/g,wf=/[\u0000-\u0008\u000b-\u001f]/g;function We(e){var t=e+"";return t.replace(Xn,function(r){return Yn[r]}).replace(wf,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ao(e){return We(e).replace(/ /g,"_x0020_")}var vl=/[\u0000-\u001f]/g;function yf(e){var t=e+"";return t.replace(Xn,function(r){return Yn[r]}).replace(/\n/g,"<br/>").replace(vl,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Nf(e){var t=e+"";return t.replace(Xn,function(r){return Yn[r]}).replace(vl,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function jf(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function _f(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function cn(e){for(var t="",r=0,s=0,n=0,i=0,o=0,l=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){o=(s&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((s&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function so(e){var t=Ut(2*e.length),r,s,n=1,i=0,o=0,l;for(s=0;s<e.length;s+=n)n=1,(l=e.charCodeAt(s))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(s+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function no(e){return pt(e,"binary").toString("utf8")}var fs="foo bar bazâð£",Fa=Me&&(no(fs)==cn(fs)&&no||so(fs)==cn(fs)&&so)||cn,za=Me?function(e){return pt(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},Ef=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}})(),bl=/(^\s|\s$|\n)/;function fr(e,t){return"<"+e+(t.match(bl)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ha(e){return xr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function xe(e,t,r){return"<"+e+(r!=null?Ha(r):"")+(t!=null?(t.match(bl)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function En(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Sf(e,t){switch(typeof e){case"string":var r=xe("vt:lpwstr",We(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return xe((e|0)==e?"vt:i4":"vt:r8",We(String(e)));case"boolean":return xe("vt:bool",e?"true":"false")}if(e instanceof Date)return xe("vt:filetime",En(e));throw new Error("Unable to serialize "+e)}var ir={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},xa=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ir={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function kf(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function Tf(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,o=s?-t:t;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|s}var io=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,i=e[0][s].length;n<i;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},oo=Me?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:pt(t)})):io(e)}:io,lo=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(ka(e,n)));return s.join("").replace(Da,"")},qn=Me?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Da,""):lo(e,t,r)}:lo,co=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},wl=Me?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):co(e,t,r)}:co,uo=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(ta(e,n)));return s.join("")},Qa=Me?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):uo(t,r,s)}:uo,yl=function(e,t){var r=Rr(e,t);return r>0?Qa(e,t+4,t+4+r-1):""},Nl=yl,jl=function(e,t){var r=Rr(e,t);return r>0?Qa(e,t+4,t+4+r-1):""},_l=jl,El=function(e,t){var r=2*Rr(e,t);return r>0?Qa(e,t+4,t+4+r-1):""},Sl=El,kl=function(t,r){var s=Rr(t,r);return s>0?qn(t,r+4,r+4+s):""},Tl=kl,Cl=function(e,t){var r=Rr(e,t);return r>0?Qa(e,t+4,t+4+r):""},Al=Cl,Dl=function(e,t){return kf(e,t)},Ds=Dl,Kn=function(t){return Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array};Me&&(Nl=function(t,r){if(!Buffer.isBuffer(t))return yl(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},_l=function(t,r){if(!Buffer.isBuffer(t))return jl(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},Sl=function(t,r){if(!Buffer.isBuffer(t))return El(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},Tl=function(t,r){if(!Buffer.isBuffer(t))return kl(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},Al=function(t,r){if(!Buffer.isBuffer(t))return Cl(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Ds=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Dl(t,r)},Kn=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array});var ta=function(e,t){return e[t]},ka=function(e,t){return e[t+1]*256+e[t]},Cf=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Rr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Mt=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Af=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Pa(e,t){var r="",s,n,i=[],o,l,d,c;switch(t){case"dbcs":if(c=this.l,Me&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(ka(this,c)),c+=2;e*=2;break;case"utf8":r=Qa(this,this.l,this.l+e);break;case"utf16le":e*=2,r=qn(this,this.l,this.l+e);break;case"wstr":return Pa.call(this,e,"dbcs");case"lpstr-ansi":r=Nl(this,this.l),e=4+Rr(this,this.l);break;case"lpstr-cp":r=_l(this,this.l),e=4+Rr(this,this.l);break;case"lpwstr":r=Sl(this,this.l),e=4+2*Rr(this,this.l);break;case"lpp4":e=4+Rr(this,this.l),r=Tl(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Rr(this,this.l),r=Al(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=ta(this,this.l+e++))!==0;)i.push(cs(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=ka(this,this.l+e))!==0;)i.push(cs(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=ta(this,c),this.l=c+1,l=Pa.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(cs(ka(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=ta(this,c),this.l=c+1,l=Pa.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(cs(ta(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return s=ta(this,this.l),this.l++,s;case 2:return s=(t==="i"?Cf:ka)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(s=(e>0?Mt:Af)(this,this.l),this.l+=4,s):(n=Rr(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Ds(this,this.l):n=Ds([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=wl(this,this.l,e);break}}return this.l+=e,r}var Df=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Ff=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Pf=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Of(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)Pf(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,Df(this,t,this.l);break;case 8:if(s=8,r==="f"){Tf(this,t,this.l);break}case 16:break;case-4:s=4,Ff(this,t,this.l);break}return this.l+=s,this}function Fl(e,t){var r=wl(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Mr(e,t){e.l=t,e.read_shift=Pa,e.chk=Fl,e.write_shift=Of}function nt(e,t){e.l+=t}function te(e){var t=Ut(e);return Mr(t,0),t}function Ar(){var e=[],t=Me?256:2048,r=function(c){var u=te(c);return Mr(u,0),u},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},i=function(c){return s&&c<s.length-s.l?s:(n(),s=r(Math.max(c+1,t)))},o=function(){return n(),ur(e)},l=function(c){n(),s=c,s.l==null&&(s.l=s.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function oe(e,t,r,s){var n=+t,i;if(!isNaN(n)){s||(s=k1[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,s>=128&&++i,s>=16384&&++i,s>=2097152&&++i;var o=e.next(i);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&Kn(r)&&e.push(r)}}function Oa(e,t,r){var s=Fr(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function fo(e,t,r){var s=Fr(e);return s.s=Oa(s.s,t.s,r),s.e=Oa(s.e,t.s,r),s}function Ma(e,t){if(e.cRel&&e.c<0)for(e=Fr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Fr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ue(e);return!e.cRel&&e.cRel!=null&&(r=Rf(r)),!e.rRel&&e.rRel!=null&&(r=Mf(r)),r}function dn(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+pr(e.s.c)+":"+(e.e.cRel?"":"$")+pr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+hr(e.s.r)+":"+(e.e.rRel?"":"$")+hr(e.e.r):Ma(e.s,t.biff)+":"+Ma(e.e,t.biff)}function Jn(e){return parseInt(If(e),10)-1}function hr(e){return""+(e+1)}function Mf(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function If(e){return e.replace(/\$(\d+)$/,"$1")}function Qn(e){for(var t=Lf(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function pr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Rf(e){return e.replace(/^([A-Z])/,"$$$1")}function Lf(e){return e.replace(/^\$([A-Z])/,"$1")}function Bf(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function or(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ue(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Br(e){var t=e.indexOf(":");return t==-1?{s:or(e),e:or(e)}:{s:or(e.slice(0,t)),e:or(e.slice(t+1))}}function tr(e,t){return typeof t=="undefined"||typeof t=="number"?tr(e.s,e.e):(typeof e!="string"&&(e=Ue(e)),typeof t!="string"&&(t=Ue(t)),e==t?e:e+":"+t)}function Ve(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,i=e.length;for(r=0;s<i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function ho(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=kt(e.z,r?Dr(t):t)}catch{}try{return e.w=kt((e.XF||{}).numFmtId||(r?14:0),r?Dr(t):t)}catch{return""+t}}function mt(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Za[e.v]||e.v:t==null?ho(e,e.v):ho(e,t))}function Ht(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function Pl(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,i=e||(n?[]:{}),o=0,l=0;if(i&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var d=typeof s.origin=="string"?or(s.origin):s.origin;o=d.r,l=d.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Ve(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[h].length;++m)if(typeof t[h][m]!="undefined"){var f={v:t[h][m]},g=o+h,x=l+m;if(c.s.r>g&&(c.s.r=g),c.s.c>x&&(c.s.c=x),c.e.r<g&&(c.e.r=g),c.e.c<x&&(c.e.c=x),t[h][m]&&typeof t[h][m]=="object"&&!Array.isArray(t[h][m])&&!(t[h][m]instanceof Date))f=t[h][m];else if(Array.isArray(f.v)&&(f.f=t[h][m][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(s.nullError)f.t="e",f.v=0;else if(s.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=s.dateNF||Qe[14],s.cellDates?(f.t="d",f.w=kt(f.z,Dr(f.v))):(f.t="n",f.v=Dr(f.v),f.w=kt(f.z,f.v))):f.t="s";if(n)i[g]||(i[g]=[]),i[g][x]&&i[g][x].z&&(f.z=i[g][x].z),i[g][x]=f;else{var p=Ue({c:x,r:g});i[p]&&i[p].z&&(f.z=i[p].z),i[p]=f}}}return c.s.c<1e7&&(i["!ref"]=tr(c)),i}function ma(e,t){return Pl(null,e,t)}function Wf(e){return e.read_shift(4,"i")}function Xr(e,t){return t||(t=te(4)),t.write_shift(4,e),t}function gr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function lr(e,t){var r=!1;return t==null&&(r=!0,t=te(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Uf(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function $f(e,t){return t||(t=te(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Zn(e,t){var r=e.l,s=e.read_shift(1),n=gr(e),i=[],o={t:n,h:n};if((s&1)!==0){for(var l=e.read_shift(4),d=0;d!=l;++d)i.push(Uf(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function zf(e,t){var r=!1;return t==null&&(r=!0,t=te(15+4*e.t.length)),t.write_shift(1,0),lr(e.t,t),r?t.slice(0,t.l):t}var Hf=Zn;function Vf(e,t){var r=!1;return t==null&&(r=!0,t=te(23+4*e.t.length)),t.write_shift(1,1),lr(e.t,t),t.write_shift(4,1),$f({},t),r?t.slice(0,t.l):t}function zr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Vt(e,t){return t==null&&(t=te(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Gt(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Yt(e,t){return t==null&&(t=te(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Gf=gr,Ol=lr;function ei(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Fs(e,t){var r=!1;return t==null&&(r=!0,t=te(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Yf=gr,Sn=ei,ri=Fs;function Ml(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?Ds([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Mt(t,0)>>2;return r?n/100:n}function Il(e,t){t==null&&(t=te(4));var r=0,s=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Rl(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Xf(e,t){return t||(t=te(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Xt=Rl,pa=Xf;function ga(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function $t(e,t){return(t||te(8)).write_shift(8,e,"f")}function qf(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),d=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var c=sh[n];c&&(t.rgb=_o(c));break;case 2:t.rgb=_o([o,l,d]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Ps(e,t){if(t||(t=te(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function Kf(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Jf(e,t){t||(t=te(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Ll=2,Or=3,hs=11,Os=19,xs=64,Qf=65,Zf=71,eh=4108,rh=4126,dr=80,xo={1:{n:"CodePage",t:Ll},2:{n:"Category",t:dr},3:{n:"PresentationFormat",t:dr},4:{n:"ByteCount",t:Or},5:{n:"LineCount",t:Or},6:{n:"ParagraphCount",t:Or},7:{n:"SlideCount",t:Or},8:{n:"NoteCount",t:Or},9:{n:"HiddenCount",t:Or},10:{n:"MultimediaClipCount",t:Or},11:{n:"ScaleCrop",t:hs},12:{n:"HeadingPairs",t:eh},13:{n:"TitlesOfParts",t:rh},14:{n:"Manager",t:dr},15:{n:"Company",t:dr},16:{n:"LinksUpToDate",t:hs},17:{n:"CharacterCount",t:Or},19:{n:"SharedDoc",t:hs},22:{n:"HyperlinksChanged",t:hs},23:{n:"AppVersion",t:Or,p:"version"},24:{n:"DigSig",t:Qf},26:{n:"ContentType",t:dr},27:{n:"ContentStatus",t:dr},28:{n:"Language",t:dr},29:{n:"Version",t:dr},255:{},2147483648:{n:"Locale",t:Os},2147483651:{n:"Behavior",t:Os},1919054434:{}},mo={1:{n:"CodePage",t:Ll},2:{n:"Title",t:dr},3:{n:"Subject",t:dr},4:{n:"Author",t:dr},5:{n:"Keywords",t:dr},6:{n:"Comments",t:dr},7:{n:"Template",t:dr},8:{n:"LastAuthor",t:dr},9:{n:"RevNumber",t:dr},10:{n:"EditTime",t:xs},11:{n:"LastPrinted",t:xs},12:{n:"CreatedDate",t:xs},13:{n:"ModifiedDate",t:xs},14:{n:"PageCount",t:Or},15:{n:"WordCount",t:Or},16:{n:"CharCount",t:Or},17:{n:"Thumbnail",t:Zf},18:{n:"Application",t:dr},19:{n:"DocSecurity",t:Or},255:{},2147483648:{n:"Locale",t:Os},2147483651:{n:"Behavior",t:Os},1919054434:{}};function th(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var ah=th([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),sh=Fr(ah),Za={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},nh={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ms={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Bl(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Wl(e,t){var r=mf(nh),s=[],n;s[s.length]=ar,s[s.length]=xe("Types",null,{xmlns:ir.CT,"xmlns:xsd":ir.xsd,"xmlns:xsi":ir.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return xe("Default",null,{Extension:d[0],ContentType:d[1]})}));var i=function(d){e[d]&&e[d].length>0&&(n=e[d][0],s[s.length]=xe("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:ms[d][t.bookType]||ms[d].xlsx}))},o=function(d){(e[d]||[]).forEach(function(c){s[s.length]=xe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:ms[d][t.bookType]||ms[d].xlsx})})},l=function(d){(e[d]||[]).forEach(function(c){s[s.length]=xe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[d][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var Oe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ul(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function la(e){var t=[ar,xe("Relationships",null,{xmlns:ir.RELS})];return xr(e["!id"]).forEach(function(r){t[t.length]=xe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Be(e,t,r,s,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=s,n.Target=r,[Oe.HLINK,Oe.XPATH,Oe.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}function ih(e){var t=[ar];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function po(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function oh(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function lh(e){var t=[ar];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(po(e[r][0],e[r][1])),t.push(oh("",e[r][0]));return t.push(po("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function $l(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Es.version+"</meta:generator></office:meta></office:document-meta>"}var Lt=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function un(e,t,r,s,n){n[e]!=null||t==null||t===""||(n[e]=t,t=We(t),s[s.length]=r?xe(e,t,r):fr(e,t))}function zl(e,t){var r=t||{},s=[ar,xe("cp:coreProperties",null,{"xmlns:cp":ir.CORE_PROPS,"xmlns:dc":ir.dc,"xmlns:dcterms":ir.dcterms,"xmlns:dcmitype":ir.dcmitype,"xmlns:xsi":ir.xsi})],n={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&un("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:En(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),e.ModifiedDate!=null&&un("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:En(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var i=0;i!=Lt.length;++i){var o=Lt[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&un(o[0],l,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var ca=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Hl=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Vl(e){var t=[],r=xe;return e||(e={}),e.Application="SheetJS",t[t.length]=ar,t[t.length]=xe("Properties",null,{xmlns:ir.EXT_PROPS,"xmlns:vt":ir.vt}),ca.forEach(function(s){if(e[s[1]]!==void 0){var n;switch(s[2]){case"string":n=We(String(e[s[1]]));break;case"bool":n=e[s[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(s[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+We(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Gl(e){var t=[ar,xe("Properties",null,{xmlns:ir.CUST_PROPS,"xmlns:vt":ir.vt})];if(!e)return t.join("");var r=1;return xr(e).forEach(function(n){++r,t[t.length]=xe("property",Sf(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:We(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var go={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function ch(e,t){var r=[];return xr(go).map(function(s){for(var n=0;n<Lt.length;++n)if(Lt[n][1]==s)return Lt[n];for(n=0;n<ca.length;++n)if(ca[n][1]==s)return ca[n];throw s}).forEach(function(s){if(e[s[1]]!=null){var n=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(fr(go[s[1]]||s[1],n))}}),xe("DocumentProperties",r.join(""),{xmlns:Ir.o})}function dh(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return e&&xr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Lt.length;++o)if(i==Lt[o][1])return;for(o=0;o<ca.length;++o)if(i==ca[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],d="string";typeof l=="number"?(d="float",l=String(l)):l===!0||l===!1?(d="boolean",l=l?"1":"0"):l=String(l),n.push(xe(ao(i),l,{"dt:dt":d}))}}),t&&xr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),n.push(xe(ao(i),o,{"dt:dt":l}))}}),"<"+s+' xmlns="'+Ir.o+'">'+n.join("")+"</"+s+">"}function uh(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),n=(r-s)/Math.pow(2,32);s*=1e7,n*=1e7;var i=s/Math.pow(2,32)|0;i>0&&(s=s%Math.pow(2,32),n+=i);var o=te(8);return o.write_shift(4,s),o.write_shift(4,n),o}function vo(e,t){var r=te(4),s=te(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=te(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=uh(t);break;case 31:case 80:for(s=te(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ur([r,s])}var Yl=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function fh(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function bo(e,t,r){var s=te(8),n=[],i=[],o=8,l=0,d=te(8),c=te(8);if(d.write_shift(4,2),d.write_shift(4,1200),c.write_shift(4,1),i.push(d),n.push(c),o+=8+d.length,!t){c=te(8),c.write_shift(4,0),n.unshift(c);var u=[te(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var h=e[l][0];for(d=te(8+2*(h.length+1)+(h.length%2?0:2)),d.write_shift(4,l+2),d.write_shift(4,h.length+1),d.write_shift(0,h,"dbcs");d.l!=d.length;)d.write_shift(1,0);u.push(d)}d=ur(u),i.unshift(d),o+=8+d.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(Yl.indexOf(e[l][0])>-1||Hl.indexOf(e[l][0])>-1)&&e[l][1]!=null){var m=e[l][1],f=0;if(t){f=+t[e[l][0]];var g=r[f];if(g.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}d=vo(g.t,m)}else{var p=fh(m);p==-1&&(p=31,m=String(m)),d=vo(p,m)}i.push(d),c=te(8),c.write_shift(4,t?f:2+l),n.push(c),o+=8+d.length}var w=8*(i.length+1);for(l=0;l<i.length;++l)n[l].write_shift(4,w),w+=i[l].length;return s.write_shift(4,o),s.write_shift(4,i.length),ur([s].concat(n).concat(i))}function wo(e,t,r,s,n,i){var o=te(n?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,$e.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var d=bo(e,r,s);if(l.push(d),n){var c=bo(n,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+d.length),l.push(c)}return ur(l)}function hh(e,t){t||(t=te(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function xh(e,t){return e.read_shift(t)===1}function wr(e,t){return t||(t=te(2)),t.write_shift(2,+!!e),t}function Xl(e){return e.read_shift(2,"u")}function $r(e,t){return t||(t=te(2)),t.write_shift(2,e),t}function ql(e,t,r){return r||(r=te(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Kl(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=s?e.read_shift(s,n):"";return o}function mh(e){var t=e.t||"",r=te(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=te(2*t.length);s.write_shift(2*t.length,t,"utf16le");var n=[r,s];return ur(n)}function ph(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function gh(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):ph(e,s,r)}function vh(e,t,r){if(r.biff>5)return gh(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Jl(e,t,r){return r||(r=te(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function yo(e,t){t||(t=te(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function bh(e){var t=te(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),i=n>-1?31:23;switch(s.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)s=s.slice(1),yo(s,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=n>-1?s.slice(0,n):s;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&yo(n>-1?s.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var d=0;s.slice(d*3,d*3+3)=="../"||s.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,s.length-3*d+1),r=0;r<s.length-3*d;++r)t.write_shift(1,s.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function zt(e,t,r,s){return s||(s=te(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function wh(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),i=e.read_shift(s,"i"),o=e.read_shift(s,"i");return[n,i,o]}function yh(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function Ql(e,t){return t||(t=te(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ti(e,t,r){var s=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=te(n);return i.write_shift(2,s),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Nh(e,t){var r=!t||t.biff==8,s=te(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function jh(e,t){var r=!t||t.biff>=8?2:1,s=te(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function _h(e,t){var r=te(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],n=0;n<e.length;++n)s[n]=mh(e[n]);var i=ur([r].concat(s));return i.parts=[r.length].concat(s.map(function(o){return o.length})),i}function Eh(){var e=te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Sh(e){var t=te(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function kh(e,t){var r=e.name||"Arial",s=t&&t.biff==5,n=s?15+r.length:16+2*r.length,i=te(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),i}function Th(e,t,r,s){var n=te(10);return zt(e,t,s,n),n.write_shift(4,r),n}function Ch(e,t,r,s,n){var i=!n||n.biff==8,o=te(8+ +i+(1+i)*r.length);return zt(e,t,s,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function Ah(e,t,r,s){var n=r&&r.biff==5;s||(s=te(n?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(n?1:2,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=s.length>s.l?s.slice(0,s.l):s;return i.l==null&&(i.l=i.length),i}function Dh(e,t){var r=t.biff==8||!t.biff?4:2,s=te(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function No(e,t,r,s){var n=r&&r.biff==5;s||(s=te(n?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),s.write_shift(4,i),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function Fh(e){var t=te(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Ph(e,t,r,s,n,i){var o=te(8);return zt(e,t,s,o),ql(r,i,o),o}function Oh(e,t,r,s){var n=te(14);return zt(e,t,s,n),$t(r,n),n}function Mh(e,t,r){if(r.biff<8)return Ih(e,t,r);for(var s=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)s.push(wh(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function Ih(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=Kl(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function Rh(e){var t=te(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Ql(e[r],t);return t}function Lh(e){var t=te(24),r=or(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(s[n],16));return ur([t,bh(e[1])])}function Bh(e){var t=e[1].Tooltip,r=te(10+2*(t.length+1));r.write_shift(2,2048);var s=or(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function Wh(e){return e||(e=te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Uh(e,t,r){if(!r.cellStyles)return nt(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(s),d=e.read_shift(2);s==2&&(e.l+=2);var c={s:n,e:i,w:o,ixfe:l,flags:d};return(r.biff>=5||!r.biff)&&(c.level=d>>8&7),c}function $h(e,t){var r=te(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function zh(e){for(var t=te(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function Hh(e,t,r){var s=te(15);return rs(s,e,t),s.write_shift(8,r,"f"),s}function Vh(e,t,r){var s=te(9);return rs(s,e,t),s.write_shift(2,r),s}var Gh=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Vn({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,d){var c=[],u=Ut(1);switch(d.type){case"base64":u=Gr(xt(l));break;case"binary":u=Gr(l);break;case"buffer":case"array":u=l;break}Mr(u,0);var h=u.read_shift(1),m=!!(h&136),f=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:f=!0,m=!0;break;case 49:f=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,p=521;h==2&&(x=u.read_shift(2)),u.l+=3,h!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(p=u.read_shift(2));var w=u.read_shift(2),b=d.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var y=[],S={},P=Math.min(u.length,h==2?521:p-10-(f?264:0)),L=g?32:11;u.l<P&&u[u.l]!=13;)switch(S={},S.name=Ss.utils.decode(b,u.slice(u.l,u.l+L)).replace(/[\u0000\r\n].*$/g,""),u.l+=L,S.type=String.fromCharCode(u.read_shift(1)),h!=2&&!g&&(S.offset=u.read_shift(4)),S.len=u.read_shift(1),h==2&&(S.offset=u.read_shift(2)),S.dec=u.read_shift(1),S.name.length&&y.push(S),h!=2&&(u.l+=g?13:14),S.type){case"B":(!f||S.len!=8)&&d.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(u[u.l]!==13&&(u.l=p-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=p;var I=0,H=0;for(c[0]=[],H=0;H!=y.length;++H)c[0][H]=y[H].name;for(;x-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++I]=[],H=0,H=0;H!=y.length;++H){var W=u.slice(u.l,u.l+y[H].len);u.l+=y[H].len,Mr(W,0);var J=Ss.utils.decode(b,W);switch(y[H].type){case"C":J.trim().length&&(c[I][H]=J.replace(/\s+$/,""));break;case"D":J.length===8?c[I][H]=new Date(+J.slice(0,4),+J.slice(4,6)-1,+J.slice(6,8)):c[I][H]=J;break;case"F":c[I][H]=parseFloat(J.trim());break;case"+":case"I":c[I][H]=g?W.read_shift(-4,"i")^2147483648:W.read_shift(4,"i");break;case"L":switch(J.trim().toUpperCase()){case"Y":case"T":c[I][H]=!0;break;case"N":case"F":c[I][H]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+J+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[I][H]="##MEMO##"+(g?parseInt(J.trim(),10):W.read_shift(4));break;case"N":J=J.replace(/\u0000/g,"").trim(),J&&J!="."&&(c[I][H]=+J||0);break;case"@":c[I][H]=new Date(W.read_shift(-8,"f")-621356832e5);break;case"T":c[I][H]=new Date((W.read_shift(4)-2440588)*864e5+W.read_shift(4));break;case"Y":c[I][H]=W.read_shift(4,"i")/1e4+W.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[I][H]=-W.read_shift(-8,"f");break;case"B":if(f&&y[H].len==8){c[I][H]=W.read_shift(8,"f");break}case"G":case"P":W.l+=y[H].len;break;case"0":if(y[H].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[H].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return d&&d.sheetRows&&(c=c.slice(0,d.sheetRows)),d.DBF=y,c}function s(l,d){var c=d||{};c.dateNF||(c.dateNF="yyyymmdd");var u=ma(r(l,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function n(l,d){try{return Ht(s(l,d),d)}catch(c){if(d&&d.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,d){var c=d||{};if(+c.codepage>=0&&Wa(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Ar(),h=Bs(l,{header:1,raw:!0,cellDates:!0}),m=h[0],f=h.slice(1),g=l["!cols"]||[],x=0,p=0,w=0,b=1;for(x=0;x<m.length;++x){if(((g[x]||{}).DBF||{}).name){m[x]=g[x].DBF.name,++w;continue}if(m[x]!=null){if(++w,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(p=0;p<1024;++p)if(m.indexOf(m[x]+"_"+p)==-1){m[x]+="_"+p;break}}}}var y=Ve(l["!ref"]),S=[],P=[],L=[];for(x=0;x<=y.e.c-y.s.c;++x){var I="",H="",W=0,J=[];for(p=0;p<f.length;++p)f[p][x]!=null&&J.push(f[p][x]);if(J.length==0||m[x]==null){S[x]="?";continue}for(p=0;p<J.length;++p){switch(typeof J[p]){case"number":H="B";break;case"string":H="C";break;case"boolean":H="L";break;case"object":H=J[p]instanceof Date?"D":"C";break;default:H="C"}W=Math.max(W,String(J[p]).length),I=I&&I!=H?"C":H}W>250&&(W=250),H=((g[x]||{}).DBF||{}).type,H=="C"&&g[x].DBF.len>W&&(W=g[x].DBF.len),I=="B"&&H=="N"&&(I="N",L[x]=g[x].DBF.dec,W=g[x].DBF.len),P[x]=I=="C"||H=="N"?W:i[I]||0,b+=P[x],S[x]=I}var ee=u.next(32);for(ee.write_shift(4,318902576),ee.write_shift(4,f.length),ee.write_shift(2,296+32*w),ee.write_shift(2,b),x=0;x<4;++x)ee.write_shift(4,0);for(ee.write_shift(4,0|(+t[el]||3)<<8),x=0,p=0;x<m.length;++x)if(m[x]!=null){var R=u.next(32),q=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,q,"sbcs"),R.write_shift(1,S[x]=="?"?"C":S[x],"sbcs"),R.write_shift(4,p),R.write_shift(1,P[x]||i[S[x]]||0),R.write_shift(1,L[x]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),p+=P[x]||i[S[x]]||0}var be=u.next(264);for(be.write_shift(4,13),x=0;x<65;++x)be.write_shift(4,0);for(x=0;x<f.length;++x){var he=u.next(b);for(he.write_shift(1,0),p=0;p<m.length;++p)if(m[p]!=null)switch(S[p]){case"L":he.write_shift(1,f[x][p]==null?63:f[x][p]?84:70);break;case"B":he.write_shift(8,f[x][p]||0,"f");break;case"N":var je="0";for(typeof f[x][p]=="number"&&(je=f[x][p].toFixed(L[p]||0)),w=0;w<P[p]-je.length;++w)he.write_shift(1,32);he.write_shift(1,je,"sbcs");break;case"D":f[x][p]?(he.write_shift(4,("0000"+f[x][p].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(f[x][p].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+f[x][p].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var le=String(f[x][p]!=null?f[x][p]:"").slice(0,P[p]);for(he.write_shift(1,le,"sbcs"),w=0;w<P[p]-le.length;++w)he.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:n,to_sheet:s,from_sheet:o}})(),Yh=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+xr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,f){var g=e[f];return typeof g=="number"?Vi(g):g},s=function(m,f,g){var x=f.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return x==59?m:Vi(x)};e["|"]=254;function n(m,f){switch(f.type){case"base64":return i(xt(m),f);case"binary":return i(m,f);case"buffer":return i(Me&&Buffer.isBuffer(m)?m.toString("binary"):Ka(m),f);case"array":return i(Ys(m),f)}throw new Error("Unrecognized type "+f.type)}function i(m,f){var g=m.split(/[\n\r]+/),x=-1,p=-1,w=0,b=0,y=[],S=[],P=null,L={},I=[],H=[],W=[],J=0,ee;for(+f.codepage>=0&&Wa(+f.codepage);w!==g.length;++w){J=0;var R=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),q=R.replace(/;;/g,"\0").split(";").map(function(_){return _.replace(/\u0000/g,";")}),be=q[0],he;if(R.length>0)switch(be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&S.push(R.slice(3).replace(/;;/g,";"));break;case"C":var je=!1,le=!1,M=!1,ie=!1,B=-1,ne=-1;for(b=1;b<q.length;++b)switch(q[b].charAt(0)){case"A":break;case"X":p=parseInt(q[b].slice(1))-1,le=!0;break;case"Y":for(x=parseInt(q[b].slice(1))-1,le||(p=0),ee=y.length;ee<=x;++ee)y[ee]=[];break;case"K":he=q[b].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(ut(he))?isNaN($a(he).getDate())||(he=_r(he)):(he=ut(he),P!==null&&fl(P)&&(he=pl(he))),je=!0;break;case"E":ie=!0;var C=Vx(q[b].slice(1),{r:x,c:p});y[x][p]=[y[x][p],C];break;case"S":M=!0,y[x][p]=[y[x][p],"S5S"];break;case"G":break;case"R":B=parseInt(q[b].slice(1))-1;break;case"C":ne=parseInt(q[b].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+R)}if(je&&(y[x][p]&&y[x][p].length==2?y[x][p][0]=he:y[x][p]=he,P=null),M){if(ie)throw new Error("SYLK shared formula cannot have own formula");var A=B>-1&&y[B][ne];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");y[x][p][1]=Gx(A[1],{r:x-B,c:p-ne})}break;case"F":var N=0;for(b=1;b<q.length;++b)switch(q[b].charAt(0)){case"X":p=parseInt(q[b].slice(1))-1,++N;break;case"Y":for(x=parseInt(q[b].slice(1))-1,ee=y.length;ee<=x;++ee)y[ee]=[];break;case"M":J=parseInt(q[b].slice(1))/20;break;case"F":break;case"G":break;case"P":P=S[parseInt(q[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(W=q[b].slice(1).split(" "),ee=parseInt(W[0],10);ee<=parseInt(W[1],10);++ee)J=parseInt(W[2],10),H[ee-1]=J===0?{hidden:!0}:{wch:J},ai(H[ee-1]);break;case"C":p=parseInt(q[b].slice(1))-1,H[p]||(H[p]={});break;case"R":x=parseInt(q[b].slice(1))-1,I[x]||(I[x]={}),J>0?(I[x].hpt=J,I[x].hpx=a0(J)):J===0&&(I[x].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+R)}N<1&&(P=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+R)}}return I.length>0&&(L["!rows"]=I),H.length>0&&(L["!cols"]=H),f&&f.sheetRows&&(y=y.slice(0,f.sheetRows)),[y,L]}function o(m,f){var g=n(m,f),x=g[0],p=g[1],w=ma(x,f);return xr(p).forEach(function(b){w[b]=p[b]}),w}function l(m,f){return Ht(o(m,f),f)}function d(m,f,g,x){var p="C;Y"+(g+1)+";X"+(x+1)+";K";switch(m.t){case"n":p+=m.v||0,m.f&&!m.F&&(p+=";E"+ni(m.f,{r:g,c:x}));break;case"b":p+=m.v?"TRUE":"FALSE";break;case"e":p+=m.w||m.v;break;case"d":p+='"'+(m.w||m.v)+'"';break;case"s":p+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return p}function c(m,f){f.forEach(function(g,x){var p="F;W"+(x+1)+" "+(x+1)+" ";g.hidden?p+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Ms(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Is(g.wpx)),typeof g.wch=="number"&&(p+=Math.round(g.wch))),p.charAt(p.length-1)!=" "&&m.push(p)})}function u(m,f){f.forEach(function(g,x){var p="F;";g.hidden?p+="M0;":g.hpt?p+="M"+20*g.hpt+";":g.hpx&&(p+="M"+20*Rs(g.hpx)+";"),p.length>2&&m.push(p+"R"+(x+1))})}function h(m,f){var g=["ID;PWXL;N;E"],x=[],p=Ve(m["!ref"]),w,b=Array.isArray(m),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&c(g,m["!cols"]),m["!rows"]&&u(g,m["!rows"]),g.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var S=p.s.r;S<=p.e.r;++S)for(var P=p.s.c;P<=p.e.c;++P){var L=Ue({r:S,c:P});w=b?(m[S]||[])[P]:m[L],!(!w||w.v==null&&(!w.f||w.F))&&x.push(d(w,m,S,P))}return g.join(y)+y+x.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:o,from_sheet:h}})(),Xh=(function(){function e(i,o){switch(o.type){case"base64":return t(xt(i),o);case"binary":return t(i,o);case"buffer":return t(Me&&Buffer.isBuffer(i)?i.toString("binary"):Ka(i),o);case"array":return t(Ys(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),d=-1,c=-1,u=0,h=[];u!==l.length;++u){if(l[u].trim()==="BOT"){h[++d]=[],c=0;continue}if(!(d<0)){var m=l[u].trim().split(","),f=m[0],g=m[1];++u;for(var x=l[u]||"";(x.match(/["]/g)||[]).length&1&&u<l.length-1;)x+=`
`+l[++u];switch(x=x.trim(),+f){case-1:if(x==="BOT"){h[++d]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[d][c]=!0:x==="FALSE"?h[d][c]=!1:isNaN(ut(g))?isNaN($a(g).getDate())?h[d][c]=g:h[d][c]=_r(g):h[d][c]=ut(g),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[d][c++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(i,o){return ma(e(i,o),o)}function s(i,o){return Ht(r(i,o),o)}var n=(function(){var i=function(d,c,u,h,m){d.push(c),d.push(u+","+h),d.push('"'+m.replace(/"/g,'""')+'"')},o=function(d,c,u,h){d.push(c+","+u),d.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(d){var c=[],u=Ve(d["!ref"]),h,m=Array.isArray(d);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var f=u.s.r;f<=u.e.r;++f){o(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var x=Ue({r:f,c:g});if(h=m?(d[f]||[])[g]:d[x],!h){o(c,1,0,"");continue}switch(h.t){case"n":var p=h.w;!p&&h.v!=null&&(p=h.v),p==null?h.f&&!h.F?o(c,1,0,"="+h.f):o(c,1,0,""):o(c,0,p,"V");break;case"b":o(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=kt(h.z||Qe[14],Dr(_r(h.v)))),o(c,0,h.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var w=`\r
`,b=c.join(w);return b}})();return{to_workbook:s,to_sheet:r,from_sheet:n}})(),Zl=(function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var f=h.split(`
`),g=-1,x=-1,p=0,w=[];p!==f.length;++p){var b=f[p].trim().split(":");if(b[0]==="cell"){var y=or(b[1]);if(w.length<=y.r)for(g=w.length;g<=y.r;++g)w[g]||(w[g]=[]);switch(g=y.r,x=y.c,b[2]){case"t":w[g][x]=e(b[3]);break;case"v":w[g][x]=+b[3];break;case"vtf":var S=b[b.length-1];case"vtc":switch(b[3]){case"nl":w[g][x]=!!+b[4];break;default:w[g][x]=+b[4];break}b[2]=="vtf"&&(w[g][x]=[w[g][x],S])}}}return m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),w}function s(h,m){return ma(r(h,m),m)}function n(h,m){return Ht(s(h,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var m=[],f=[],g,x="",p=Br(h["!ref"]),w=Array.isArray(h),b=p.s.r;b<=p.e.r;++b)for(var y=p.s.c;y<=p.e.c;++y)if(x=Ue({r:b,c:y}),g=w?(h[b]||[])[y]:h[x],!(!g||g.v==null||g.t==="z")){switch(f=["cell",x,"t"],g.t){case"s":case"str":f.push(t(g.v));break;case"n":g.f?(f[2]="vtf",f[3]="n",f[4]=g.v,f[5]=t(g.f)):(f[2]="v",f[3]=g.v);break;case"b":f[2]="vt"+(g.f?"f":"c"),f[3]="nl",f[4]=g.v?"1":"0",f[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var S=Dr(_r(g.v));f[2]="vtc",f[3]="nd",f[4]=""+S,f[5]=g.w||kt(g.z||Qe[14],S);break;case"e":continue}m.push(f.join(":"))}return m.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(h){return[i,o,l,o,c(h),d].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:u}})(),qh=(function(){function e(u,h,m,f,g){g.raw?h[m][f]=u:u===""||(u==="TRUE"?h[m][f]=!0:u==="FALSE"?h[m][f]=!1:isNaN(ut(u))?isNaN($a(u).getDate())?h[m][f]=u:h[m][f]=_r(u):h[m][f]=ut(u))}function t(u,h){var m=h||{},f=[];if(!u||u.length===0)return f;for(var g=u.split(/[\r\n]/),x=g.length-1;x>=0&&g[x].length===0;)--x;for(var p=10,w=0,b=0;b<=x;++b)w=g[b].indexOf(" "),w==-1?w=g[b].length:w++,p=Math.max(p,w);for(b=0;b<=x;++b){f[b]=[];var y=0;for(e(g[b].slice(0,p).trim(),f,b,y,m),y=1;y<=(g[b].length-p)/10+1;++y)e(g[b].slice(p+(y-1)*10,p+y*10).trim(),f,b,y,m)}return m.sheetRows&&(f=f.slice(0,m.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(u){for(var h={},m=!1,f=0,g=0;f<u.length;++f)(g=u.charCodeAt(f))==34?m=!m:!m&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&g.push([h[f],f]);if(!g.length){h=s;for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&g.push([h[f],f])}return g.sort(function(x,p){return x[0]-p[0]||s[x[1]]-s[p[1]]}),r[g.pop()[1]]||44}function i(u,h){var m=h||{},f="",g=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(f=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(f=u.charAt(4),u=u.slice(6)):f=n(u.slice(0,1024)):m&&m.FS?f=m.FS:f=n(u.slice(0,1024));var p=0,w=0,b=0,y=0,S=0,P=f.charCodeAt(0),L=!1,I=0,H=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var W=m.dateNF!=null?uf(m.dateNF):null;function J(){var ee=u.slice(y,S),R={};if(ee.charAt(0)=='"'&&ee.charAt(ee.length-1)=='"'&&(ee=ee.slice(1,-1).replace(/""/g,'"')),ee.length===0)R.t="z";else if(m.raw)R.t="s",R.v=ee;else if(ee.trim().length===0)R.t="s",R.v=ee;else if(ee.charCodeAt(0)==61)ee.charCodeAt(1)==34&&ee.charCodeAt(ee.length-1)==34?(R.t="s",R.v=ee.slice(2,-1).replace(/""/g,'"')):Yx(ee)?(R.t="n",R.f=ee.slice(1)):(R.t="s",R.v=ee);else if(ee=="TRUE")R.t="b",R.v=!0;else if(ee=="FALSE")R.t="b",R.v=!1;else if(!isNaN(b=ut(ee)))R.t="n",m.cellText!==!1&&(R.w=ee),R.v=b;else if(!isNaN($a(ee).getDate())||W&&ee.match(W)){R.z=m.dateNF||Qe[14];var q=0;W&&ee.match(W)&&(ee=ff(ee,m.dateNF,ee.match(W)||[]),q=1),m.cellDates?(R.t="d",R.v=_r(ee,q)):(R.t="n",R.v=Dr(_r(ee,q))),m.cellText!==!1&&(R.w=kt(R.z,R.v instanceof Date?Dr(R.v):R.v)),m.cellNF||delete R.z}else R.t="s",R.v=ee;if(R.t=="z"||(m.dense?(g[p]||(g[p]=[]),g[p][w]=R):g[Ue({c:w,r:p})]=R),y=S+1,H=u.charCodeAt(y),x.e.c<w&&(x.e.c=w),x.e.r<p&&(x.e.r=p),I==P)++w;else if(w=0,++p,m.sheetRows&&m.sheetRows<=p)return!0}e:for(;S<u.length;++S)switch(I=u.charCodeAt(S)){case 34:H===34&&(L=!L);break;case P:case 10:case 13:if(!L&&J())break e;break}return S-y>0&&J(),g["!ref"]=tr(x),g}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,h):ma(t(u,h),h)}function l(u,h){var m="",f=h.type=="string"?[0,0,0,0]:ov(u,h);switch(h.type){case"base64":m=xt(u);break;case"binary":m=u;break;case"buffer":h.codepage==65001?m=u.toString("utf8"):h.codepage&&typeof Ss!="undefined"||(m=Me&&Buffer.isBuffer(u)?u.toString("binary"):Ka(u));break;case"array":m=Ys(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+h.type)}return f[0]==239&&f[1]==187&&f[2]==191?m=Fa(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=Fa(m):h.type=="binary",m.slice(0,19)=="socialcalc:version:"?Zl.to_sheet(h.type=="string"?m:Fa(m),h):o(m,h)}function d(u,h){return Ht(l(u,h),h)}function c(u){for(var h=[],m=Ve(u["!ref"]),f,g=Array.isArray(u),x=m.s.r;x<=m.e.r;++x){for(var p=[],w=m.s.c;w<=m.e.c;++w){var b=Ue({r:x,c:w});if(f=g?(u[x]||[])[w]:u[b],!f||f.v==null){p.push("          ");continue}for(var y=(f.w||(mt(f),f.w)||"").slice(0,10);y.length<10;)y+=" ";p.push(y+(w===0?" ":""))}h.push(p.join(""))}return h.join(`
`)}return{to_workbook:d,to_sheet:l,from_sheet:c}})(),jo=(function(){function e(C,A,N){if(C){Mr(C,C.l||0);for(var _=N.Enum||B;C.l<C.length;){var U=C.read_shift(2),re=_[U]||_[65535],z=C.read_shift(2),K=C.l+z,Z=re.f&&re.f(C,z,N);if(C.l=K,A(Z,re,U))return}}}function t(C,A){switch(A.type){case"base64":return r(Gr(xt(C)),A);case"binary":return r(Gr(C),A);case"buffer":case"array":return r(C,A)}throw"Unsupported type "+A.type}function r(C,A){if(!C)return C;var N=A||{},_=N.dense?[]:{},U="Sheet1",re="",z=0,K={},Z=[],de=[],ge={s:{r:0,c:0},e:{r:0,c:0}},Se=N.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)N.Enum=B,e(C,function(D,ae,_e){switch(_e){case 0:N.vers=D,D>=4096&&(N.qpro=!0);break;case 6:ge=D;break;case 204:D&&(re=D);break;case 222:re=D;break;case 15:case 51:N.qpro||(D[1].v=D[1].v.slice(1));case 13:case 14:case 16:_e==14&&(D[2]&112)==112&&(D[2]&15)>1&&(D[2]&15)<15&&(D[1].z=N.dateNF||Qe[14],N.cellDates&&(D[1].t="d",D[1].v=pl(D[1].v))),N.qpro&&D[3]>z&&(_["!ref"]=tr(ge),K[U]=_,Z.push(U),_=N.dense?[]:{},ge={s:{r:0,c:0},e:{r:0,c:0}},z=D[3],U=re||"Sheet"+(z+1),re="");var Pe=N.dense?(_[D[0].r]||[])[D[0].c]:_[Ue(D[0])];if(Pe){Pe.t=D[1].t,Pe.v=D[1].v,D[1].z!=null&&(Pe.z=D[1].z),D[1].f!=null&&(Pe.f=D[1].f);break}N.dense?(_[D[0].r]||(_[D[0].r]=[]),_[D[0].r][D[0].c]=D[1]):_[Ue(D[0])]=D[1];break}},N);else if(C[2]==26||C[2]==14)N.Enum=ne,C[2]==14&&(N.qpro=!0,C.l=0),e(C,function(D,ae,_e){switch(_e){case 204:U=D;break;case 22:D[1].v=D[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(D[3]>z&&(_["!ref"]=tr(ge),K[U]=_,Z.push(U),_=N.dense?[]:{},ge={s:{r:0,c:0},e:{r:0,c:0}},z=D[3],U="Sheet"+(z+1)),Se>0&&D[0].r>=Se)break;N.dense?(_[D[0].r]||(_[D[0].r]=[]),_[D[0].r][D[0].c]=D[1]):_[Ue(D[0])]=D[1],ge.e.c<D[0].c&&(ge.e.c=D[0].c),ge.e.r<D[0].r&&(ge.e.r=D[0].r);break;case 27:D[14e3]&&(de[D[14e3][0]]=D[14e3][1]);break;case 1537:de[D[0]]=D[1],D[0]==z&&(U=D[1]);break}},N);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(_["!ref"]=tr(ge),K[re||U]=_,Z.push(re||U),!de.length)return{SheetNames:Z,Sheets:K};for(var Ne={},Q=[],ce=0;ce<de.length;++ce)K[Z[ce]]?(Q.push(de[ce]||Z[ce]),Ne[de[ce]]=K[de[ce]]||K[Z[ce]]):(Q.push(de[ce]),Ne[de[ce]]={"!ref":"A1"});return{SheetNames:Q,Sheets:Ne}}function s(C,A){var N=A||{};if(+N.codepage>=0&&Wa(+N.codepage),N.type=="string")throw new Error("Cannot write WK1 to JS string");var _=Ar(),U=Ve(C["!ref"]),re=Array.isArray(C),z=[];me(_,0,i(1030)),me(_,6,d(U));for(var K=Math.min(U.e.r,8191),Z=U.s.r;Z<=K;++Z)for(var de=hr(Z),ge=U.s.c;ge<=U.e.c;++ge){Z===U.s.r&&(z[ge]=pr(ge));var Se=z[ge]+de,Ne=re?(C[Z]||[])[ge]:C[Se];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")(Ne.v|0)==Ne.v&&Ne.v>=-32768&&Ne.v<=32767?me(_,13,f(Z,ge,Ne.v)):me(_,14,x(Z,ge,Ne.v));else{var Q=mt(Ne);me(_,15,h(Z,ge,Q.slice(0,239)))}}return me(_,1),_.end()}function n(C,A){var N=A||{};if(+N.codepage>=0&&Wa(+N.codepage),N.type=="string")throw new Error("Cannot write WK3 to JS string");var _=Ar();me(_,0,o(C));for(var U=0,re=0;U<C.SheetNames.length;++U)(C.Sheets[C.SheetNames[U]]||{})["!ref"]&&me(_,27,ie(C.SheetNames[U],re++));var z=0;for(U=0;U<C.SheetNames.length;++U){var K=C.Sheets[C.SheetNames[U]];if(!(!K||!K["!ref"])){for(var Z=Ve(K["!ref"]),de=Array.isArray(K),ge=[],Se=Math.min(Z.e.r,8191),Ne=Z.s.r;Ne<=Se;++Ne)for(var Q=hr(Ne),ce=Z.s.c;ce<=Z.e.c;++ce){Ne===Z.s.r&&(ge[ce]=pr(ce));var D=ge[ce]+Q,ae=de?(K[Ne]||[])[ce]:K[D];if(!(!ae||ae.t=="z"))if(ae.t=="n")me(_,23,J(Ne,ce,z,ae.v));else{var _e=mt(ae);me(_,22,I(Ne,ce,z,_e.slice(0,239)))}}++z}}return me(_,1),_.end()}function i(C){var A=te(2);return A.write_shift(2,C),A}function o(C){var A=te(26);A.write_shift(2,4096),A.write_shift(2,4),A.write_shift(4,0);for(var N=0,_=0,U=0,re=0;re<C.SheetNames.length;++re){var z=C.SheetNames[re],K=C.Sheets[z];if(!(!K||!K["!ref"])){++U;var Z=Br(K["!ref"]);N<Z.e.r&&(N=Z.e.r),_<Z.e.c&&(_=Z.e.c)}}return N>8191&&(N=8191),A.write_shift(2,N),A.write_shift(1,U),A.write_shift(1,_),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(1,1),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(4,0),A}function l(C,A,N){var _={s:{c:0,r:0},e:{c:0,r:0}};return A==8&&N.qpro?(_.s.c=C.read_shift(1),C.l++,_.s.r=C.read_shift(2),_.e.c=C.read_shift(1),C.l++,_.e.r=C.read_shift(2),_):(_.s.c=C.read_shift(2),_.s.r=C.read_shift(2),A==12&&N.qpro&&(C.l+=2),_.e.c=C.read_shift(2),_.e.r=C.read_shift(2),A==12&&N.qpro&&(C.l+=2),_.s.c==65535&&(_.s.c=_.e.c=_.s.r=_.e.r=0),_)}function d(C){var A=te(8);return A.write_shift(2,C.s.c),A.write_shift(2,C.s.r),A.write_shift(2,C.e.c),A.write_shift(2,C.e.r),A}function c(C,A,N){var _=[{c:0,r:0},{t:"n",v:0},0,0];return N.qpro&&N.vers!=20768?(_[0].c=C.read_shift(1),_[3]=C.read_shift(1),_[0].r=C.read_shift(2),C.l+=2):(_[2]=C.read_shift(1),_[0].c=C.read_shift(2),_[0].r=C.read_shift(2)),_}function u(C,A,N){var _=C.l+A,U=c(C,A,N);if(U[1].t="s",N.vers==20768){C.l++;var re=C.read_shift(1);return U[1].v=C.read_shift(re,"utf8"),U}return N.qpro&&C.l++,U[1].v=C.read_shift(_-C.l,"cstr"),U}function h(C,A,N){var _=te(7+N.length);_.write_shift(1,255),_.write_shift(2,A),_.write_shift(2,C),_.write_shift(1,39);for(var U=0;U<_.length;++U){var re=N.charCodeAt(U);_.write_shift(1,re>=128?95:re)}return _.write_shift(1,0),_}function m(C,A,N){var _=c(C,A,N);return _[1].v=C.read_shift(2,"i"),_}function f(C,A,N){var _=te(7);return _.write_shift(1,255),_.write_shift(2,A),_.write_shift(2,C),_.write_shift(2,N,"i"),_}function g(C,A,N){var _=c(C,A,N);return _[1].v=C.read_shift(8,"f"),_}function x(C,A,N){var _=te(13);return _.write_shift(1,255),_.write_shift(2,A),_.write_shift(2,C),_.write_shift(8,N,"f"),_}function p(C,A,N){var _=C.l+A,U=c(C,A,N);if(U[1].v=C.read_shift(8,"f"),N.qpro)C.l=_;else{var re=C.read_shift(2);S(C.slice(C.l,C.l+re),U),C.l+=re}return U}function w(C,A,N){var _=A&32768;return A&=-32769,A=(_?C:0)+(A>=8192?A-16384:A),(_?"":"$")+(N?pr(A):hr(A))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(C,A){Mr(C,0);for(var N=[],_=0,U="",re="",z="",K="";C.l<C.length;){var Z=C[C.l++];switch(Z){case 0:N.push(C.read_shift(8,"f"));break;case 1:re=w(A[0].c,C.read_shift(2),!0),U=w(A[0].r,C.read_shift(2),!1),N.push(re+U);break;case 2:{var de=w(A[0].c,C.read_shift(2),!0),ge=w(A[0].r,C.read_shift(2),!1);re=w(A[0].c,C.read_shift(2),!0),U=w(A[0].r,C.read_shift(2),!1),N.push(de+ge+":"+re+U)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:N.push("("+N.pop()+")");break;case 5:N.push(C.read_shift(2));break;case 6:{for(var Se="";Z=C[C.l++];)Se+=String.fromCharCode(Z);N.push('"'+Se.replace(/"/g,'""')+'"')}break;case 8:N.push("-"+N.pop());break;case 23:N.push("+"+N.pop());break;case 22:N.push("NOT("+N.pop()+")");break;case 20:case 21:K=N.pop(),z=N.pop(),N.push(["AND","OR"][Z-20]+"("+z+","+K+")");break;default:if(Z<32&&y[Z])K=N.pop(),z=N.pop(),N.push(z+y[Z]+K);else if(b[Z]){if(_=b[Z][1],_==69&&(_=C[C.l++]),_>N.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+N.join("|")+"|");return}var Ne=N.slice(-_);N.length-=_,N.push(b[Z][0]+"("+Ne.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}N.length==1?A[1].f=""+N[0]:console.error("WK1 bad formula parse |"+N.join("|")+"|")}function P(C){var A=[{c:0,r:0},{t:"n",v:0},0];return A[0].r=C.read_shift(2),A[3]=C[C.l++],A[0].c=C[C.l++],A}function L(C,A){var N=P(C);return N[1].t="s",N[1].v=C.read_shift(A-4,"cstr"),N}function I(C,A,N,_){var U=te(6+_.length);U.write_shift(2,C),U.write_shift(1,N),U.write_shift(1,A),U.write_shift(1,39);for(var re=0;re<_.length;++re){var z=_.charCodeAt(re);U.write_shift(1,z>=128?95:z)}return U.write_shift(1,0),U}function H(C,A){var N=P(C);N[1].v=C.read_shift(2);var _=N[1].v>>1;if(N[1].v&1)switch(_&7){case 0:_=(_>>3)*5e3;break;case 1:_=(_>>3)*500;break;case 2:_=(_>>3)/20;break;case 3:_=(_>>3)/200;break;case 4:_=(_>>3)/2e3;break;case 5:_=(_>>3)/2e4;break;case 6:_=(_>>3)/16;break;case 7:_=(_>>3)/64;break}return N[1].v=_,N}function W(C,A){var N=P(C),_=C.read_shift(4),U=C.read_shift(4),re=C.read_shift(2);if(re==65535)return _===0&&U===3221225472?(N[1].t="e",N[1].v=15):_===0&&U===3489660928?(N[1].t="e",N[1].v=42):N[1].v=0,N;var z=re&32768;return re=(re&32767)-16446,N[1].v=(1-z*2)*(U*Math.pow(2,re+32)+_*Math.pow(2,re)),N}function J(C,A,N,_){var U=te(14);if(U.write_shift(2,C),U.write_shift(1,N),U.write_shift(1,A),_==0)return U.write_shift(4,0),U.write_shift(4,0),U.write_shift(2,65535),U;var re=0,z=0,K=0,Z=0;return _<0&&(re=1,_=-_),z=Math.log2(_)|0,_/=Math.pow(2,z-31),Z=_>>>0,(Z&2147483648)==0&&(_/=2,++z,Z=_>>>0),_-=Z,Z|=2147483648,Z>>>=0,_*=Math.pow(2,32),K=_>>>0,U.write_shift(4,K),U.write_shift(4,Z),z+=16383+(re?32768:0),U.write_shift(2,z),U}function ee(C,A){var N=W(C);return C.l+=A-14,N}function R(C,A){var N=P(C),_=C.read_shift(4);return N[1].v=_>>6,N}function q(C,A){var N=P(C),_=C.read_shift(8,"f");return N[1].v=_,N}function be(C,A){var N=q(C);return C.l+=A-10,N}function he(C,A){return C[C.l+A-1]==0?C.read_shift(A,"cstr"):""}function je(C,A){var N=C[C.l++];N>A-1&&(N=A-1);for(var _="";_.length<N;)_+=String.fromCharCode(C[C.l++]);return _}function le(C,A,N){if(!(!N.qpro||A<21)){var _=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var U=C.read_shift(A-21,"cstr");return[_,U]}}function M(C,A){for(var N={},_=C.l+A;C.l<_;){var U=C.read_shift(2);if(U==14e3){for(N[U]=[0,""],N[U][0]=C.read_shift(2);C[C.l];)N[U][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return N}function ie(C,A){var N=te(5+C.length);N.write_shift(2,14e3),N.write_shift(2,A);for(var _=0;_<C.length;++_){var U=C.charCodeAt(_);N[N.l++]=U>127?95:U}return N[N.l++]=0,N}var B={0:{n:"BOF",f:Xl},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:p},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:je},65535:{n:""}},ne={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:W},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:ee},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:M},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}})(),Kh=/^\s|\s$|[\t\n\r]/;function e0(e,t){if(!t.bookSST)return"";var r=[ar];r[r.length]=xe("sst",null,{xmlns:xa[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var n=e[s],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(Kh)&&(i+=' xml:space="preserve"'),i+=">"+We(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Jh(e){return[e.read_shift(4),e.read_shift(4)]}function Qh(e,t){return t||(t=te(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Zh=zf;function ex(e){var t=Ar();oe(t,159,Qh(e));for(var r=0;r<e.length;++r)oe(t,19,Zh(e[r]));return oe(t,160),t.end()}function rx(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function r0(e){var t=0,r,s=rx(e),n=s.length+1,i,o,l,d,c;for(r=Ut(n),r[0]=s.length,i=1;i!=n;++i)r[i]=s[i-1];for(i=n-1;i>=0;--i)o=r[i],l=(t&16384)===0?0:1,d=t<<1&32767,c=l|d,t=c^o;return t^52811}var tx=(function(){function e(n,i){switch(i.type){case"base64":return t(xt(n),i);case"binary":return t(n,i);case"buffer":return t(Me&&Buffer.isBuffer(n)?n.toString("binary"):Ka(n),i);case"array":return t(Ys(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var o=i||{},l=o.dense?[]:{},d=n.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(u,h){Array.isArray(l)&&(l[h]=[]);for(var m=/\\\w+\b/g,f=0,g,x=-1;g=m.exec(u);){switch(g[0]){case"\\cell":var p=u.slice(f,m.lastIndex-g[0].length);if(p[0]==" "&&(p=p.slice(1)),++x,p.length){var w={v:p,t:"s"};Array.isArray(l)?l[h][x]=w:l[Ue({r:h,c:x})]=w}break}f=m.lastIndex}x>c.e.c&&(c.e.c=x)}),l["!ref"]=tr(c),l}function r(n,i){return Ht(e(n,i),i)}function s(n){for(var i=["{\\rtf1\\ansi"],o=Ve(n["!ref"]),l,d=Array.isArray(n),c=o.s.r;c<=o.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=Ue({r:c,c:u});l=d?(n[c]||[])[u]:n[h],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(mt(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}})();function _o(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var ax=6,ft=ax;function Ms(e){return Math.floor((e+Math.round(128/ft)/256)*ft)}function Is(e){return Math.floor((e-5)/ft*100+.5)/100}function kn(e){return Math.round((e*ft+5)/ft*256)/256}function ai(e){e.width?(e.wpx=Ms(e.width),e.wch=Is(e.wpx),e.MDW=ft):e.wpx?(e.wch=Is(e.wpx),e.width=kn(e.wch),e.MDW=ft):typeof e.wch=="number"&&(e.width=kn(e.wch),e.wpx=Ms(e.width),e.MDW=ft),e.customWidth&&delete e.customWidth}var sx=96,t0=sx;function Rs(e){return e*96/t0}function a0(e){return e*t0/96}function nx(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=xe("numFmt",null,{numFmtId:s,formatCode:We(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=xe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function ix(e){var t=[];return t[t.length]=xe("cellXfs",null),e.forEach(function(r){t[t.length]=xe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=xe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function s0(e,t){var r=[ar,xe("styleSheet",null,{xmlns:xa[0],"xmlns:vt":ir.vt})],s;return e.SSF&&(s=nx(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=ix(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ox(e,t){var r=e.read_shift(2),s=gr(e);return[r,s]}function lx(e,t,r){r||(r=te(6+4*t.length)),r.write_shift(2,e),lr(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function cx(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=Kf(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var i=e.read_shift(2);switch(i===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(s.underline=o);var l=e.read_shift(1);l>0&&(s.family=l);var d=e.read_shift(1);switch(d>0&&(s.charset=d),e.l++,s.color=qf(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=gr(e),s}function dx(e,t){t||(t=te(153)),t.write_shift(2,e.sz*20),Jf(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ps(e.color,t);var s=0;return s=2,t.write_shift(1,s),lr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var ux=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],fn,fx=nt;function Eo(e,t){t||(t=te(84)),fn||(fn=Vn(ux));var r=fn[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(Ps({auto:1},t),Ps({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function hx(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}function n0(e,t,r){r||(r=te(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function _a(e,t){return t||(t=te(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var xx=nt;function mx(e,t){return t||(t=te(51)),t.write_shift(1,0),_a(null,t),_a(null,t),_a(null,t),_a(null,t),_a(null,t),t.length>t.l?t.slice(0,t.l):t}function px(e,t){return t||(t=te(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Fs(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function gx(e,t,r){var s=te(2052);return s.write_shift(4,e),Fs(t,s),Fs(r,s),s.length>s.l?s.slice(0,s.l):s}function vx(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&++r}),r!=0&&(oe(e,615,Xr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&oe(e,44,lx(n,t[n]))}),oe(e,616))}}function bx(e){var t=1;oe(e,611,Xr(t)),oe(e,43,dx({sz:12,color:{theme:1},name:"Calibri",family:2})),oe(e,612)}function wx(e){var t=2;oe(e,603,Xr(t)),oe(e,45,Eo({patternType:"none"})),oe(e,45,Eo({patternType:"gray125"})),oe(e,604)}function yx(e){var t=1;oe(e,613,Xr(t)),oe(e,46,mx()),oe(e,614)}function Nx(e){var t=1;oe(e,626,Xr(t)),oe(e,47,n0({numFmtId:0},65535)),oe(e,627)}function jx(e,t){oe(e,617,Xr(t.length)),t.forEach(function(r){oe(e,47,n0(r,0))}),oe(e,618)}function _x(e){var t=1;oe(e,619,Xr(t)),oe(e,48,px({xfId:0,name:"Normal"})),oe(e,620)}function Ex(e){var t=0;oe(e,505,Xr(t)),oe(e,506)}function Sx(e){var t=0;oe(e,508,gx(t,"TableStyleMedium9","PivotStyleMedium4")),oe(e,509)}function kx(e,t){var r=Ar();return oe(r,278),vx(r,e.SSF),bx(r),wx(r),yx(r),Nx(r),jx(r,t.cellXfs),_x(r),Ex(r),Sx(r),oe(r,279),r.end()}function i0(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ar];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Tx(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:gr(e)}}function Cx(e){var t=te(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),lr(e.name,t),t.slice(0,t.l)}function Ax(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Dx(e){var t=te(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Fx(e,t){var r=te(8+2*t.length);return r.write_shift(4,e),lr(t,r),r.slice(0,r.l)}function Px(e){return e.l+=4,e.read_shift(4)!=0}function Ox(e,t){var r=te(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Mx(){var e=Ar();return oe(e,332),oe(e,334,Xr(1)),oe(e,335,Cx({name:"XLDAPR",version:12e4,flags:3496657072})),oe(e,336),oe(e,339,Fx(1,"XLDAPR")),oe(e,52),oe(e,35,Xr(514)),oe(e,4096,Xr(0)),oe(e,4097,$r(1)),oe(e,36),oe(e,53),oe(e,340),oe(e,337,Ox(1)),oe(e,51,Dx([[1,0]])),oe(e,338),oe(e,333),e.end()}function o0(){var e=[ar];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Ix(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ue(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}var sa=1024;function l0(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[xe("xml",null,{"xmlns:v":Ir.v,"xmlns:o":Ir.o,"xmlns:x":Ir.x,"xmlns:mv":Ir.mv}).replace(/\/>/,">"),xe("o:shapelayout",xe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),xe("v:shapetype",[xe("v:stroke",null,{joinstyle:"miter"}),xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];sa<e*1e3;)sa+=1e3;return t.forEach(function(i){var o=or(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var d=l.type=="gradient"?xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=xe("v:fill",d,l),u={on:"t",obscured:"t"};++sa,n=n.concat(["<v:shape"+Ha({id:"_x0000_s"+sa,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,xe("v:shadow",null,u),xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",fr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),fr("x:AutoFill","False"),fr("x:Row",String(o.r)),fr("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function c0(e){var t=[ar,xe("comments",null,{xmlns:xa[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(n){var i=We(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var n=0,i=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(d){d.a&&(n=r.indexOf(We(d.a))),i.push(d.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(fr("t",We(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(fr("t",We(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Rx(e,t,r){var s=[ar,xe("ThreadedComments",null,{xmlns:ir.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var d={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=d.id:d.parentId=i,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),s.push(xe("threadedComment",fr("text",o.t||""),d))})}),s.push("</ThreadedComments>"),s.join("")}function Lx(e){var t=[ar,xe("personList",null,{xmlns:ir.TCMNT,"xmlns:x":xa[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(xe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Bx(e){var t={};t.iauthor=e.read_shift(4);var r=Xt(e);return t.rfx=r.s,t.ref=Ue(r.s),e.l+=16,t}function Wx(e,t){return t==null&&(t=te(36)),t.write_shift(4,e[1].iauthor),pa(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Ux=gr;function $x(e){return lr(e.slice(0,54))}function zx(e){var t=Ar(),r=[];return oe(t,628),oe(t,630),e.forEach(function(s){s[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),oe(t,632,$x(n.a)))})}),oe(t,631),oe(t,633),e.forEach(function(s){s[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:or(s[0]),e:or(s[0])};oe(t,635,Wx([i,n])),n.t&&n.t.length>0&&oe(t,637,Vf(n)),oe(t,636),delete n.iauthor})}),oe(t,634),oe(t,629),t.end()}function Hx(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&$e.utils.cfb_add(e,n,t.FileIndex[s].content)}})}var d0=["xlsb","xlsm","xlam","biff8","xla"],Vx=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,i,o){var l=!1,d=!1;i.length==0?d=!0:i.charAt(0)=="["&&(d=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,d?c+=t.r:--c,n+(l?"":"$")+pr(u)+(d?"":"$")+hr(c)}return function(n,i){return t=i,n.replace(e,r)}})(),si=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ni=(function(){return function(t,r){return t.replace(si,function(s,n,i,o,l,d){var c=Qn(o)-(i?0:r.c),u=Jn(d)-(l?0:r.r),h=u==0?"":l?u+1:"["+u+"]",m=c==0?"":i?c+1:"["+c+"]";return n+"R"+h+"C"+m})}})();function Gx(e,t){return e.replace(si,function(r,s,n,i,o,l){return s+(n=="$"?n+i:pr(Qn(i)+t.c))+(o=="$"?o+l:hr(Jn(l)+t.r))})}function Yx(e){return e.length!=1}function rr(e){e.l+=1}function Tt(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function u0(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return f0(e);r.biff==12&&(s=4)}var n=e.read_shift(s),i=e.read_shift(s),o=Tt(e),l=Tt(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function f0(e){var t=Tt(e),r=Tt(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function Xx(e,t,r){if(r.biff<8)return f0(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=Tt(e),o=Tt(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function h0(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return qx(e);var s=e.read_shift(r&&r.biff==12?4:2),n=Tt(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function qx(e){var t=Tt(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Kx(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Jx(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return Qx(e);var n=e.read_shift(s>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:l}}function Qx(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function Zx(e,t,r){var s=(e[e.l++]&96)>>5,n=u0(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function em(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=u0(e,i,r);return[s,n,o]}function rm(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function tm(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[s,n]}function am(e,t,r){var s=(e[e.l++]&96)>>5,n=Xx(e,t-1,r);return[s,n]}function sm(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function So(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function nm(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=s;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function im(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function om(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function lm(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function cm(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function x0(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function dm(e){return e.read_shift(2),x0(e)}function um(e){return e.read_shift(2),x0(e)}function fm(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=h0(e,0,r);return[s,n]}function hm(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=Jx(e,0,r);return[s,n]}function xm(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=h0(e,0,r);return[s,n,i]}function mm(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[mp[n],g0[n],s]}function pm(e,t,r){var s=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:gm(e);return[n,(i[0]===0?g0:xp)[i[1]]]}function gm(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function vm(e,t,r){e.l+=r&&r.biff==2?3:4}function bm(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function wm(e){return e.l++,Za[e.read_shift(1)]}function ym(e){return e.l++,e.read_shift(2)}function Nm(e){return e.l++,e.read_shift(1)!==0}function jm(e){return e.l++,ga(e)}function _m(e,t,r){return e.l++,Kl(e,t-1,r)}function Em(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=xh(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Za[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ga(e);break;case 2:r[1]=vh(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Sm(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=s;++i)n.push((r.biff==12?Xt:yh)(e));return n}function km(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var i=0,o=[];i!=s&&(o[i]=[]);++i)for(var l=0;l!=n;++l)o[i][l]=Em(e,r.biff);return o}function Tm(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,i]}function Cm(e,t,r){if(r.biff==5)return Am(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[s,n,i]}function Am(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function Dm(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function Fm(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function Pm(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function Om(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[s,n]}var Mm=nt,Im=nt,Rm=nt;function es(e,t,r){return e.l+=2,[Kx(e)]}function ii(e){return e.l+=6,[]}var Lm=es,Bm=ii,Wm=ii,Um=es;function m0(e){return e.l+=2,[Xl(e),e.read_shift(2)&1]}var $m=es,zm=m0,Hm=ii,Vm=es,Gm=es,Ym=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Xm(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),o=Ym[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:s,c:n,C:i}}function qm(e){return e.l+=2,[e.read_shift(4)]}function Km(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Jm(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Qm(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Zm(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function ep(e){return e.l+=4,[0,0]}var ko={1:{n:"PtgExp",f:bm},2:{n:"PtgTbl",f:Rm},3:{n:"PtgAdd",f:rr},4:{n:"PtgSub",f:rr},5:{n:"PtgMul",f:rr},6:{n:"PtgDiv",f:rr},7:{n:"PtgPower",f:rr},8:{n:"PtgConcat",f:rr},9:{n:"PtgLt",f:rr},10:{n:"PtgLe",f:rr},11:{n:"PtgEq",f:rr},12:{n:"PtgGe",f:rr},13:{n:"PtgGt",f:rr},14:{n:"PtgNe",f:rr},15:{n:"PtgIsect",f:rr},16:{n:"PtgUnion",f:rr},17:{n:"PtgRange",f:rr},18:{n:"PtgUplus",f:rr},19:{n:"PtgUminus",f:rr},20:{n:"PtgPercent",f:rr},21:{n:"PtgParen",f:rr},22:{n:"PtgMissArg",f:rr},23:{n:"PtgStr",f:_m},26:{n:"PtgSheet",f:Km},27:{n:"PtgEndSheet",f:Jm},28:{n:"PtgErr",f:wm},29:{n:"PtgBool",f:Nm},30:{n:"PtgInt",f:ym},31:{n:"PtgNum",f:jm},32:{n:"PtgArray",f:sm},33:{n:"PtgFunc",f:mm},34:{n:"PtgFuncVar",f:pm},35:{n:"PtgName",f:Tm},36:{n:"PtgRef",f:fm},37:{n:"PtgArea",f:Zx},38:{n:"PtgMemArea",f:Dm},39:{n:"PtgMemErr",f:Mm},40:{n:"PtgMemNoMem",f:Im},41:{n:"PtgMemFunc",f:Fm},42:{n:"PtgRefErr",f:Pm},43:{n:"PtgAreaErr",f:rm},44:{n:"PtgRefN",f:hm},45:{n:"PtgAreaN",f:am},46:{n:"PtgMemAreaN",f:Qm},47:{n:"PtgMemNoMemN",f:Zm},57:{n:"PtgNameX",f:Cm},58:{n:"PtgRef3d",f:xm},59:{n:"PtgArea3d",f:em},60:{n:"PtgRefErr3d",f:Om},61:{n:"PtgAreaErr3d",f:tm},255:{}},rp={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},tp={1:{n:"PtgElfLel",f:m0},2:{n:"PtgElfRw",f:Vm},3:{n:"PtgElfCol",f:Lm},6:{n:"PtgElfRwV",f:Gm},7:{n:"PtgElfColV",f:Um},10:{n:"PtgElfRadical",f:$m},11:{n:"PtgElfRadicalS",f:Hm},13:{n:"PtgElfColS",f:Bm},15:{n:"PtgElfColSV",f:Wm},16:{n:"PtgElfRadicalLel",f:zm},25:{n:"PtgList",f:Xm},29:{n:"PtgSxName",f:qm},255:{}},ap={0:{n:"PtgAttrNoop",f:ep},1:{n:"PtgAttrSemi",f:cm},2:{n:"PtgAttrIf",f:om},4:{n:"PtgAttrChoose",f:nm},8:{n:"PtgAttrGoto",f:im},16:{n:"PtgAttrSum",f:vm},32:{n:"PtgAttrBaxcel",f:So},33:{n:"PtgAttrBaxcel",f:So},64:{n:"PtgAttrSpace",f:dm},65:{n:"PtgAttrSpaceSemi",f:um},128:{n:"PtgAttrIfError",f:lm},255:{}};function sp(e,t,r,s){if(s.biff<8)return nt(e,t);for(var n=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=km(e,0,s),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Sm(e,r[o][1],s),i.push(r[o][2]);break;case"PtgExp":s&&s.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&i.push(nt(e,t)),i}function np(e,t,r){for(var s=e.l+t,n,i,o=[];s!=e.l;)t=s-e.l,i=e[e.l],n=ko[i]||ko[rp[i]],(i===24||i===25)&&(n=(i===24?tp:ap)[e[e.l+1]]),!n||!n.f?nt(e,t):o.push([n.n,n.f(e,t,r)]);return o}function ip(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],i=0;i<s.length;++i){var o=s[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var op={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function lp(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function p0(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function To(e,t,r){var s=p0(e,t,r);return s=="#REF"?s:lp(s,r)}function ha(e,t,r,s,n){var i=n&&n.biff||8,o={s:{c:0,r:0}},l=[],d,c,u,h=0,m=0,f,g="";if(!e[0]||!e[0][0])return"";for(var x=-1,p="",w=0,b=e[0].length;w<b;++w){var y=e[0][w];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=l.pop(),c=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:p=Je(" ",e[0][x][1][1]);break;case 1:p=Je("\r",e[0][x][1][1]);break;default:if(p="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}c=c+p,x=-1}l.push(c+op[y[0]]+d);break;case"PtgIsect":d=l.pop(),c=l.pop(),l.push(c+" "+d);break;case"PtgUnion":d=l.pop(),c=l.pop(),l.push(c+","+d);break;case"PtgRange":d=l.pop(),c=l.pop(),l.push(c+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Oa(y[1][1],o,n),l.push(Ma(u,i));break;case"PtgRefN":u=r?Oa(y[1][1],r,n):y[1][1],l.push(Ma(u,i));break;case"PtgRef3d":h=y[1][1],u=Oa(y[1][2],o,n),g=To(s,h,n),l.push(g+"!"+Ma(u,i));break;case"PtgFunc":case"PtgFuncVar":var S=y[1][0],P=y[1][1];S||(S=0),S&=127;var L=S==0?[]:l.slice(-S);l.length-=S,P==="User"&&(P=L.shift()),l.push(P+"("+L.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":f=fo(y[1][1],r?{s:r}:o,n),l.push(dn(f,n));break;case"PtgArea":f=fo(y[1][1],o,n),l.push(dn(f,n));break;case"PtgArea3d":h=y[1][1],f=y[1][2],g=To(s,h,n),l.push(g+"!"+dn(f,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=y[1][2];var I=(s.names||[])[m-1]||(s[0]||[])[m],H=I?I.Name:"SH33TJSNAME"+String(m);H&&H.slice(0,6)=="_xlfn."&&!n.xlfn&&(H=H.slice(6)),l.push(H);break;case"PtgNameX":var W=y[1][1];m=y[1][2];var J;if(n.biff<=5)W<0&&(W=-W),s[W]&&(J=s[W][m]);else{var ee="";if(((s[W]||[])[0]||[])[0]==14849||(((s[W]||[])[0]||[])[0]==1025?s[W][m]&&s[W][m].itab>0&&(ee=s.SheetNames[s[W][m].itab-1]+"!"):ee=s.SheetNames[m-1]+"!"),s[W]&&s[W][m])ee+=s[W][m].Name;else if(s[0]&&s[0][m])ee+=s[0][m].Name;else{var R=(p0(s,W,n)||"").split(";;");R[m-1]?ee=R[m-1]:ee+="SH33TJSERRX"}l.push(ee);break}J||(J={Name:"SH33TJSERRY"}),l.push(J.Name);break;case"PtgParen":var q="(",be=")";if(x>=0){switch(p="",e[0][x][1][0]){case 2:q=Je(" ",e[0][x][1][1])+q;break;case 3:q=Je("\r",e[0][x][1][1])+q;break;case 4:be=Je(" ",e[0][x][1][1])+be;break;case 5:be=Je("\r",e[0][x][1][1])+be;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(q+l.pop()+be);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var he={c:r.c,r:r.r};if(s.sharedf[Ue(u)]){var je=s.sharedf[Ue(u)];l.push(ha(je,o,he,s,n))}else{var le=!1;for(d=0;d!=s.arrayf.length;++d)if(c=s.arrayf[d],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){l.push(ha(c[1],o,he,s,n)),le=!0;break}le||l.push(y[1])}break;case"PtgArray":l.push("{"+ip(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var M=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&x>=0&&M.indexOf(e[0][w][0])==-1){y=e[0][x];var ie=!0;switch(y[1][0]){case 4:ie=!1;case 0:p=Je(" ",y[1][1]);break;case 5:ie=!1;case 1:p=Je("\r",y[1][1]);break;default:if(p="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((ie?p:"")+l.pop()+(ie?"":p)),x=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function cp(e){if(e==null){var t=te(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return $t(e);return $t(0)}function dp(e,t,r,s,n){var i=zt(t,r,n),o=cp(e.v),l=te(6),d=33;l.write_shift(2,d),l.write_shift(4,0);for(var c=te(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var h=ur([i,o,l,c]);return h}function Xs(e,t,r){var s=e.read_shift(4),n=np(e,s,r),i=e.read_shift(4),o=i>0?sp(e,i,n,r):null;return[n,o]}var up=Xs,qs=Xs,fp=Xs,hp=Xs,xp={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},g0={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mp={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function pp(e){var t="of:="+e.replace(si,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function gp(e){return e.replace(/\./,"!")}var Ia=typeof Map!="undefined";function oi(e,t,r){var s=0,n=e.length;if(r){if(Ia?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Ia?r.get(t):r[t];s<i.length;++s)if(e[i[s]].t===t)return e.Count++,i[s]}}else for(;s<n;++s)if(e[s].t===t)return e.Count++,s;return e[n]={t},e.Count++,e.Unique++,r&&(Ia?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function Ks(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(ft=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=Is(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=kn(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function v0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function At(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(s==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){hl(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=s=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===s)return n;return e[i]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function vp(e,t,r){if(e&&e["!ref"]){var s=Ve(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function bp(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+tr(e[r])+'"/>';return t+"</mergeCells>"}function wp(e,t,r,s,n){var i=!1,o={},l=null;if(s.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}i=!0,o.codeName=za(We(d))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),l=(l||"")+xe("outlinePr",null,c)}!i&&!l||(n[n.length]=xe("sheetPr",l,o))}var yp=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Np=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function jp(e){var t={sheet:1};return yp.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Np.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=r0(e.password).toString(16).toUpperCase()),xe("sheetProtection",null,t)}function _p(e){return v0(e),xe("pageMargins",null,e)}function Ep(e,t){for(var r=["<cols>"],s,n=0;n!=t.length;++n)(s=t[n])&&(r[r.length]=xe("col",null,Ks(n,s)));return r[r.length]="</cols>",r.join("")}function Sp(e,t,r,s){var n=typeof e.ref=="string"?e.ref:tr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Br(n);o.s.r==o.e.r&&(o.e.r=Br(t["!ref"]).e.r,n=tr(o));for(var l=0;l<i.length;++l){var d=i[l];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+r.SheetNames[s]+"'!"+n;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),xe("autoFilter",null,{ref:n})}function kp(e,t,r,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),xe("sheetViews",xe("sheetView",null,n),{})}function Tp(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Za[e.v];break;case"d":s&&s.cellDates?n=_r(e.v,-1).toISOString():(e=Fr(e),e.t="n",n=""+(e.v=Dr(_r(e.v)))),typeof e.z=="undefined"&&(e.z=Qe[14]);break;default:n=e.v;break}var l=fr("v",We(n)),d={r:t},c=At(s.cellXfs,e,s);switch(c!==0&&(d.s=c),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=fr("v",""+oi(s.Strings,e.v,s.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=xe("f",We(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),xe("c",l,d)}function Cp(e,t,r,s){var n=[],i=[],o=Ve(e["!ref"]),l="",d,c="",u=[],h=0,m=0,f=e["!rows"],g=Array.isArray(e),x={r:c},p,w=-1;for(m=o.s.c;m<=o.e.c;++m)u[m]=pr(m);for(h=o.s.r;h<=o.e.r;++h){for(i=[],c=hr(h),m=o.s.c;m<=o.e.c;++m){d=u[m]+c;var b=g?(e[h]||[])[m]:e[d];b!==void 0&&(l=Tp(b,d,e,t))!=null&&i.push(l)}(i.length>0||f&&f[h])&&(x={r:c},f&&f[h]&&(p=f[h],p.hidden&&(x.hidden=1),w=-1,p.hpx?w=Rs(p.hpx):p.hpt&&(w=p.hpt),w>-1&&(x.ht=w,x.customHeight=1),p.level&&(x.outlineLevel=p.level)),n[n.length]=xe("row",i.join(""),x))}if(f)for(;h<f.length;++h)f&&f[h]&&(x={r:h+1},p=f[h],p.hidden&&(x.hidden=1),w=-1,p.hpx?w=Rs(p.hpx):p.hpt&&(w=p.hpt),w>-1&&(x.ht=w,x.customHeight=1),p.level&&(x.outlineLevel=p.level),n[n.length]=xe("row","",x));return n.join("")}function b0(e,t,r,s){var n=[ar,xe("worksheet",null,{xmlns:xa[0],"xmlns:r":ir.r})],i=r.SheetNames[e],o=0,l="",d=r.Sheets[i];d==null&&(d={});var c=d["!ref"]||"A1",u=Ve(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=tr(u)}s||(s={}),d["!comments"]=[];var h=[];wp(d,r,e,t,n),n[n.length]=xe("dimension",null,{ref:c}),n[n.length]=kp(d,t,e,r),t.sheetFormat&&(n[n.length]=xe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(n[n.length]=Ep(d,d["!cols"])),n[o=n.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(l=Cp(d,t),l.length>0&&(n[n.length]=l)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),d["!protect"]&&(n[n.length]=jp(d["!protect"])),d["!autofilter"]!=null&&(n[n.length]=Sp(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(n[n.length]=bp(d["!merges"]));var m=-1,f,g=-1;return d["!links"].length>0&&(n[n.length]="<hyperlinks>",d["!links"].forEach(function(x){x[1].Target&&(f={ref:x[0]},x[1].Target.charAt(0)!="#"&&(g=Be(s,-1,We(x[1].Target).replace(/#.*$/,""),Oe.HLINK),f["r:id"]="rId"+g),(m=x[1].Target.indexOf("#"))>-1&&(f.location=We(x[1].Target.slice(m+1))),x[1].Tooltip&&(f.tooltip=We(x[1].Tooltip)),n[n.length]=xe("hyperlink",null,f))}),n[n.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(n[n.length]=_p(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=fr("ignoredErrors",xe("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(g=Be(s,-1,"../drawings/drawing"+(e+1)+".xml",Oe.DRAW),n[n.length]=xe("drawing",null,{"r:id":"rId"+g}),d["!drawing"]=h),d["!comments"].length>0&&(g=Be(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Oe.VML),n[n.length]=xe("legacyDrawing",null,{"r:id":"rId"+g}),d["!legacy"]=g),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Ap(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=s,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function Dp(e,t,r){var s=te(145),n=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var i=320;n.hpx?i=Rs(n.hpx)*20:n.hpt&&(i=n.hpt*20),s.write_shift(2,i),s.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var l=0,d=s.l;s.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,m=-1,f=u<<10;f<u+1<<10;++f){c.c=f;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Ue(c)];g&&(h<0&&(h=f),m=f)}h<0||(++l,s.write_shift(4,h),s.write_shift(4,m))}var x=s.l;return s.l=d,s.write_shift(4,l),s.l=x,s.length>s.l?s.slice(0,s.l):s}function Fp(e,t,r,s){var n=Dp(s,r,t);(n.length>17||(t["!rows"]||[])[s])&&oe(e,0,n)}var Pp=Xt,Op=pa;function Mp(){}function Ip(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=Gf(e),r}function Rp(e,t,r){r==null&&(r=te(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var n=1;n<3;++n)r.write_shift(1,0);return Ps({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Ol(e,r),r.slice(0,r.l)}function Lp(e){var t=zr(e);return[t]}function Bp(e,t,r){return r==null&&(r=te(8)),Vt(t,r)}function Wp(e){var t=Gt(e);return[t]}function Up(e,t,r){return r==null&&(r=te(4)),Yt(t,r)}function $p(e){var t=zr(e),r=e.read_shift(1);return[t,r,"b"]}function zp(e,t,r){return r==null&&(r=te(9)),Vt(t,r),r.write_shift(1,e.v?1:0),r}function Hp(e){var t=Gt(e),r=e.read_shift(1);return[t,r,"b"]}function Vp(e,t,r){return r==null&&(r=te(5)),Yt(t,r),r.write_shift(1,e.v?1:0),r}function Gp(e){var t=zr(e),r=e.read_shift(1);return[t,r,"e"]}function Yp(e,t,r){return r==null&&(r=te(9)),Vt(t,r),r.write_shift(1,e.v),r}function Xp(e){var t=Gt(e),r=e.read_shift(1);return[t,r,"e"]}function qp(e,t,r){return r==null&&(r=te(8)),Yt(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Kp(e){var t=zr(e),r=e.read_shift(4);return[t,r,"s"]}function Jp(e,t,r){return r==null&&(r=te(12)),Vt(t,r),r.write_shift(4,t.v),r}function Qp(e){var t=Gt(e),r=e.read_shift(4);return[t,r,"s"]}function Zp(e,t,r){return r==null&&(r=te(8)),Yt(t,r),r.write_shift(4,t.v),r}function eg(e){var t=zr(e),r=ga(e);return[t,r,"n"]}function rg(e,t,r){return r==null&&(r=te(16)),Vt(t,r),$t(e.v,r),r}function tg(e){var t=Gt(e),r=ga(e);return[t,r,"n"]}function ag(e,t,r){return r==null&&(r=te(12)),Yt(t,r),$t(e.v,r),r}function sg(e){var t=zr(e),r=Ml(e);return[t,r,"n"]}function ng(e,t,r){return r==null&&(r=te(12)),Vt(t,r),Il(e.v,r),r}function ig(e){var t=Gt(e),r=Ml(e);return[t,r,"n"]}function og(e,t,r){return r==null&&(r=te(8)),Yt(t,r),Il(e.v,r),r}function lg(e){var t=zr(e),r=Zn(e);return[t,r,"is"]}function cg(e){var t=zr(e),r=gr(e);return[t,r,"str"]}function dg(e,t,r){return r==null&&(r=te(12+4*e.v.length)),Vt(t,r),lr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function ug(e){var t=Gt(e),r=gr(e);return[t,r,"str"]}function fg(e,t,r){return r==null&&(r=te(8+4*e.v.length)),Yt(t,r),lr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function hg(e,t,r){var s=e.l+t,n=zr(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"b"];if(r.cellFormula){e.l+=2;var l=qs(e,s-e.l,r);o[3]=ha(l,null,n,r.supbooks,r)}else e.l=s;return o}function xg(e,t,r){var s=e.l+t,n=zr(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"e"];if(r.cellFormula){e.l+=2;var l=qs(e,s-e.l,r);o[3]=ha(l,null,n,r.supbooks,r)}else e.l=s;return o}function mg(e,t,r){var s=e.l+t,n=zr(e);n.r=r["!row"];var i=ga(e),o=[n,i,"n"];if(r.cellFormula){e.l+=2;var l=qs(e,s-e.l,r);o[3]=ha(l,null,n,r.supbooks,r)}else e.l=s;return o}function pg(e,t,r){var s=e.l+t,n=zr(e);n.r=r["!row"];var i=gr(e),o=[n,i,"str"];if(r.cellFormula){e.l+=2;var l=qs(e,s-e.l,r);o[3]=ha(l,null,n,r.supbooks,r)}else e.l=s;return o}var gg=Xt,vg=pa;function bg(e,t){return t==null&&(t=te(4)),t.write_shift(4,e),t}function wg(e,t){var r=e.l+t,s=Xt(e),n=ei(e),i=gr(e),o=gr(e),l=gr(e);e.l=r;var d={rfx:s,relId:n,loc:i,display:l};return o&&(d.Tooltip=o),d}function yg(e,t){var r=te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));pa({s:or(e[0]),e:or(e[0])},r),ri("rId"+t,r);var s=e[1].Target.indexOf("#"),n=s==-1?"":e[1].Target.slice(s+1);return lr(n||"",r),lr(e[1].Tooltip||"",r),lr("",r),r.slice(0,r.l)}function Ng(){}function jg(e,t,r){var s=e.l+t,n=Rl(e),i=e.read_shift(1),o=[n];if(o[2]=i,r.cellFormula){var l=up(e,s-e.l,r);o[1]=l}else e.l=s;return o}function _g(e,t,r){var s=e.l+t,n=Xt(e),i=[n];if(r.cellFormula){var o=hp(e,s-e.l,r);i[1]=o,e.l=s}else e.l=s;return i}function Eg(e,t,r){r==null&&(r=te(18));var s=Ks(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var w0=["left","right","top","bottom","header","footer"];function Sg(e){var t={};return w0.forEach(function(r){t[r]=ga(e)}),t}function kg(e,t){return t==null&&(t=te(48)),v0(e),w0.forEach(function(r){$t(e[r],t)}),t}function Tg(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Cg(e,t,r){r==null&&(r=te(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Ag(e){var t=te(24);return t.write_shift(4,4),t.write_shift(4,1),pa(e,t),t}function Dg(e,t){return t==null&&(t=te(66)),t.write_shift(2,e.password?r0(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Fg(){}function Pg(){}function Og(e,t,r,s,n,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Fr(t),t.z=t.z||Qe[14],t.v=Dr(_r(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var d={r,c:s};switch(d.s=At(n.cellXfs,t,n),t.l&&i["!links"].push([Ue(d),t.l]),t.c&&i["!comments"].push([Ue(d),t.c]),t.t){case"s":case"str":return n.bookSST?(l=oi(n.Strings,t.v,n.revStrings),d.t="s",d.v=l,o?oe(e,18,Zp(t,d)):oe(e,7,Jp(t,d))):(d.t="str",o?oe(e,17,fg(t,d)):oe(e,6,dg(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?oe(e,13,og(t,d)):oe(e,2,ng(t,d)):o?oe(e,16,ag(t,d)):oe(e,5,rg(t,d)),!0;case"b":return d.t="b",o?oe(e,15,Vp(t,d)):oe(e,4,zp(t,d)),!0;case"e":return d.t="e",o?oe(e,14,qp(t,d)):oe(e,3,Yp(t,d)),!0}return o?oe(e,12,Up(t,d)):oe(e,1,Bp(t,d)),!0}function Mg(e,t,r,s){var n=Ve(t["!ref"]||"A1"),i,o="",l=[];oe(e,145);var d=Array.isArray(t),c=n.e.r;t["!rows"]&&(c=Math.max(n.e.r,t["!rows"].length-1));for(var u=n.s.r;u<=c;++u){o=hr(u),Fp(e,t,n,u);var h=!1;if(u<=n.e.r)for(var m=n.s.c;m<=n.e.c;++m){u===n.s.r&&(l[m]=pr(m)),i=l[m]+o;var f=d?(t[u]||[])[m]:t[i];if(!f){h=!1;continue}h=Og(e,f,u,m,s,t,h)}}oe(e,146)}function Ig(e,t){!t||!t["!merges"]||(oe(e,177,bg(t["!merges"].length)),t["!merges"].forEach(function(r){oe(e,176,vg(r))}),oe(e,178))}function Rg(e,t){!t||!t["!cols"]||(oe(e,390),t["!cols"].forEach(function(r,s){r&&oe(e,60,Eg(s,r))}),oe(e,391))}function Lg(e,t){!t||!t["!ref"]||(oe(e,648),oe(e,649,Ag(Ve(t["!ref"]))),oe(e,650))}function Bg(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var n=Be(r,-1,s[1].Target.replace(/#.*$/,""),Oe.HLINK);oe(e,494,yg(s,n))}}),delete t["!links"]}function Wg(e,t,r,s){if(t["!comments"].length>0){var n=Be(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Oe.VML);oe(e,551,ri("rId"+n)),t["!legacy"]=n}}function Ug(e,t,r,s){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:tr(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Br(i);l.s.r==l.e.r&&(l.e.r=Br(t["!ref"]).e.r,i=tr(l));for(var d=0;d<o.length;++d){var c=o[d];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+i;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+i}),oe(e,161,pa(Ve(i))),oe(e,162)}}function $g(e,t,r){oe(e,133),oe(e,137,Cg(t,r)),oe(e,138),oe(e,134)}function zg(e,t){t["!protect"]&&oe(e,535,Dg(t["!protect"]))}function Hg(e,t,r,s){var n=Ar(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var d=Ve(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],oe(n,129),(r.vbaraw||o["!outline"])&&oe(n,147,Rp(l,o["!outline"])),oe(n,148,Op(d)),$g(n,o,r.Workbook),Rg(n,o),Mg(n,o,e,t),zg(n,o),Ug(n,o,r,e),Ig(n,o),Bg(n,o,s),o["!margins"]&&oe(n,476,kg(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Lg(n,o),Wg(n,o,e,s),oe(n,130),n.end()}function Vg(e,t){e.l+=10;var r=gr(e);return{name:r}}var Gg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Yg(e){return!e.Workbook||!e.Workbook.WBProps?"false":_f(e.Workbook.WBProps.date1904)?"true":"false"}var Xg="][*?/\\".split("");function y0(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Xg.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function qg(e,t,r){e.forEach(function(s,n){y0(s);for(var i=0;i<n;++i)if(s==e[i])throw new Error("Duplicate Sheet Name: "+s);if(r){var o=t&&t[n]&&t[n].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Kg(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];qg(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)vp(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function N0(e){var t=[ar];t[t.length]=xe("workbook",null,{xmlns:xa[0],"xmlns:r":ir.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Gg.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=xe("workbookPr",null,s);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:We(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=xe("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var d={name:l.Name};l.Comment&&(d.comment=l.Comment),l.Sheet!=null&&(d.localSheetId=""+l.Sheet),l.Hidden&&(d.hidden="1"),l.Ref&&(t[t.length]=xe("definedName",We(l.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Jg(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Sn(e),r.name=gr(e),r}function Qg(e,t){return t||(t=te(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),ri(e.strRelID,t),lr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Zg(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?gr(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function e1(e,t){t||(t=te(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Ol(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function r1(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=Yf(e),o=fp(e,0,r),l=ei(e);e.l=s;var d={Name:i,Ptg:o};return n<268435455&&(d.Sheet=n),l&&(d.Comment=l),d}function t1(e,t){oe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};oe(e,156,Qg(n))}oe(e,144)}function a1(e,t){t||(t=te(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return lr("SheetJS",t),lr(Es.version,t),lr(Es.version,t),lr("7262",t),t.length>t.l?t.slice(0,t.l):t}function s1(e,t){t||(t=te(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function n1(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,n=-1,i=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&n==-1?n=s:r[s].Hidden==1&&i==-1&&(i=s);i>n||(oe(e,135),oe(e,158,s1(n)),oe(e,136))}}function i1(e,t){var r=Ar();return oe(r,131),oe(r,128,a1()),oe(r,153,e1(e.Workbook&&e.Workbook.WBProps||null)),n1(r,e),t1(r,e),oe(r,132),r.end()}function o1(e,t,r){return(t.slice(-4)===".bin"?i1:N0)(e)}function l1(e,t,r,s,n){return(t.slice(-4)===".bin"?Hg:b0)(e,r,s,n)}function c1(e,t,r){return(t.slice(-4)===".bin"?kx:s0)(e,r)}function d1(e,t,r){return(t.slice(-4)===".bin"?ex:e0)(e,r)}function u1(e,t,r){return(t.slice(-4)===".bin"?zx:c0)(e)}function f1(e){return(e.slice(-4)===".bin"?Mx:o0)()}function h1(e,t){var r=[];return e.Props&&r.push(ch(e.Props,t)),e.Custprops&&r.push(dh(e.Props,e.Custprops)),r.join("")}function x1(){return""}function m1(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,n){var i=[];i.push(xe("NumberFormat",null,{"ss:Format":We(Qe[s.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(xe("Style",i.join(""),o))}),xe("Styles",r.join(""))}function j0(e){return xe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ni(e.Ref,{r:0,c:0})})}function p1(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var n=t[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(j0(n)))}return xe("Names",r.join(""))}function g1(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,i=[],o=0;o<n.length;++o){var l=n[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(j0(l)))}return i.join("")}function v1(e,t,r,s){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(xe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(xe("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(xe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)n.push(xe("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(s.Workbook.Sheets[i]&&!s.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(fr("ProtectContents","True")),e["!protect"].objects&&n.push(fr("ProtectObjects","True")),e["!protect"].scenarios&&n.push(fr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(fr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(fr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":xe("WorksheetOptions",n.join(""),{xmlns:Ir.x})}function b1(e){return e.map(function(t){var r=jf(t.t||""),s=xe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return xe("Comment",s,{"ss:Author":t.a})}).join("")}function w1(e,t,r,s,n,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+We(ni(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var d=or(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=We(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=We(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(l["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(l["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",m="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":h="Number",m=String(e.v);break;case"b":h="Boolean",m=e.v?"1":"0";break;case"e":h="Error",m=Za[e.v];break;case"d":h="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Qe[14]);break;case"s":h="String",m=Nf(e.v||"");break}var f=At(s.cellXfs,e,s);l["ss:StyleID"]="s"+(21+f),l["ss:Index"]=o.c+1;var g=e.v!=null?m:"",x=e.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(e.c||[]).length>0&&(x+=b1(e.c)),xe("Cell",x,l)}function y1(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=a0(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function N1(e,t,r,s){if(!e["!ref"])return"";var n=Ve(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(p,w){ai(p);var b=!!p.width,y=Ks(w,p),S={"ss:Index":w+1};b&&(S["ss:Width"]=Ms(y.width)),p.hidden&&(S["ss:Hidden"]="1"),l.push(xe("Column",null,S))});for(var d=Array.isArray(e),c=n.s.r;c<=n.e.r;++c){for(var u=[y1(c,(e["!rows"]||[])[c])],h=n.s.c;h<=n.e.c;++h){var m=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>h)&&!(i[o].s.r>c)&&!(i[o].e.c<h)&&!(i[o].e.r<c)){(i[o].s.c!=h||i[o].s.r!=c)&&(m=!0);break}if(!m){var f={r:c,c:h},g=Ue(f),x=d?(e[c]||[])[h]:e[g];u.push(w1(x,g,e,t,r,s,f))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function j1(e,t,r){var s=[],n=r.SheetNames[e],i=r.Sheets[n],o=i?g1(i,t,e,r):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=i?N1(i,t,e,r):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(v1(i,t,e,r)),s.join("")}function _1(e,t){t||(t={}),e.SSF||(e.SSF=Fr(Qe)),e.SSF&&(Vs(),Hs(e.SSF),t.revssf=Gs(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],At(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(h1(e,t)),r.push(x1()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(xe("Worksheet",j1(s,t,e),{"ss:Name":We(e.SheetNames[s])}));return r[2]=m1(e,t),r[3]=p1(e),ar+xe("Workbook",r.join(""),{xmlns:Ir.ss,"xmlns:o":Ir.o,"xmlns:x":Ir.x,"xmlns:ss":Ir.ss,"xmlns:dt":Ir.dt,"xmlns:html":Ir.html})}var hn={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function E1(e,t){var r=[],s=[],n=[],i=0,o,l=eo(xo,"n"),d=eo(mo,"n");if(e.Props)for(o=xr(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(d,o[i])?s:n).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=xr(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(d,o[i])?s:n).push([o[i],e.Custprops[o[i]]]);var c=[];for(i=0;i<n.length;++i)Yl.indexOf(n[i][0])>-1||Hl.indexOf(n[i][0])>-1||n[i][1]!=null&&c.push(n[i]);s.length&&$e.utils.cfb_add(t,"/SummaryInformation",wo(s,hn.SI,d,mo)),(r.length||c.length)&&$e.utils.cfb_add(t,"/DocumentSummaryInformation",wo(r,hn.DSI,l,xo,c.length?c:null,hn.UDI))}function S1(e,t){var r=t||{},s=$e.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return $e.utils.cfb_add(s,n,_0(e,r)),r.biff==8&&(e.Props||e.Custprops)&&E1(e,s),r.biff==8&&e.vbaraw&&Hx(s,$e.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var k1={0:{f:Ap},1:{f:Lp},2:{f:sg},3:{f:Gp},4:{f:$p},5:{f:eg},6:{f:cg},7:{f:Kp},8:{f:pg},9:{f:mg},10:{f:hg},11:{f:xg},12:{f:Wp},13:{f:ig},14:{f:Xp},15:{f:Hp},16:{f:tg},17:{f:ug},18:{f:Qp},19:{f:Zn},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:r1},40:{},42:{},43:{f:cx},44:{f:ox},45:{f:fx},46:{f:xx},47:{f:hx},48:{},49:{f:Wf},50:{},51:{f:Ax},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Uh},62:{f:lg},63:{f:Ix},64:{f:Fg},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:nt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Tg},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ip},148:{f:Pp,p:16},151:{f:Ng},152:{},153:{f:Zg},154:{},155:{},156:{f:Jg},157:{},158:{},159:{T:1,f:Jh},160:{T:-1},161:{T:1,f:Xt},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:gg},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Tx},336:{T:-1},337:{f:Px,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Sn},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Mh},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:jg},427:{f:_g},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Sg},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Mp},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wg},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Sn},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Ux},633:{T:1},634:{T:-1},635:{T:1,f:Bx},636:{T:-1},637:{f:Hf},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Vg},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Pg},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function me(e,t,r,s){var n=t;if(!isNaN(n)){var i=s||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&Kn(r)&&e.push(r)}}function T1(e,t,r,s){var n=(r||[]).length||0;if(n<=8224)return me(e,t,r,n);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,d=0,c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c;d<n;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;u.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c}}}function rs(e,t,r){return e||(e=te(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function C1(e,t,r,s){var n=te(9);return rs(n,e,t),ql(r,s||"b",n),n}function A1(e,t,r){var s=te(8+2*r.length);return rs(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function D1(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Dr(_r(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?me(e,2,Vh(r,s,n)):me(e,3,Hh(r,s,n));return;case"b":case"e":me(e,5,C1(r,s,t.v,t.t));return;case"s":case"str":me(e,4,A1(r,s,(t.v||"").slice(0,255)));return}me(e,1,rs(null,r,s))}function F1(e,t,r,s){var n=Array.isArray(t),i=Ve(t["!ref"]||"A1"),o,l="",d=[];if(i.e.c>255||i.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=tr(i)}for(var c=i.s.r;c<=i.e.r;++c){l=hr(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(d[u]=pr(u)),o=d[u]+l;var h=n?(t[c]||[])[u]:t[o];h&&D1(e,h,c,u)}}}function P1(e,t){for(var r=t||{},s=Ar(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return me(s,r.biff==4?1033:r.biff==3?521:9,ti(e,16,r)),F1(s,e.Sheets[e.SheetNames[n]],n,r),me(s,10),s.end()}function O1(e,t,r){me(e,49,kh({sz:12,name:"Arial"},r))}function M1(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&me(e,1054,Ah(n,t[n],r))})}function I1(e,t){var r=te(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),me(e,2151,r),r=te(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Ql(Ve(t["!ref"]||"A1"),r),r.write_shift(4,4),me(e,2152,r)}function R1(e,t){for(var r=0;r<16;++r)me(e,224,No({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){me(e,224,No(s,0,t))})}function L1(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];me(e,440,Lh(s)),s[1].Tooltip&&me(e,2048,Bh(s))}delete t["!links"]}function B1(e,t){if(t){var r=0;t.forEach(function(s,n){++r<=256&&s&&me(e,125,$h(Ks(n,s),n))})}}function W1(e,t,r,s,n){var i=16+At(n.cellXfs,t,n);if(t.v==null&&!t.bf){me(e,513,zt(r,s,i));return}if(t.bf)me(e,6,dp(t,r,s,n,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?Dr(_r(t.v)):t.v;me(e,515,Oh(r,s,o,i));break;case"b":case"e":me(e,517,Ph(r,s,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var l=oi(n.Strings,t.v,n.revStrings);me(e,253,Th(r,s,l,i))}else me(e,516,Ch(r,s,(t.v||"").slice(0,255),i,n));break;default:me(e,513,zt(r,s,i))}}function U1(e,t,r){var s=Ar(),n=r.SheetNames[e],i=r.Sheets[n]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},d=Array.isArray(i),c=t.biff==8,u,h="",m=[],f=Ve(i["!ref"]||"A1"),g=c?65536:16384;if(f.e.c>255||f.e.r>=g){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,g-1)}me(s,2057,ti(r,16,t)),me(s,13,$r(1)),me(s,12,$r(100)),me(s,15,wr(!0)),me(s,17,wr(!1)),me(s,16,$t(.001)),me(s,95,wr(!0)),me(s,42,wr(!1)),me(s,43,wr(!1)),me(s,130,$r(1)),me(s,128,Fh()),me(s,131,wr(!1)),me(s,132,wr(!1)),c&&B1(s,i["!cols"]),me(s,512,Dh(f,t)),c&&(i["!links"]=[]);for(var x=f.s.r;x<=f.e.r;++x){h=hr(x);for(var p=f.s.c;p<=f.e.c;++p){x===f.s.r&&(m[p]=pr(p)),u=m[p]+h;var w=d?(i[x]||[])[p]:i[u];w&&(W1(s,w,x,p,t),c&&w.l&&i["!links"].push([u,w.l]))}}var b=l.CodeName||l.name||n;return c&&me(s,574,Sh((o.Views||[])[0])),c&&(i["!merges"]||[]).length&&me(s,229,Rh(i["!merges"])),c&&L1(s,i),me(s,442,Jl(b)),c&&I1(s,i),me(s,10),s.end()}function $1(e,t,r){var s=Ar(),n=(e||{}).Workbook||{},i=n.Sheets||[],o=n.WBProps||{},l=r.biff==8,d=r.biff==5;if(me(s,2057,ti(e,5,r)),r.bookType=="xla"&&me(s,135),me(s,225,l?$r(1200):null),me(s,193,hh(2)),d&&me(s,191),d&&me(s,192),me(s,226),me(s,92,Nh("SheetJS",r)),me(s,66,$r(l?1200:1252)),l&&me(s,353,$r(0)),l&&me(s,448),me(s,317,zh(e.SheetNames.length)),l&&e.vbaraw&&me(s,211),l&&e.vbaraw){var c=o.CodeName||"ThisWorkbook";me(s,442,Jl(c))}me(s,156,$r(17)),me(s,25,wr(!1)),me(s,18,wr(!1)),me(s,19,$r(0)),l&&me(s,431,wr(!1)),l&&me(s,444,$r(0)),me(s,61,Eh()),me(s,64,wr(!1)),me(s,141,$r(0)),me(s,34,wr(Yg(e)=="true")),me(s,14,wr(!0)),l&&me(s,439,wr(!1)),me(s,218,$r(0)),O1(s,e,r),M1(s,e.SSF,r),R1(s,r),l&&me(s,352,wr(!1));var u=s.end(),h=Ar();l&&me(h,140,Wh()),l&&r.Strings&&T1(h,252,_h(r.Strings)),me(h,10);var m=h.end(),f=Ar(),g=0,x=0;for(x=0;x<e.SheetNames.length;++x)g+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var p=u.length+g+m.length;for(x=0;x<e.SheetNames.length;++x){var w=i[x]||{};me(f,133,jh({pos:p,hs:w.Hidden||0,dt:0,name:e.SheetNames[x]},r)),p+=t[x].length}var b=f.end();if(g!=b.length)throw new Error("BS8 "+g+" != "+b.length);var y=[];return u.length&&y.push(u),b.length&&y.push(b),m.length&&y.push(m),ur(y)}function z1(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=Fr(Qe)),e&&e.SSF&&(Vs(),Hs(e.SSF),r.revssf=Gs(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,li(r),r.cellXfs=[],At(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)s[s.length]=U1(n,r,e);return s.unshift($1(e,s,r)),ur(s)}function _0(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var n=Br(s["!ref"]);n.e.c>255&&typeof console!="undefined"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return z1(e,t);case 4:case 3:case 2:return P1(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function H1(e,t,r,s){for(var n=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,d=0,c=0;c<n.length;++c)if(!(n[c].s.r>r||n[c].s.c>o)&&!(n[c].e.r<r||n[c].e.c<o)){if(n[c].s.r<r||n[c].s.c<o){l=-1;break}l=n[c].e.r-n[c].s.r+1,d=n[c].e.c-n[c].s.c+1;break}if(!(l<0)){var u=Ue({r,c:o}),h=s.dense?(e[r]||[])[o]:e[u],m=h&&h.v!=null&&(h.h||yf(h.w||(mt(h),h.w)||""))||"",f={};l>1&&(f.rowspan=l),d>1&&(f.colspan=d),s.editable?m='<span contenteditable="true">'+m+"</span>":h&&(f["data-t"]=h&&h.t||"z",h.v!=null&&(f["data-v"]=h.v),h.z!=null&&(f["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),f.id=(s.id||"sjs")+"-"+u,i.push(xe("td",m,f))}}var g="<tr>";return g+i.join("")+"</tr>"}var V1='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',G1="</body></html>";function Y1(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function E0(e,t){var r=t||{},s=r.header!=null?r.header:V1,n=r.footer!=null?r.footer:G1,i=[s],o=Br(e["!ref"]);r.dense=Array.isArray(e),i.push(Y1(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(H1(e,o,l,r));return i.push("</table>"+n),i.join("")}function S0(e,t,r){var s=r||{},n=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var o=typeof s.origin=="string"?or(s.origin):s.origin;n=o.r,i=o.c}var l=t.getElementsByTagName("tr"),d=Math.min(s.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var u=Br(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),n==-1&&(c.e.r=n=u.e.r+1)}var h=[],m=0,f=e["!rows"]||(e["!rows"]=[]),g=0,x=0,p=0,w=0,b=0,y=0;for(e["!cols"]||(e["!cols"]=[]);g<l.length&&x<d;++g){var S=l[g];if(Co(S)){if(s.display)continue;f[x]={hidden:!0}}var P=S.children;for(p=w=0;p<P.length;++p){var L=P[p];if(!(s.display&&Co(L))){var I=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):Ef(L.innerHTML),H=L.getAttribute("data-z")||L.getAttribute("z");for(m=0;m<h.length;++m){var W=h[m];W.s.c==w+i&&W.s.r<x+n&&x+n<=W.e.r&&(w=W.e.c+1-i,m=-1)}y=+L.getAttribute("colspan")||1,((b=+L.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:x+n,c:w+i},e:{r:x+n+(b||1)-1,c:w+i+(y||1)-1}});var J={t:"s",v:I},ee=L.getAttribute("data-t")||L.getAttribute("t")||"";I!=null&&(I.length==0?J.t=ee||"z":s.raw||I.trim().length==0||ee=="s"||(I==="TRUE"?J={t:"b",v:!0}:I==="FALSE"?J={t:"b",v:!1}:isNaN(ut(I))?isNaN($a(I).getDate())||(J={t:"d",v:_r(I)},s.cellDates||(J={t:"n",v:Dr(J.v)}),J.z=s.dateNF||Qe[14]):J={t:"n",v:ut(I)})),J.z===void 0&&H!=null&&(J.z=H);var R="",q=L.getElementsByTagName("A");if(q&&q.length)for(var be=0;be<q.length&&!(q[be].hasAttribute("href")&&(R=q[be].getAttribute("href"),R.charAt(0)!="#"));++be);R&&R.charAt(0)!="#"&&(J.l={Target:R}),s.dense?(e[x+n]||(e[x+n]=[]),e[x+n][w+i]=J):e[Ue({c:w+i,r:x+n})]=J,c.e.c<w+i&&(c.e.c=w+i),w+=y}}++x}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+n),e["!ref"]=tr(c),x>=d&&(e["!fullref"]=tr((c.e.r=l.length-g+x-1+n,c))),e}function k0(e,t){var r=t||{},s=r.dense?[]:{};return S0(s,e,t)}function X1(e,t){return Ht(k0(e,t),t)}function Co(e){var t="",r=q1(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function q1(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var K1=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ha({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ar+t}})(),Ao=(function(){var e=function(i){return We(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(i,o,l){var d=[];d.push('      <table:table table:name="'+We(o.SheetNames[l])+`" table:style-name="ta1">
`);var c=0,u=0,h=Br(i["!ref"]||"A1"),m=i["!merges"]||[],f=0,g=Array.isArray(i);if(i["!cols"])for(u=0;u<=h.e.c;++u)d.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",p=i["!rows"]||[];for(c=0;c<h.s.r;++c)x=p[c]?' table:style-name="ro'+p[c].ods+'"':"",d.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=h.e.r;++c){for(x=p[c]?' table:style-name="ro'+p[c].ods+'"':"",d.push("        <table:table-row"+x+`>
`),u=0;u<h.s.c;++u)d.push(t);for(;u<=h.e.c;++u){var w=!1,b={},y="";for(f=0;f!=m.length;++f)if(!(m[f].s.c>u)&&!(m[f].s.r>c)&&!(m[f].e.c<u)&&!(m[f].e.r<c)){(m[f].s.c!=u||m[f].s.r!=c)&&(w=!0),b["table:number-columns-spanned"]=m[f].e.c-m[f].s.c+1,b["table:number-rows-spanned"]=m[f].e.r-m[f].s.r+1;break}if(w){d.push(r);continue}var S=Ue({r:c,c:u}),P=g?(i[c]||[])[u]:i[S];if(P&&P.f&&(b["table:formula"]=We(pp(P.f)),P.F&&P.F.slice(0,S.length)==S)){var L=Br(P.F);b["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,b["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!P){d.push(t);continue}switch(P.t){case"b":y=P.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=P.v?"true":"false";break;case"n":y=P.w||String(P.v||0),b["office:value-type"]="float",b["office:value"]=P.v||0;break;case"s":case"str":y=P.v==null?"":P.v,b["office:value-type"]="string";break;case"d":y=P.w||_r(P.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=_r(P.v).toISOString(),b["table:style-name"]="ce1";break;default:d.push(t);continue}var I=e(y);if(P.l&&P.l.Target){var H=P.l.Target;H=H.charAt(0)=="#"?"#"+gp(H.slice(1)):H,H.charAt(0)!="#"&&!H.match(/^\w+:/)&&(H="../"+H),I=xe("text:a",I,{"xlink:href":H.replace(/&/g,"&amp;")})}d.push("          "+xe("table:table-cell",xe("text:p",I,{}),b)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;ai(h),h.ods=l;var m=c["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++l}}});var d=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=d;var h=c["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++d}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var d=[ar],c=Ha({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Ha({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(d.push("<office:document"+c+u+`>
`),d.push($l().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+c+`>
`),n(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)d.push(s(o.Sheets[o.SheetNames[h]],o,h));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),l.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function T0(e,t){if(t.bookType=="fods")return Ao(e,t);var r=Gn(),s="",n=[],i=[];return s="mimetype",Te(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Te(r,s,Ao(e,t)),n.push([s,"text/xml"]),i.push([s,"ContentFile"]),s="styles.xml",Te(r,s,K1(e,t)),n.push([s,"text/xml"]),i.push([s,"StylesFile"]),s="meta.xml",Te(r,s,ar+$l()),n.push([s,"text/xml"]),i.push([s,"MetadataFile"]),s="manifest.rdf",Te(r,s,lh(i)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Te(r,s,ih(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ls(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function J1(e){return typeof TextEncoder!="undefined"?new TextEncoder().encode(e):Gr(za(e))}function Q1(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function Ct(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function Z1(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function Va(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function Re(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function da(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function sr(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=Va(e,r),i=n&7;n=Math.floor(n/8);var o=0,l;if(n==0)break;switch(i){case 0:{for(var d=r[0];e[r[0]++]>=128;);l=e.slice(d,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Va(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var c={data:l,type:i};t[n]==null?t[n]=[c]:t[n].push(c)}return t}function cr(e){var t=[];return e.forEach(function(r,s){r.forEach(function(n){n.data&&(t.push(Re(s*8+n.type)),n.type==2&&t.push(Re(n.data.length)),t.push(n.data))})}),Ct(t)}function Hr(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=Va(e,s),i=sr(e.slice(s[0],s[0]+n));s[0]+=n;var o={id:da(i[1][0].data),messages:[]};i[2].forEach(function(l){var d=sr(l.data),c=da(d[3][0].data);o.messages.push({meta:d,data:e.slice(s[0],s[0]+c)}),s[0]+=c}),(t=i[3])!=null&&t[0]&&(o.merge=da(i[3][0].data)>>>0>0),r.push(o)}return r}function Qt(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:Re(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:Re(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:Re(o.data.length)}],s[2].push({data:cr(o.meta),type:2})});var i=cr(s);t.push(Re(i.length)),t.push(i),n.forEach(function(o){return t.push(o)})}),Ct(t)}function ev(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Va(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var d=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Ct(n)],d==0)throw new Error("Invalid offset 0");if(d>n[0].length)throw new Error("Invalid offset beyond length");if(c>=d)for(n.push(n[0].slice(-d)),c-=d;c>=n[n.length-1].length;)n.push(n[n.length-1]),c-=n[n.length-1].length;n.push(n[0].slice(-d,-d+c))}}var u=Ct(n);if(u.length!=s)throw new Error("Unexpected length: ".concat(u.length," != ").concat(s));return u}function Vr(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(ev(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ct(t)}function Zt(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=Re(s),o=i.length;t.push(i),s<=60?(o++,t.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),o+=s,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=s}return Ct(t)}function xn(e,t){var r=new Uint8Array(32),s=Ls(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Z1(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,s.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,i,!0),r.slice(0,n)}function mn(e,t){var r=new Uint8Array(32),s=Ls(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,s.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,i,!0),r.slice(0,n)}function vt(e){var t=sr(e);return Va(t[1][0].data)}function rv(e,t,r){var s,n,i,o;if(!((s=e[6])!=null&&s[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&da(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var d=0,c=Ls(e[7][0].data),u=0,h=[],m=Ls(e[4][0].data),f=0,g=[],x=0;x<t.length;++x){if(t[x]==null){c.setUint16(x*2,65535,!0),m.setUint16(x*2,65535);continue}c.setUint16(x*2,u,!0),m.setUint16(x*2,f,!0);var p,w;switch(typeof t[x]){case"string":p=xn({t:"s",v:t[x]},r),w=mn({t:"s",v:t[x]},r);break;case"number":p=xn({t:"n",v:t[x]},r),w=mn({t:"n",v:t[x]},r);break;case"boolean":p=xn({t:"b",v:t[x]},r),w=mn({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}h.push(p),u+=p.length,g.push(w),f+=w.length,++d}for(e[2][0].data=Re(d);x<e[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),m.setUint16(x*2,65535,!0);return e[6][0].data=Ct(h),e[3][0].data=Ct(g),d}function tv(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Br(r["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(tr(s)));var i=Bs(r,{range:s,header:1}),o=["~Sh33tJ5~"];i.forEach(function(A){return A.forEach(function(N){typeof N=="string"&&o.push(N)})});var l={},d=[],c=$e.read(t.numbers,{type:"base64"});c.FileIndex.map(function(A,N){return[A,c.FullPaths[N]]}).forEach(function(A){var N=A[0],_=A[1];if(N.type==2&&N.name.match(/\.iwa/)){var U=N.content,re=Vr(U),z=Hr(re);z.forEach(function(K){d.push(K.id),l[K.id]={deps:[],location:_,type:da(K.messages[0].meta[1][0].data)}})}}),d.sort(function(A,N){return A-N});var u=d.filter(function(A){return A>1}).map(function(A){return[A,Re(A)]});c.FileIndex.map(function(A,N){return[A,c.FullPaths[N]]}).forEach(function(A){var N=A[0];if(A[1],!!N.name.match(/\.iwa/)){var _=Hr(Vr(N.content));_.forEach(function(U){U.messages.forEach(function(re){u.forEach(function(z){U.messages.some(function(K){return da(K.meta[1][0].data)!=11006&&Q1(K.data,z[1])})&&l[z[0]].deps.push(U.id)})})})}});for(var h=$e.find(c,l[1].location),m=Hr(Vr(h.content)),f,g=0;g<m.length;++g){var x=m[g];x.id==1&&(f=x)}var p=vt(sr(f.messages[0].data)[1][0].data);for(h=$e.find(c,l[p].location),m=Hr(Vr(h.content)),g=0;g<m.length;++g)x=m[g],x.id==p&&(f=x);for(p=vt(sr(f.messages[0].data)[2][0].data),h=$e.find(c,l[p].location),m=Hr(Vr(h.content)),g=0;g<m.length;++g)x=m[g],x.id==p&&(f=x);for(p=vt(sr(f.messages[0].data)[2][0].data),h=$e.find(c,l[p].location),m=Hr(Vr(h.content)),g=0;g<m.length;++g)x=m[g],x.id==p&&(f=x);var w=sr(f.messages[0].data);{w[6][0].data=Re(s.e.r+1),w[7][0].data=Re(s.e.c+1);var b=vt(w[46][0].data),y=$e.find(c,l[b].location),S=Hr(Vr(y.content));{for(var P=0;P<S.length&&S[P].id!=b;++P);if(S[P].id!=b)throw"Bad ColumnRowUIDMapArchive";var L=sr(S[P].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var I=0;I<=s.e.c;++I){var H=[];H[1]=H[2]=[{type:0,data:Re(I+420690)}],L[1].push({type:2,data:cr(H)}),L[2].push({type:0,data:Re(I)}),L[3].push({type:0,data:Re(I)})}L[4]=[],L[5]=[],L[6]=[];for(var W=0;W<=s.e.r;++W)H=[],H[1]=H[2]=[{type:0,data:Re(W+726270)}],L[4].push({type:2,data:cr(H)}),L[5].push({type:0,data:Re(W)}),L[6].push({type:0,data:Re(W)});S[P].messages[0].data=cr(L)}y.content=Zt(Qt(S)),y.size=y.content.length,delete w[46];var J=sr(w[4][0].data);{J[7][0].data=Re(s.e.r+1);var ee=sr(J[1][0].data),R=vt(ee[2][0].data);y=$e.find(c,l[R].location),S=Hr(Vr(y.content));{if(S[0].id!=R)throw"Bad HeaderStorageBucket";var q=sr(S[0].messages[0].data);for(W=0;W<i.length;++W){var be=sr(q[2][0].data);be[1][0].data=Re(W),be[4][0].data=Re(i[W].length),q[2][W]={type:q[2][0].type,data:cr(be)}}S[0].messages[0].data=cr(q)}y.content=Zt(Qt(S)),y.size=y.content.length;var he=vt(J[2][0].data);y=$e.find(c,l[he].location),S=Hr(Vr(y.content));{if(S[0].id!=he)throw"Bad HeaderStorageBucket";for(q=sr(S[0].messages[0].data),I=0;I<=s.e.c;++I)be=sr(q[2][0].data),be[1][0].data=Re(I),be[4][0].data=Re(s.e.r+1),q[2][I]={type:q[2][0].type,data:cr(be)};S[0].messages[0].data=cr(q)}y.content=Zt(Qt(S)),y.size=y.content.length;var je=vt(J[4][0].data);(function(){for(var A=$e.find(c,l[je].location),N=Hr(Vr(A.content)),_,U=0;U<N.length;++U){var re=N[U];re.id==je&&(_=re)}var z=sr(_.messages[0].data);{z[3]=[];var K=[];o.forEach(function(ge,Se){K[1]=[{type:0,data:Re(Se)}],K[2]=[{type:0,data:Re(1)}],K[3]=[{type:2,data:J1(ge)}],z[3].push({type:2,data:cr(K)})})}_.messages[0].data=cr(z);var Z=Qt(N),de=Zt(Z);A.content=de,A.size=A.content.length})();var le=sr(J[3][0].data);{var M=le[1][0];delete le[2];var ie=sr(M.data);{var B=vt(ie[2][0].data);(function(){for(var A=$e.find(c,l[B].location),N=Hr(Vr(A.content)),_,U=0;U<N.length;++U){var re=N[U];re.id==B&&(_=re)}var z=sr(_.messages[0].data);{delete z[6],delete le[7];var K=new Uint8Array(z[5][0].data);z[5]=[];for(var Z=0,de=0;de<=s.e.r;++de){var ge=sr(K);Z+=rv(ge,i[de],o),ge[1][0].data=Re(de),z[5].push({data:cr(ge),type:2})}z[1]=[{type:0,data:Re(s.e.c+1)}],z[2]=[{type:0,data:Re(s.e.r+1)}],z[3]=[{type:0,data:Re(Z)}],z[4]=[{type:0,data:Re(s.e.r+1)}]}_.messages[0].data=cr(z);var Se=Qt(N),Ne=Zt(Se);A.content=Ne,A.size=A.content.length})()}M.data=cr(ie)}J[3][0].data=cr(le)}w[4][0].data=cr(J)}f.messages[0].data=cr(w);var ne=Qt(m),C=Zt(ne);return h.content=C,h.size=h.content.length,c}function av(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function li(e){av([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function sv(e,t){return t.bookType=="ods"?T0(e,t):t.bookType=="numbers"?tv(e,t):t.bookType=="xlsb"?nv(e,t):iv(e,t)}function nv(e,t){sa=1024,e&&!e.SSF&&(e.SSF=Fr(Qe)),e&&e.SSF&&(Vs(),Hs(e.SSF),t.revssf=Gs(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ia?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=d0.indexOf(t.bookType)>-1,n=Bl();li(t=t||{});var i=Gn(),o="",l=0;if(t.cellXfs=[],At(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Te(i,o,zl(e.Props,t)),n.coreprops.push(o),Be(t.rels,2,o,Oe.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,Te(i,o,Vl(e.Props)),n.extprops.push(o),Be(t.rels,3,o,Oe.EXT_PROPS),e.Custprops!==e.Props&&xr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Te(i,o,Gl(e.Custprops)),n.custprops.push(o),Be(t.rels,4,o,Oe.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Te(i,o,l1(l-1,o,t,e,u)),n.sheets.push(o),Be(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Oe.WS[0])}if(h){var f=h["!comments"],g=!1,x="";f&&f.length>0&&(x="xl/comments"+l+"."+r,Te(i,x,u1(f,x)),n.comments.push(x),Be(u,-1,"../comments"+l+"."+r,Oe.CMNT),g=!0),h["!legacy"]&&g&&Te(i,"xl/drawings/vmlDrawing"+l+".vml",l0(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Te(i,Ul(o),la(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Te(i,o,d1(t.Strings,o,t)),n.strs.push(o),Be(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),o="xl/workbook."+r,Te(i,o,o1(e,o)),n.workbooks.push(o),Be(t.rels,1,o,Oe.WB),o="xl/theme/theme1.xml",Te(i,o,i0(e.Themes,t)),n.themes.push(o),Be(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),o="xl/styles."+r,Te(i,o,c1(e,o,t)),n.styles.push(o),Be(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",Te(i,o,e.vbaraw),n.vba.push(o),Be(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),o="xl/metadata."+r,Te(i,o,f1(o)),n.metadata.push(o),Be(t.wbrels,-1,"metadata."+r,Oe.XLMETA),Te(i,"[Content_Types].xml",Wl(n,t)),Te(i,"_rels/.rels",la(t.rels)),Te(i,"xl/_rels/workbook."+r+".rels",la(t.wbrels)),delete t.revssf,delete t.ssf,i}function iv(e,t){sa=1024,e&&!e.SSF&&(e.SSF=Fr(Qe)),e&&e.SSF&&(Vs(),Hs(e.SSF),t.revssf=Gs(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ia?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=d0.indexOf(t.bookType)>-1,n=Bl();li(t=t||{});var i=Gn(),o="",l=0;if(t.cellXfs=[],At(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Te(i,o,zl(e.Props,t)),n.coreprops.push(o),Be(t.rels,2,o,Oe.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,Te(i,o,Vl(e.Props)),n.extprops.push(o),Be(t.rels,3,o,Oe.EXT_PROPS),e.Custprops!==e.Props&&xr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Te(i,o,Gl(e.Custprops)),n.custprops.push(o),Be(t.rels,4,o,Oe.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],f=(m||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Te(i,o,b0(l-1,t,e,h)),n.sheets.push(o),Be(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Oe.WS[0])}if(m){var g=m["!comments"],x=!1,p="";if(g&&g.length>0){var w=!1;g.forEach(function(b){b[1].forEach(function(y){y.T==!0&&(w=!0)})}),w&&(p="xl/threadedComments/threadedComment"+l+"."+r,Te(i,p,Rx(g,u,t)),n.threadedcomments.push(p),Be(h,-1,"../threadedComments/threadedComment"+l+"."+r,Oe.TCMNT)),p="xl/comments"+l+"."+r,Te(i,p,c0(g)),n.comments.push(p),Be(h,-1,"../comments"+l+"."+r,Oe.CMNT),x=!0}m["!legacy"]&&x&&Te(i,"xl/drawings/vmlDrawing"+l+".vml",l0(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}h["!id"].rId1&&Te(i,Ul(o),la(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Te(i,o,e0(t.Strings,t)),n.strs.push(o),Be(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),o="xl/workbook."+r,Te(i,o,N0(e)),n.workbooks.push(o),Be(t.rels,1,o,Oe.WB),o="xl/theme/theme1.xml",Te(i,o,i0(e.Themes,t)),n.themes.push(o),Be(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),o="xl/styles."+r,Te(i,o,s0(e,t)),n.styles.push(o),Be(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",Te(i,o,e.vbaraw),n.vba.push(o),Be(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),o="xl/metadata."+r,Te(i,o,o0()),n.metadata.push(o),Be(t.wbrels,-1,"metadata."+r,Oe.XLMETA),u.length>1&&(o="xl/persons/person.xml",Te(i,o,Lx(u)),n.people.push(o),Be(t.wbrels,-1,"persons/person.xml",Oe.PEOPLE)),Te(i,"[Content_Types].xml",Wl(n,t)),Te(i,"_rels/.rels",la(t.rels)),Te(i,"xl/_rels/workbook."+r+".rels",la(t.wbrels)),delete t.revssf,delete t.ssf,i}function ov(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=xt(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function C0(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ja(t.file,$e.write(e,{type:Me?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return $e.write(e,t)}function lv(e,t){var r=Fr(t||{}),s=sv(e,r);return cv(s,r)}function cv(e,t){var r={},s=Me?"nodebuffer":typeof Uint8Array!="undefined"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?$e.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno!="undefined"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(zs(n))}return t.password&&typeof encrypt_agile!="undefined"?C0(encrypt_agile(n,t.password),t):t.type==="file"?Ja(t.file,n):t.type=="string"?Fa(n):n}function dv(e,t){var r=t||{},s=S1(e,r);return C0(s,r)}function et(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return Ua(za(s));case"binary":return za(s);case"string":return e;case"file":return Ja(t.file,s,"utf8");case"buffer":return Me?pt(s,"utf8"):typeof TextEncoder!="undefined"?new TextEncoder().encode(s):et(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function uv(e,t){switch(t.type){case"base64":return Ua(e);case"binary":return e;case"string":return e;case"file":return Ja(t.file,e,"binary");case"buffer":return Me?pt(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ps(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?Ua(r):t.type=="string"?Fa(r):r;case"file":return Ja(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function A0(e,t){Lu(),Kg(e);var r=Fr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=A0(e,r);return r.type="array",zs(s)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return et(_1(e,r),r);case"slk":case"sylk":return et(Yh.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return et(E0(e.Sheets[e.SheetNames[n]],r),r);case"txt":return uv(D0(e.Sheets[e.SheetNames[n]],r),r);case"csv":return et(ci(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return et(Xh.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return ps(Gh.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return et(qh.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return et(tx.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return et(Zl.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return et(T0(e,r),r);case"wk1":return ps(jo.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return ps(jo.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ps(_0(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),dv(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return lv(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function fv(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function hv(e,t,r){var s={};return s.type="file",s.file=t,fv(s),A0(e,s)}function xv(e,t,r,s,n,i,o,l){var d=hr(r),c=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,m=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!o||e[r])for(var f=t.s.c;f<=t.e.c;++f){var g=o?e[r][f]:e[s[f]+d];if(g===void 0||g.t===void 0){if(c===void 0)continue;i[f]!=null&&(m[i[f]]=c);continue}var x=g.v;switch(g.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[f]!=null){if(x==null)if(g.t=="e"&&x===null)m[i[f]]=null;else if(c!==void 0)m[i[f]]=c;else if(u&&x===null)m[i[f]]=null;else continue;else m[i[f]]=u&&(g.t!=="n"||g.t==="n"&&l.rawNumbers!==!1)?x:mt(g,x,l);x!=null&&(h=!1)}}return{row:m,isempty:h}}function Bs(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,i=[],o=0,l="",d={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?s=1:c.header==="A"?s=2:Array.isArray(c.header)?s=3:c.header==null&&(s=0),typeof u){case"string":d=Ve(u);break;case"number":d=Ve(e["!ref"]),d.s.r=u;break;default:d=u}s>0&&(n=0);var h=hr(d.s.r),m=[],f=[],g=0,x=0,p=Array.isArray(e),w=d.s.r,b=0,y={};p&&!e[w]&&(e[w]=[]);var S=c.skipHidden&&e["!cols"]||[],P=c.skipHidden&&e["!rows"]||[];for(b=d.s.c;b<=d.e.c;++b)if(!(S[b]||{}).hidden)switch(m[b]=pr(b),r=p?e[w][b]:e[m[b]+h],s){case 1:i[b]=b-d.s.c;break;case 2:i[b]=m[b];break;case 3:i[b]=c.header[b-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=mt(r,null,c),x=y[o]||0,!x)y[o]=1;else{do l=o+"_"+x++;while(y[l]);y[o]=x,y[l]=1}i[b]=l}for(w=d.s.r+n;w<=d.e.r;++w)if(!(P[w]||{}).hidden){var L=xv(e,d,w,m,s,i,p,c);(L.isempty===!1||(s===1?c.blankrows!==!1:c.blankrows))&&(f[g++]=L.row)}return f.length=g,f}var Do=/"/g;function mv(e,t,r,s,n,i,o,l){for(var d=!0,c=[],u="",h=hr(r),m=t.s.c;m<=t.e.c;++m)if(s[m]){var f=l.dense?(e[r]||[])[m]:e[s[m]+h];if(f==null)u="";else if(f.v!=null){d=!1,u=""+(l.rawNumbers&&f.t=="n"?f.v:mt(f,null,l));for(var g=0,x=0;g!==u.length;++g)if((x=u.charCodeAt(g))===n||x===i||x===34||l.forceQuotes){u='"'+u.replace(Do,'""')+'"';break}u=="ID"&&(u='"ID"')}else f.f!=null&&!f.F?(d=!1,u="="+f.f,u.indexOf(",")>=0&&(u='"'+u.replace(Do,'""')+'"')):u="";c.push(u)}return l.blankrows===!1&&d?null:c.join(o)}function ci(e,t){var r=[],s=t==null?{}:t;if(e==null||e["!ref"]==null)return"";var n=Ve(e["!ref"]),i=s.FS!==void 0?s.FS:",",o=i.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,d=l.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",h=[];s.dense=Array.isArray(e);for(var m=s.skipHidden&&e["!cols"]||[],f=s.skipHidden&&e["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(m[g]||{}).hidden||(h[g]=pr(g));for(var x=0,p=n.s.r;p<=n.e.r;++p)(f[p]||{}).hidden||(u=mv(e,n,p,h,o,d,i,s),u!=null&&(s.strip&&(u=u.replace(c,"")),(u||s.blankrows!==!1)&&r.push((x++?l:"")+u)));return delete s.dense,r.join("")}function D0(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=ci(e,t);return r}function pv(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=Ve(e["!ref"]),i="",o=[],l,d=[],c=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)o[l]=pr(l);for(var u=n.s.r;u<=n.e.r;++u)for(i=hr(u),l=n.s.c;l<=n.e.c;++l)if(t=o[l]+i,r=c?(e[u]||[])[l]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}d[d.length]=t+"="+s}return d}function F0(e,t,r){var s=r||{},n=+!s.skipHeader,i=e||{},o=0,l=0;if(i&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var d=typeof s.origin=="string"?or(s.origin):s.origin;o=d.r,l=d.c}var c,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+n}};if(i["!ref"]){var h=Ve(i["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+t.length-1+n)}else o==-1&&(o=0,u.e.r=t.length-1+n);var m=s.header||[],f=0;t.forEach(function(x,p){xr(x).forEach(function(w){(f=m.indexOf(w))==-1&&(m[f=m.length]=w);var b=x[w],y="z",S="",P=Ue({c:l+f,r:o+p+n});c=Ga(i,P),b&&typeof b=="object"&&!(b instanceof Date)?i[P]=b:(typeof b=="number"?y="n":typeof b=="boolean"?y="b":typeof b=="string"?y="s":b instanceof Date?(y="d",s.cellDates||(y="n",b=Dr(b)),S=s.dateNF||Qe[14]):b===null&&s.nullError&&(y="e",b=0),c?(c.t=y,c.v=b,delete c.w,delete c.R,S&&(c.z=S)):i[P]=c={t:y,v:b},S&&(c.z=S))})}),u.e.c=Math.max(u.e.c,l+m.length-1);var g=hr(o);if(n)for(f=0;f<m.length;++f)i[pr(f+l)+g]={t:"s",v:m[f]};return i["!ref"]=tr(u),i}function gv(e,t){return F0(null,e,t)}function Ga(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=or(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ga(e,Ue(t)):Ga(e,Ue({r:t,c:r||0}))}function vv(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function bv(){return{SheetNames:[],Sheets:{}}}function wv(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(y0(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function yv(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=vv(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function Nv(e,t){return e.z=t,e}function P0(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function jv(e,t,r){return P0(e,"#"+t,r)}function _v(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Ev(e,t,r,s){for(var n=typeof t!="string"?t:Ve(t),i=typeof t=="string"?t:tr(t),o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var d=Ga(e,o,l);d.t="n",d.F=i,delete d.v,o==n.s.r&&l==n.s.c&&(d.f=r,s&&(d.D=!0))}return e}var pn={encode_col:pr,encode_row:hr,encode_cell:Ue,encode_range:tr,decode_col:Qn,decode_row:Jn,split_cell:Bf,decode_cell:or,decode_range:Br,format_cell:mt,sheet_add_aoa:Pl,sheet_add_json:F0,sheet_add_dom:S0,aoa_to_sheet:ma,json_to_sheet:gv,table_to_sheet:k0,table_to_book:X1,sheet_to_csv:ci,sheet_to_txt:D0,sheet_to_json:Bs,sheet_to_html:E0,sheet_to_formulae:pv,sheet_to_row_object_array:Bs,sheet_get_cell:Ga,book_new:bv,book_append_sheet:wv,book_set_sheet_visibility:yv,cell_set_number_format:Nv,cell_set_hyperlink:P0,cell_set_internal_link:jv,cell_add_comment:_v,sheet_set_array_formula:Ev,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Sv=({isOpen:e,onClose:t,inventory:r=[],onSnapshotCreated:s,onInventoryReset:n})=>{const{user:i}=er(),{showSuccess:o,showError:l,showWarning:d}=Er(),[c,u]=O.useState({items:[]}),[h,m]=O.useState(!1),[f,g]=O.useState(!1);O.useEffect(()=>{if(e&&r.length>0){const y=r.map(S=>{const P=S.initialStock||0,L=S.entries||0,I=S.exits||0,H=S.sales||0,W=P+L-I-H,J=S.stock||S.currentStock||S.quantity||0,ee=S.realStock||J;return{productId:S._id,productName:S.name||"Sin nombre",category:S.category||"Sin categoría",initialStock:P,entries:L,exits:I,sales:H,expectedStock:W,realStock:ee,difference:ee-W}});u({items:y})}},[e,r]);const x=async()=>{try{console.log("🔄 Reiniciando inventario después del snapshot...");const y=c.items.map(S=>{const P=r.find(L=>L._id===S.productId);return P?{productId:S.productId,name:P.name,code:P.code,category:P.category,price:P.price,description:P.description,minStock:P.minStock,unit:P.unit,initialStock:S.realStock,entries:0,exits:0,sales:0,realStock:S.realStock,stock:S.realStock}:null}).filter(Boolean);console.log("📦 Datos para reiniciar inventario:",y);for(const S of y)await lt.updateInventoryItem(S.productId,{name:S.name,code:S.code,category:S.category,price:S.price,description:S.description,minStock:S.minStock,unit:S.unit,initialStock:S.initialStock,entries:S.entries,exits:S.exits,sales:S.sales,realStock:S.realStock,stock:S.stock});console.log("✅ Inventario reiniciado exitosamente")}catch(y){throw console.error("❌ Error al reiniciar inventario:",y),l("Error al reiniciar el inventario: "+y.message),y}},p=async()=>{try{if(g(!0),c.items.length===0){d("No hay productos para guardar en el snapshot");return}console.log("📸 Guardando snapshot de inventario:",c),(await vs.createSnapshot(c)).success&&(console.log("✅ Snapshot guardado, ahora reiniciando inventario..."),await x(),o("Inventario guardado y reiniciado exitosamente"),s&&s(),n&&n(),t())}catch(y){console.error("❌ Error al guardar snapshot o reiniciar inventario:",y),l(y.message||"Error al guardar el snapshot de inventario")}finally{g(!1)}},w=y=>y>0?{icon:a.jsx($s,{className:"w-4 h-4 text-green-400"}),text:`+${y}`,className:"text-green-400 bg-green-900/30"}:y<0?{icon:a.jsx(xc,{className:"w-4 h-4 text-red-400"}),text:y.toString(),className:"text-red-400 bg-red-900/30"}:{icon:a.jsx(Bo,{className:"w-4 h-4 text-gray-400"}),text:"0",className:"text-gray-400 bg-gray-900/30"},b=c.items.reduce((y,S)=>y+S.difference,0);return e?a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[a.jsx("style",{children:`
          .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
          }
          
          .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
          }
          
          .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #ffffff;
            border-radius: 3px;
            box-shadow: 0 0 6px rgba(59, 130, 246, 0.6), 0 0 12px rgba(59, 130, 246, 0.4);
          }
          
          .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #f3f4f6;
            box-shadow: 0 0 8px rgba(59, 130, 246, 0.8), 0 0 16px rgba(59, 130, 246, 0.5);
          }
          
          .custom-scrollbar {
            scrollbar-width: thin;
            scrollbar-color: #ffffff transparent;
          }
        `}),a.jsxs("div",{className:"fixed inset-0 bg-gradient-to-b from-black via-gray-900 to-black overflow-hidden",onClick:t,children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-900/8 via-blue-900/8 to-red-900/8"}),a.jsx("div",{className:"absolute inset-0 opacity-40",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.3) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"radial-gradient(circle, rgba(239, 68, 68, 0.4) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-15",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.5) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}})]}),a.jsx("div",{className:"relative z-10 flex min-h-full items-center justify-center p-4",children:a.jsxs("div",{className:"bg-transparent border border-white/10 rounded-2xl backdrop-blur-sm shadow-2xl shadow-blue-500/20 w-full max-w-6xl h-[90vh] flex flex-col",onClick:y=>y.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Us,{className:"w-6 h-6 text-blue-400"}),a.jsxs("div",{children:[a.jsx(Ze,{className:"text-xl font-semibold",children:"Guardar Inventario"}),a.jsx("p",{className:"text-sm text-gray-300",children:"Registra el estado actual del inventario"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"text-sm text-gray-300",children:["Total diferencia:",a.jsxs("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${b>0?"text-green-300 bg-green-900/30":b<0?"text-red-300 bg-red-900/30":"text-gray-300 bg-gray-900/30"}`,children:[b>0?"+":"",b]})]}),a.jsx("button",{onClick:t,className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 hover:text-white",children:a.jsx(qr,{className:"w-5 h-5"})})]})]}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx("div",{className:"h-full overflow-auto custom-scrollbar",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-white/5 sticky top-0 backdrop-blur-sm",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Producto"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Inicial"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Entradas"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Salidas"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Ventas"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Stock Sistema"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Stock Real"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Diferencia"})]})}),a.jsx("tbody",{className:"divide-y divide-white/10",children:c.items.map((y,S)=>{const P=w(y.difference);return a.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[a.jsxs("td",{className:"px-4 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"font-medium text-white",children:y.productName}),a.jsx("div",{className:"text-xs text-gray-400 capitalize",children:y.category})]}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsx("span",{className:"font-medium text-gray-300",children:y.initialStock})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsx("span",{className:"font-medium text-green-400",children:y.entries})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsx("span",{className:"font-medium text-red-400",children:y.exits})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsx("span",{className:"font-medium text-orange-400",children:y.sales})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsx("span",{className:"font-medium text-purple-400",children:y.expectedStock})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsx("span",{className:"font-medium text-blue-400",children:y.realStock})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${P.className}`,children:[P.icon,P.text]})})]},y.productId)})})]})})}),a.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-white/10 bg-white/5 backdrop-blur-sm",children:[a.jsxs("div",{className:"text-sm text-gray-300",children:[c.items.length," productos • Registro del ",new Date().toLocaleDateString("es-ES")]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(He,{onClick:t,variant:"secondary",className:"px-4 py-2 text-gray-200",children:"Cancelar"}),a.jsx(He,{onClick:p,disabled:f||c.items.length===0,className:"inline-flex items-center justify-center gap-2 px-4 py-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jt,{className:"w-4 h-4 flex-shrink-0"}),a.jsx("span",{children:f?"Guardando...":"Guardar Inventario"})]})})]})]})]})})]}):null},kv=({isOpen:e,onClose:t})=>{const[r,s]=O.useState([]),[n,i]=O.useState(!1),[o,l]=O.useState({}),[d,c]=O.useState({}),{showSuccess:u,showError:h}=Er();O.useEffect(()=>{e&&m()},[e]);const m=async()=>{try{i(!0);const w=await vs.getSnapshots({limit:50,page:1});s(w.data||[])}catch(w){console.error("Error al cargar inventarios guardados:",w),h("Error al cargar los inventarios guardados")}finally{i(!1)}},f=async w=>{try{l(L=>({...L,[w._id]:!0}));const b=await vs.downloadSnapshot(w._id),y=window.URL.createObjectURL(b),S=document.createElement("a");S.href=y;const P=new Date(w.date).toLocaleDateString("es-ES").replace(/\//g,"-");S.download=`inventario-guardado-${P}.xlsx`,document.body.appendChild(S),S.click(),document.body.removeChild(S),window.URL.revokeObjectURL(y),u("Inventario descargado exitosamente")}catch(b){console.error("Error al descargar inventario:",b),h("Error al descargar el inventario")}finally{l(b=>({...b,[w._id]:!1}))}},g=async w=>{if(window.confirm("¿Estás seguro de que quieres eliminar este inventario guardado? Esta acción no se puede deshacer."))try{c(b=>({...b,[w._id]:!0})),await vs.deleteSnapshot(w._id),s(b=>b.filter(y=>y._id!==w._id)),u("Inventario eliminado exitosamente")}catch(b){console.error("Error al eliminar inventario:",b),h("Error al eliminar el inventario")}finally{c(b=>({...b,[w._id]:!1}))}},x=w=>new Date(w).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=w=>w===0?{text:"0",color:"text-gray-600"}:w>0?{text:`+${w}`,color:"text-green-600"}:{text:w.toString(),color:"text-red-600"};return e?a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[a.jsx("style",{children:`
          .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
          }
          
          .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
          }
          
          .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #ffffff;
            border-radius: 3px;
            box-shadow: 0 0 6px rgba(59, 130, 246, 0.6), 0 0 12px rgba(59, 130, 246, 0.4);
          }
          
          .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #f3f4f6;
            box-shadow: 0 0 8px rgba(59, 130, 246, 0.8), 0 0 16px rgba(59, 130, 246, 0.5);
          }
          
          .custom-scrollbar {
            scrollbar-width: thin;
            scrollbar-color: #ffffff transparent;
          }
        `}),a.jsxs("div",{className:"fixed inset-0 bg-gradient-to-b from-black via-gray-900 to-black overflow-hidden",onClick:t,children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-900/8 via-blue-900/8 to-red-900/8"}),a.jsx("div",{className:"absolute inset-0 opacity-40",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.3) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"radial-gradient(circle, rgba(239, 68, 68, 0.4) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-15",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.5) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}})]}),a.jsx("div",{className:"relative z-10 flex min-h-full items-center justify-center p-4 py-8",children:a.jsxs("div",{className:"relative w-full max-w-4xl max-h-[85vh] bg-transparent border border-white/10 rounded-2xl backdrop-blur-sm shadow-2xl shadow-blue-500/20 flex flex-col",onClick:w=>w.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(ys,{className:"h-8 w-8 text-blue-400"}),a.jsxs("div",{children:[a.jsx(Ze,{className:"text-lg font-medium",children:"Inventarios Guardados"}),a.jsx("p",{className:"text-sm text-gray-300",children:"Historial de inventarios registrados"})]})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white transition-colors",children:a.jsx(qr,{className:"h-6 w-6"})})]}),a.jsxs("div",{className:"flex-1 overflow-hidden p-6 pt-2",children:[n&&a.jsxs("div",{className:"flex justify-center items-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400"}),a.jsx("span",{className:"ml-2 text-gray-300",children:"Cargando inventarios..."})]}),!n&&r.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(ys,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-white",children:"No hay inventarios guardados"}),a.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Aún no se han registrado inventarios."})]}),!n&&r.length>0&&a.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto custom-scrollbar",children:r.map(w=>{var P;const b=p(w.totalDifference),y=o[w._id],S=d[w._id];return a.jsx("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10 hover:bg-white/10 transition-colors backdrop-blur-sm",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[a.jsxs("div",{className:"flex items-center text-sm text-gray-300",children:[a.jsx(nr,{className:"h-4 w-4 mr-1"}),x(w.date)]}),a.jsxs("div",{className:"flex items-center text-sm text-gray-300",children:[a.jsx(Nr,{className:"h-4 w-4 mr-1"}),((P=w.createdBy)==null?void 0:P.name)||"Usuario"]})]}),a.jsxs("div",{className:"flex items-center space-x-6",children:[a.jsxs("div",{className:"flex items-center text-sm",children:[a.jsx(fa,{className:"h-4 w-4 mr-1 text-blue-400"}),a.jsxs("span",{className:"text-white font-medium",children:[w.totalItems," productos"]})]}),a.jsxs("div",{className:"flex items-center text-sm",children:[a.jsx("span",{className:"text-white font-medium mr-1",children:"Diferencia:"}),a.jsx("span",{className:`font-semibold ${b.color==="text-gray-600"?"text-gray-300":b.color==="text-green-600"?"text-green-300":"text-red-300"}`,children:b.text})]})]}),w.notes&&a.jsxs("p",{className:"text-sm text-gray-300 mt-2 italic",children:['"',w.notes,'"']})]}),a.jsxs("div",{className:"ml-4 flex items-center gap-3",children:[a.jsx(He,{onClick:()=>f(w),disabled:y,className:"inline-flex items-center justify-center px-3 py-2 text-sm leading-4 font-medium",children:y?a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),a.jsx("span",{children:"Descargando..."})]}):a.jsxs("div",{className:"flex items-center",children:[a.jsx(On,{className:"h-4 w-4 mr-2 flex-shrink-0"}),a.jsx("span",{children:"Descargar"})]})}),a.jsx("button",{onClick:()=>g(w),disabled:S,className:"p-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Eliminar inventario",children:S?a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-400"}):a.jsx(Xa,{className:"h-4 w-4"})})]})]})},w._id)})})]}),a.jsx("div",{className:"flex justify-end p-6 border-t border-white/10",children:a.jsx(He,{type:"button",onClick:t,variant:"secondary",className:"px-4 py-2 text-sm font-medium",children:"Cerrar"})})]})})]}):null},Tv=()=>{const{user:e}=er(),{refreshTrigger:t,needsRefresh:r,markRefreshed:s}=Ho(),[n,i]=O.useState([]),[o,l]=O.useState(!0),[d,c]=O.useState(""),[u,h]=O.useState(""),[m,f]=O.useState(null),[g,x]=O.useState(""),[p,w]=O.useState(null),[b,y]=O.useState({name:"",code:"",category:"insumos",initialStock:"",entries:"",exits:"",minStock:"",realStock:"",price:"",description:""}),[S,P]=O.useState(null),[L,I]=O.useState(null),[H,W]=O.useState({type:"entry",quantity:"",reason:"",notes:""}),[J,ee]=O.useState({quantity:"1"}),[R,q]=O.useState({realStock:"",entries:"",exits:"",notes:""}),[be,he]=O.useState(!1),[je,le]=O.useState(!1),M=["cannabicos","gorras","insumos","productos_pelo","lociones","ceras","geles","maquinas","accesorios","otros"];O.useEffect(()=>{ie()},[]),O.useEffect(()=>{console.log("🔄 InventoryAdmin: useEffect trigger -",{refreshTrigger:t,lastRefreshTime:m,needsRefresh:r(m)}),r(m)&&(console.log("🔄 InventoryAdmin: Detectada venta nueva, recargando..."),ie())},[t,m,r]),O.useEffect(()=>{console.log("🔄 InventoryAdmin: Componente montado, verificando si necesita recarga..."),r(m)&&(console.log("🔄 InventoryAdmin: Necesita recarga al montar, ejecutando..."),ie())},[]);const ie=async()=>{try{l(!0),console.log("🔄 InventoryAdmin: Cargando inventario...");const Q=Date.now(),ce=await lt.getInventory({_t:Q});let D=[];ce&&ce.data&&Array.isArray(ce.data)?D=ce.data:ce&&Array.isArray(ce.success)&&(D=ce.success),i(D),f(s()),console.log("✅ InventoryAdmin: Inventario cargado, productos:",D.length)}catch(Q){console.error("❌ InventoryAdmin: Error al cargar inventario:",Q),c("Error al cargar el inventario"),i([])}finally{l(!1)}},B=async Q=>{Q.preventDefault();try{const ce={...b,initialStock:b.initialStock?parseInt(b.initialStock,10):0,entries:b.entries?parseInt(b.entries,10):0,exits:b.exits?parseInt(b.exits,10):0,stock:b.initialStock?parseInt(b.initialStock,10):0,minStock:b.minStock?parseInt(b.minStock,10):0,realStock:b.realStock?parseInt(b.realStock,10):void 0,price:b.price?parseFloat(b.price):0};S?(await lt.updateInventoryItem(S._id,ce),h("Producto actualizado exitosamente")):(await lt.createInventoryItem(ce),h("Producto creado exitosamente")),ne(),w(null),ie(),setTimeout(()=>h(""),3e3)}catch(ce){console.error("Error al guardar producto:",ce),c(ce.message||"Error al guardar el producto"),setTimeout(()=>c(""),3e3)}},ne=()=>{y({name:"",code:"",category:"insumos",initialStock:"",entries:"",exits:"",minStock:"",realStock:"",price:"",description:""}),P(null)},C=Q=>{var ce,D,ae,_e,Pe,De;y({name:Q.name,code:Q.code||"",category:Q.category,initialStock:((ce=Q.initialStock)==null?void 0:ce.toString())||"",entries:((D=Q.entries)==null?void 0:D.toString())||"",exits:((ae=Q.exits)==null?void 0:ae.toString())||"",minStock:((_e=Q.minStock)==null?void 0:_e.toString())||"",realStock:((Pe=Q.realStock)==null?void 0:Pe.toString())||"",price:((De=Q.price)==null?void 0:De.toString())||"",description:Q.description||""}),P(Q),w("form")},A=async Q=>{if(window.confirm("¿Estás seguro de que quieres eliminar este producto?"))try{await lt.deleteInventoryItem(Q),h("Producto eliminado exitosamente"),ie(),setTimeout(()=>h(""),3e3)}catch(ce){console.error("Error al eliminar producto:",ce),c("Error al eliminar el producto"),setTimeout(()=>c(""),3e3)}},N=()=>{ne(),w("form")},_=Q=>{I(Q),W({type:"entry",quantity:"",reason:"",notes:""}),w("movement")},U=Q=>{I(Q),ee({quantity:"1"}),w("sale")},re=Q=>{I(Q),q({realStock:Q.realStock||Q.stock||"",entries:"",exits:"",notes:""}),w("count")},z=()=>{he(!1),ie()},K=Q=>{const ce=Q.realStock||Q.stock||Q.currentStock||Q.quantity||0,D=Q.minStock||0;return ce<=0?{status:"out",label:"Sin stock",color:"text-red-400",bgColor:"bg-red-500/10"}:ce<=D?{status:"low",label:"Stock bajo",color:"text-yellow-400",bgColor:"bg-yellow-500/10"}:{status:"good",label:"Stock normal",color:"text-green-400",bgColor:"bg-green-500/10"}},Z=Array.isArray(n)?n.filter(Q=>Q.name.toLowerCase().includes(g.toLowerCase())||Q.category.toLowerCase().includes(g.toLowerCase())):[],de=async Q=>{Q.preventDefault();try{const ce=parseInt(H.quantity),D=L.stock||L.currentStock||L.quantity||0;let ae,_e=L.entries||0,Pe=L.exits||0;H.type==="entry"?(ae=D+ce,_e+=ce):(ae=Math.max(0,D-ce),Pe+=ce);const De={...L,stock:ae,entries:_e,exits:Pe,quantity:ae};await lt.updateInventoryItem(L._id,De),h(`Movimiento registrado exitosamente: ${H.type==="entry"?"Entrada":"Salida"} de ${ce} unidades`),W({type:"entry",quantity:"",reason:"",notes:""}),w(null),ie(),setTimeout(()=>h(""),3e3)}catch(ce){console.error("Error al registrar movimiento:",ce),c("Error al registrar el movimiento"),setTimeout(()=>c(""),3e3)}},ge=async Q=>{Q.preventDefault();try{const ce=parseInt(J.quantity),D=L.stock||L.currentStock||L.quantity||0;if(ce>D){c("No hay suficiente stock para realizar esta venta"),setTimeout(()=>c(""),3e3);return}const ae={productId:L._id,quantity:ce,barberId:e._id,customerName:`Venta directa - ${e.name}`,notes:`Venta registrada por ${e.name} desde inventario`};if(!(await fetch("/api/v1/sales",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(ae)})).ok)throw new Error("Error al registrar la venta");const Pe=D-ce,De=(L.exits||0)+ce,Ce=(L.sales||0)+ce,Wr={...L,stock:Pe,exits:De,sales:Ce,quantity:Pe};await lt.updateInventoryItem(L._id,Wr),h(`Venta registrada exitosamente: ${ce} unidades`),ee({quantity:"1"}),w(null),ie(),setTimeout(()=>h(""),3e3)}catch(ce){console.error("Error al registrar venta:",ce),c("Error al registrar la venta"),setTimeout(()=>c(""),3e3)}},Se=async Q=>{Q.preventDefault();try{const ce=parseInt(R.realStock)||0,D=parseInt(R.entries)||0,ae=parseInt(R.exits)||0,_e={...L,realStock:ce,entries:(L.entries||0)+D,exits:(L.exits||0)+ae,notes:R.notes};await lt.updateInventoryItem(L._id,_e),h(`Conteo registrado exitosamente para ${L.name}`),q({realStock:"",entries:"",exits:"",notes:""}),w(null),ie(),setTimeout(()=>h(""),3e3)}catch(ce){console.error("Error al registrar conteo:",ce),c("Error al registrar el conteo"),setTimeout(()=>c(""),3e3)}},Ne=()=>{try{const Q=Z.map(Ce=>({Código:Ce.code||"",Nombre:Ce.name||"",Categoría:Ce.category?Ce.category.replace("_"," ").toUpperCase():"","Stock Inicial":Ce.initialStock||0,Entradas:Ce.entries||0,Salidas:Ce.exits||0,"Stock Actual":Ce.stock||Ce.currentStock||Ce.quantity||0,"Stock Mínimo":Ce.minStock||0,Precio:Ce.price?`$${Ce.price.toLocaleString("es-CO")}`:"$0",Estado:(Ce.stock||Ce.currentStock||Ce.quantity||0)<=(Ce.minStock||0)?"Stock Bajo":"Normal",Descripción:Ce.description||""})),ce=pn.json_to_sheet(Q),D=Ce=>Math.max(...Ce.map(Wr=>(Wr||"").toString().length)),ae=Object.keys(Q[0]||{}).map(Ce=>({wch:Math.min(Math.max(D(Q.map(Wr=>Wr[Ce])),Ce.length),50)}));ce["!cols"]=ae;const _e=pn.book_new();pn.book_append_sheet(_e,ce,"Inventario");const Pe=new Date,De=`inventario_${Pe.getFullYear()}-${(Pe.getMonth()+1).toString().padStart(2,"0")}-${Pe.getDate().toString().padStart(2,"0")}.xlsx`;hv(_e,De),h(`Inventario exportado exitosamente: ${De}`),setTimeout(()=>h(""),3e3)}catch(Q){console.error("Error al exportar inventario:",Q),c("Error al exportar el inventario"),setTimeout(()=>c(""),3e3)}};return a.jsxs("div",{className:"relative min-h-screen bg-gradient-to-b from-black via-gray-900 to-black overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-900/8 via-blue-900/8 to-red-900/8"}),a.jsx("div",{className:"absolute inset-0 opacity-40",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.3) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"radial-gradient(circle, rgba(239, 68, 68, 0.4) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-15",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.5) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}}),a.jsxs("div",{className:"relative z-10",children:[a.jsx(Ye,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"text-center py-8",children:a.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:a.jsxs(Ze,{className:"text-4xl md:text-5xl font-bold",children:[a.jsx(an,{className:"w-10 h-10 mx-auto mb-3"}),"Gestión de Inventario"]})})}),d&&a.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 text-red-400 px-4 py-2 rounded-xl backdrop-blur-sm flex items-center gap-2",children:[a.jsx(Pn,{className:"w-4 h-4"}),d]}),u&&a.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 text-green-400 px-4 py-2 rounded-xl backdrop-blur-sm flex items-center gap-2",children:[a.jsx(ua,{className:"w-4 h-4"}),u]}),a.jsxs("div",{className:"bg-transparent border border-white/10 rounded-2xl backdrop-blur-sm shadow-2xl shadow-blue-500/20",children:[a.jsxs("div",{className:"p-4 border-b border-white/10 flex flex-col sm:flex-row gap-4 items-center justify-between",children:[a.jsxs("div",{className:"flex gap-3",children:[(e==null?void 0:e.role)==="admin"&&a.jsx(He,{onClick:N,className:"text-sm px-8 py-2 min-w-[180px]",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(Ca,{className:"w-4 h-4"}),a.jsx("span",{children:"Nuevo Producto"})]})}),(e==null?void 0:e.role)==="admin"&&a.jsxs("button",{onClick:Ne,className:"flex items-center gap-2 px-4 py-2 bg-green-500/20 hover:bg-green-500/30 text-green-400 border border-green-500/30 rounded-lg transition-colors text-sm",disabled:Z.length===0,children:[a.jsx(On,{className:"w-4 h-4"}),a.jsx("span",{children:"Exportar Excel"})]}),(e==null?void 0:e.role)==="admin"&&a.jsxs("button",{onClick:()=>he(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 border border-blue-500/30 rounded-lg transition-colors text-sm",disabled:Z.length===0,children:[a.jsx(Us,{className:"w-4 h-4"}),a.jsx("span",{children:"Guardar Inventario"})]}),(e==null?void 0:e.role)==="admin"&&a.jsxs("button",{onClick:()=>le(!0),className:"flex items-center gap-2 px-4 py-2 bg-purple-500/20 hover:bg-purple-500/30 text-purple-400 border border-purple-500/30 rounded-lg transition-colors text-sm",children:[a.jsx(nr,{className:"w-4 h-4"}),a.jsx("span",{children:"Ver Inventarios"})]})]}),a.jsxs("div",{className:"relative w-full sm:w-64",children:[a.jsx(Fn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Buscar productos...",value:g,onChange:Q=>x(Q.target.value),className:"w-full pl-9 pr-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-400 focus:border-blue-500/50 text-sm backdrop-blur-sm"})]})]}),p==="form"&&(e==null?void 0:e.role)==="admin"&&a.jsxs("div",{className:"mx-4 mt-4 bg-white/5 border border-white/10 rounded-xl p-6 backdrop-blur-md shadow-2xl shadow-blue-500/20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:a.jsx(Ze,{className:"text-lg font-semibold",children:S?"Editar Producto":"Nuevo Producto"})}),a.jsx("button",{onClick:()=>w(null),className:"text-gray-400 hover:text-white transition-colors",children:a.jsx(Sa,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:B,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Nombre"}),a.jsx("input",{type:"text",value:b.name,onChange:Q=>y({...b,name:Q.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Código"}),a.jsx("input",{type:"text",value:b.code,onChange:Q=>y({...b,code:Q.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",placeholder:"Ej: PRD001",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Categoría"}),a.jsx("select",{value:b.category,onChange:Q=>y({...b,category:Q.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",children:M.map(Q=>a.jsx("option",{value:Q,children:Q.replace("_"," ").toUpperCase()},Q))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Stock Inicial"}),a.jsx("input",{type:"number",value:b.initialStock,onChange:Q=>y({...b,initialStock:Q.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Stock Mínimo"}),a.jsx("input",{type:"number",value:b.minStock,onChange:Q=>y({...b,minStock:Q.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",min:"0"})]}),(e==null?void 0:e.role)==="admin"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Stock Real (Conteo)"}),a.jsx("input",{type:"number",value:b.realStock||"",onChange:Q=>y({...b,realStock:Q.target.value}),className:"w-full px-3 py-2 bg-blue-500/10 border border-blue-500/30 rounded-lg text-blue-300 text-sm backdrop-blur-sm focus:border-blue-400 focus:ring-1 focus:ring-blue-400",min:"0",placeholder:"Stock físico contado"}),a.jsx("p",{className:"text-xs text-blue-400/70 mt-1",children:"Stock físico verificado por conteo manual"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Precio"}),a.jsx("input",{type:"number",step:"0.01",value:b.price,onChange:Q=>y({...b,price:Q.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",min:"0"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Descripción"}),a.jsx("input",{type:"text",value:b.description,onChange:Q=>y({...b,description:Q.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm"})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-4 flex gap-3 pt-2",children:[a.jsx(He,{type:"submit",className:"text-sm px-4 py-2",children:S?"Actualizar":"Crear"}),a.jsx("button",{type:"button",onClick:()=>{ne(),w(null)},className:"px-4 py-2 bg-white/5 text-gray-300 rounded-lg hover:bg-white/10 transition-colors text-sm backdrop-blur-sm",children:"Cancelar"})]})]})]}),p==="movement"&&L&&(e==null?void 0:e.role)==="admin"&&a.jsxs("div",{className:"mx-4 mt-4 bg-white/5 border border-white/10 rounded-xl p-6 backdrop-blur-md shadow-2xl shadow-blue-500/20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:a.jsxs(Ze,{className:"text-lg font-semibold",children:["Movimiento - ",L.name]})}),a.jsx("button",{onClick:()=>w(null),className:"text-gray-400 hover:text-white transition-colors",children:a.jsx(Sa,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:de,className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Tipo"}),a.jsxs("select",{value:H.type,onChange:Q=>W({...H,type:Q.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",children:[a.jsx("option",{value:"entry",children:"Entrada"}),a.jsx("option",{value:"exit",children:"Salida"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Cantidad"}),a.jsx("input",{type:"number",value:H.quantity,onChange:Q=>W({...H,quantity:Q.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",min:"1",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Motivo"}),a.jsx("input",{type:"text",value:H.reason,onChange:Q=>W({...H,reason:Q.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm backdrop-blur-sm",required:!0})]}),a.jsxs("div",{className:"flex items-end gap-3",children:[a.jsx(He,{type:"submit",className:"text-sm px-4 py-2",children:"Registrar"}),a.jsx("button",{type:"button",onClick:()=>w(null),className:"px-4 py-2 bg-white/5 text-gray-300 rounded-lg hover:bg-white/10 transition-colors text-sm backdrop-blur-sm",children:"Cancelar"})]})]})]}),p==="sale"&&L&&(e==null?void 0:e.role)==="admin"&&a.jsxs("div",{className:"mx-4 mt-4 bg-white/5 border border-white/10 rounded-xl p-6 backdrop-blur-md shadow-2xl shadow-blue-500/20",children:[a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between mb-6 gap-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:a.jsxs(Ze,{className:"text-lg font-semibold",children:["Venta - ",L.name]})}),a.jsxs("div",{className:"mt-2",children:[a.jsxs("span",{className:"text-3xl font-bold text-green-400",children:["$",L.price||0]}),a.jsx("span",{className:"text-sm text-gray-400 ml-2",children:"por unidad"})]})]}),a.jsx("button",{onClick:()=>w(null),className:"text-gray-400 hover:text-white transition-colors lg:self-start",children:a.jsx(Sa,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:ge,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Cantidad"}),a.jsx("input",{type:"number",value:J.quantity,onChange:Q=>ee({...J,quantity:Q.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white text-lg backdrop-blur-sm text-center font-semibold",min:"1",max:L.stock||L.currentStock||L.quantity||0,required:!0}),a.jsxs("p",{className:"text-xs text-gray-400 mt-1 text-center",children:["Stock disponible: ",L.stock||L.currentStock||L.quantity||0]})]}),a.jsxs("div",{className:"flex flex-col justify-center",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Total a Pagar"}),a.jsx("div",{className:"bg-green-500/20 border border-green-500/30 rounded-xl p-4 text-center",children:a.jsxs("span",{className:"text-4xl font-bold text-green-400",children:["$",((parseFloat(J.quantity)||0)*(parseFloat(L.price)||0)).toFixed(2)]})})]})]}),a.jsxs("div",{className:"flex gap-4 pt-4",children:[a.jsx(He,{type:"submit",className:"flex-1 text-base py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(an,{className:"w-5 h-5"}),a.jsx("span",{children:"Registrar Venta"})]})}),a.jsx("button",{type:"button",onClick:()=>w(null),className:"px-6 py-3 bg-white/5 text-gray-300 rounded-lg hover:bg-white/10 transition-colors text-base backdrop-blur-sm",children:"Cancelar"})]})]})]}),p==="count"&&L&&a.jsxs("div",{className:"mx-4 mt-4 bg-white/5 border border-white/10 rounded-xl p-6 backdrop-blur-md shadow-2xl shadow-yellow-500/20",children:[a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between mb-6 gap-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:a.jsxs(Ze,{className:"text-lg font-semibold",children:["Conteo de Stock - ",L.name]})}),a.jsxs("div",{className:"mt-2 text-sm text-gray-400",children:[a.jsxs("div",{children:["Stock Esperado: ",a.jsx("span",{className:"text-purple-400 font-medium",children:L.initialStock+(L.entries||0)-(L.exits||0)-(L.sales||0)})]}),a.jsxs("div",{children:["Stock Actual: ",a.jsx("span",{className:"text-blue-400 font-medium",children:L.realStock||L.stock||0})]})]})]}),a.jsx("button",{onClick:()=>w(null),className:"text-gray-400 hover:text-white transition-colors lg:self-start",children:a.jsx(Sa,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:Se,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Stock Contado"}),a.jsx("input",{type:"number",value:R.realStock,onChange:Q=>q({...R,realStock:Q.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white text-lg backdrop-blur-sm text-center font-semibold",min:"0",placeholder:"Ingrese stock real",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Entradas"}),a.jsx("input",{type:"number",value:R.entries,onChange:Q=>q({...R,entries:Q.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white text-lg backdrop-blur-sm text-center",min:"0",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Salidas"}),a.jsx("input",{type:"number",value:R.exits,onChange:Q=>q({...R,exits:Q.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white text-lg backdrop-blur-sm text-center",min:"0",placeholder:"0"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Notas (Opcional)"}),a.jsx("textarea",{value:R.notes,onChange:Q=>q({...R,notes:Q.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white backdrop-blur-sm",rows:"3",placeholder:"Observaciones del conteo..."})]}),a.jsxs("div",{className:"flex gap-4 pt-4",children:[a.jsx(He,{type:"submit",className:"flex-1 text-base py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(Ci,{className:"w-5 h-5"}),a.jsx("span",{children:"Guardar Conteo"})]})}),a.jsx("button",{type:"button",onClick:()=>w(null),className:"px-6 py-3 bg-white/5 text-gray-300 rounded-lg hover:bg-white/10 transition-colors text-base backdrop-blur-sm",children:"Cancelar"})]})]})]}),a.jsx("div",{className:"px-4 py-2 bg-white/5 border-b border-white/10 backdrop-blur-sm",children:a.jsxs("div",{className:"grid grid-cols-12 gap-2 text-xs font-medium text-gray-300",children:[a.jsx("div",{className:"col-span-2",children:"PRODUCTO"}),a.jsx("div",{className:"col-span-1 text-center",children:"INICIAL"}),a.jsx("div",{className:"col-span-1 text-center",children:"ENTRADAS"}),a.jsx("div",{className:"col-span-1 text-center",children:"SALIDAS"}),a.jsx("div",{className:"col-span-1 text-center",children:"VENTAS"}),a.jsx("div",{className:"col-span-1 text-center",children:"ESPERADO"}),a.jsx("div",{className:"col-span-1 text-center",children:"REAL"}),a.jsx("div",{className:"col-span-1 text-center",children:"DIFERENCIA"}),a.jsx("div",{className:"col-span-1 text-center",children:"ESTADO"}),a.jsx("div",{className:"col-span-2 text-center",children:"ACCIONES"})]})}),o?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}),a.jsx("p",{className:"mt-2 text-gray-400 text-sm",children:"Cargando..."})]}):Z.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(an,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"No hay productos en el inventario"})]}):a.jsx("div",{className:"divide-y divide-white/10",children:Z.map(Q=>{var Dt;const ce=K(Q),D=Q.stock||Q.currentStock||Q.quantity||0,ae=Q.initialStock||0,_e=Q.entries||0,Pe=Q.exits||0,De=Q.sales||0;Q.minStock;const Ce=Q.realStock||D,Wr=ae+_e-Pe-De,Pr=Ce-Wr;return a.jsx("div",{className:"px-4 py-2 hover:bg-white/5 transition-colors backdrop-blur-sm border-b border-white/5",children:a.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center text-sm",children:[a.jsx("div",{className:"col-span-2",children:a.jsxs("div",{children:[a.jsx(Ze,{className:"font-medium text-sm",children:Q.name}),a.jsx("p",{className:"text-xs text-gray-400 capitalize",children:(Dt=Q.category)==null?void 0:Dt.replace("_"," ")})]})}),a.jsx("div",{className:"col-span-1 text-center",children:a.jsx("span",{className:"text-gray-300 font-medium",children:ae})}),a.jsx("div",{className:"col-span-1 text-center",children:a.jsx("span",{className:"text-green-400 font-medium",children:_e})}),a.jsx("div",{className:"col-span-1 text-center",children:a.jsx("span",{className:"text-red-400 font-medium",children:Pe})}),a.jsx("div",{className:"col-span-1 text-center",children:a.jsx("span",{className:"text-orange-400 font-medium",children:De})}),a.jsx("div",{className:"col-span-1 text-center",children:a.jsx("span",{className:"text-purple-400 font-medium",children:Wr})}),a.jsx("div",{className:"col-span-1 text-center",children:a.jsx("span",{className:"text-blue-400 font-medium",children:Ce})}),a.jsx("div",{className:"col-span-1 text-center",children:a.jsx("span",{className:`font-medium ${Pr>=0?"text-green-400":"text-red-400"}`,children:Pr})}),a.jsx("div",{className:"col-span-1 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ce.bgColor} ${ce.color}`,children:ce.status==="out"?"Sin":ce.status==="low"?"Bajo":"OK"})}),a.jsx("div",{className:"col-span-2 flex justify-center gap-1",children:(e==null?void 0:e.role)==="admin"?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>C(Q),className:"p-1.5 bg-blue-600/20 text-blue-400 rounded-md hover:bg-blue-600/30 transition-colors",title:"Editar",children:a.jsx(Lo,{className:"w-3.5 h-3.5"})}),a.jsx("button",{onClick:()=>_(Q),className:"p-1.5 bg-purple-600/20 text-purple-400 rounded-md hover:bg-purple-600/30 transition-colors",title:"Movimiento",children:a.jsx(mc,{className:"w-3.5 h-3.5"})}),a.jsx("button",{onClick:()=>U(Q),className:"p-1.5 bg-green-600/20 text-green-400 rounded-md hover:bg-green-600/30 transition-colors",title:"Venta",children:a.jsx(Aa,{className:"w-3.5 h-3.5"})}),a.jsx("button",{onClick:()=>A(Q._id),className:"p-1.5 bg-red-600/20 text-red-400 rounded-md hover:bg-red-600/30 transition-colors",title:"Eliminar",children:a.jsx(Xa,{className:"w-3.5 h-3.5"})})]}):a.jsx("button",{onClick:()=>re(Q),className:"p-1.5 bg-yellow-600/20 text-yellow-400 rounded-md hover:bg-yellow-600/30 transition-colors",title:"Conteo de Stock",children:a.jsx(Ci,{className:"w-3.5 h-3.5"})})})]})},Q._id)})})]})]})}),a.jsx(Sv,{isOpen:be,onClose:()=>he(!1),inventory:n,onSnapshotCreated:z,onInventoryReset:ie}),a.jsx(kv,{isOpen:je,onClose:()=>le(!1)})]})]})};var Ee=function(){return Ee=Object.assign||function(t){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ee.apply(this,arguments)};function Cv(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}function O0(e,t,r){for(var s=0,n=t.length,i;s<n;s++)(i||!(s in t))&&(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}function ts(e){return e.mode==="multiple"}function as(e){return e.mode==="range"}function Js(e){return e.mode==="single"}var Av={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Dv(e,t){return Cr(e,"LLLL y",t)}function Fv(e,t){return Cr(e,"d",t)}function Pv(e,t){return Cr(e,"LLLL",t)}function Ov(e){return"".concat(e)}function Mv(e,t){return Cr(e,"cccccc",t)}function Iv(e,t){return Cr(e,"yyyy",t)}var Rv=Object.freeze({__proto__:null,formatCaption:Dv,formatDay:Fv,formatMonthCaption:Pv,formatWeekNumber:Ov,formatWeekdayName:Mv,formatYearCaption:Iv}),Lv=function(e,t,r){return Cr(e,"do MMMM (EEEE)",r)},Bv=function(){return"Month: "},Wv=function(){return"Go to next month"},Uv=function(){return"Go to previous month"},$v=function(e,t){return Cr(e,"cccc",t)},zv=function(e){return"Week n. ".concat(e)},Hv=function(){return"Year: "},Vv=Object.freeze({__proto__:null,labelDay:Lv,labelMonthDropdown:Bv,labelNext:Wv,labelPrevious:Uv,labelWeekNumber:zv,labelWeekday:$v,labelYearDropdown:Hv});function Gv(){var e="buttons",t=Av,r=qo,s={},n={},i=1,o={},l=new Date;return{captionLayout:e,classNames:t,formatters:Rv,labels:Vv,locale:r,modifiersClassNames:s,modifiers:n,numberOfMonths:i,styles:o,today:l,mode:"default"}}function Yv(e){var t=e.fromYear,r=e.toYear,s=e.fromMonth,n=e.toMonth,i=e.fromDate,o=e.toDate;return s?i=Tr(s):t&&(i=new Date(t,0,1)),n?o=Ln(n):r&&(o=new Date(r,11,31)),{fromDate:i?Wt(i):void 0,toDate:o?Wt(o):void 0}}var M0=O.createContext(void 0);function Xv(e){var t,r=e.initialProps,s=Gv(),n=Yv(r),i=n.fromDate,o=n.toDate,l=(t=r.captionLayout)!==null&&t!==void 0?t:s.captionLayout;l!=="buttons"&&(!i||!o)&&(l="buttons");var d;(Js(r)||ts(r)||as(r))&&(d=r.onSelect);var c=Ee(Ee(Ee({},s),r),{captionLayout:l,classNames:Ee(Ee({},s.classNames),r.classNames),components:Ee({},r.components),formatters:Ee(Ee({},s.formatters),r.formatters),fromDate:i,labels:Ee(Ee({},s.labels),r.labels),mode:r.mode||s.mode,modifiers:Ee(Ee({},s.modifiers),r.modifiers),modifiersClassNames:Ee(Ee({},s.modifiersClassNames),r.modifiersClassNames),onSelect:d,styles:Ee(Ee({},s.styles),r.styles),toDate:o});return a.jsx(M0.Provider,{value:c,children:e.children})}function ze(){var e=O.useContext(M0);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function I0(e){var t=ze(),r=t.locale,s=t.classNames,n=t.styles,i=t.formatters.formatCaption;return a.jsx("div",{className:s.caption_label,style:n.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:i(e.displayMonth,{locale:r})})}function qv(e){return a.jsx("svg",Ee({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:a.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function R0(e){var t,r,s=e.onChange,n=e.value,i=e.children,o=e.caption,l=e.className,d=e.style,c=ze(),u=(r=(t=c.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:qv;return a.jsxs("div",{className:l,style:d,children:[a.jsx("span",{className:c.classNames.vhidden,children:e["aria-label"]}),a.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:c.classNames.dropdown,style:c.styles.dropdown,value:n,onChange:s,children:i}),a.jsxs("div",{className:c.classNames.caption_label,style:c.styles.caption_label,"aria-hidden":"true",children:[o,a.jsx(u,{className:c.classNames.dropdown_icon,style:c.styles.dropdown_icon})]})]})}function Kv(e){var t,r=ze(),s=r.fromDate,n=r.toDate,i=r.styles,o=r.locale,l=r.formatters.formatMonthCaption,d=r.classNames,c=r.components,u=r.labels.labelMonthDropdown;if(!s)return a.jsx(a.Fragment,{});if(!n)return a.jsx(a.Fragment,{});var h=[];if(qd(s,n))for(var m=Tr(s),f=s.getMonth();f<=n.getMonth();f++)h.push(on(m,f));else for(var m=Tr(new Date),f=0;f<=11;f++)h.push(on(m,f));var g=function(p){var w=Number(p.target.value),b=on(Tr(e.displayMonth),w);e.onChange(b)},x=(t=c==null?void 0:c.Dropdown)!==null&&t!==void 0?t:R0;return a.jsx(x,{name:"months","aria-label":u(),className:d.dropdown_month,style:i.dropdown_month,onChange:g,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:o}),children:h.map(function(p){return a.jsx("option",{value:p.getMonth(),children:l(p,{locale:o})},p.getMonth())})})}function Jv(e){var t,r=e.displayMonth,s=ze(),n=s.fromDate,i=s.toDate,o=s.locale,l=s.styles,d=s.classNames,c=s.components,u=s.formatters.formatYearCaption,h=s.labels.labelYearDropdown,m=[];if(!n)return a.jsx(a.Fragment,{});if(!i)return a.jsx(a.Fragment,{});for(var f=n.getFullYear(),g=i.getFullYear(),x=f;x<=g;x++)m.push(Bi(Go(new Date),x));var p=function(b){var y=Bi(Tr(r),Number(b.target.value));e.onChange(y)},w=(t=c==null?void 0:c.Dropdown)!==null&&t!==void 0?t:R0;return a.jsx(w,{name:"years","aria-label":h(),className:d.dropdown_year,style:l.dropdown_year,onChange:p,value:r.getFullYear(),caption:u(r,{locale:o}),children:m.map(function(b){return a.jsx("option",{value:b.getFullYear(),children:u(b,{locale:o})},b.getFullYear())})})}function Qv(e,t){var r=O.useState(e),s=r[0],n=r[1],i=t===void 0?s:t;return[i,n]}function Zv(e){var t=e.month,r=e.defaultMonth,s=e.today,n=t||r||s||new Date,i=e.toDate,o=e.fromDate,l=e.numberOfMonths,d=l===void 0?1:l;if(i&&Ba(i,n)<0){var c=-1*(d-1);n=Kr(i,c)}return o&&Ba(n,o)<0&&(n=o),Tr(n)}function e2(){var e=ze(),t=Zv(e),r=Qv(t,e.month),s=r[0],n=r[1],i=function(o){var l;if(!e.disableNavigation){var d=Tr(o);n(d),(l=e.onMonthChange)===null||l===void 0||l.call(e,d)}};return[s,i]}function r2(e,t){for(var r=t.reverseMonths,s=t.numberOfMonths,n=Tr(e),i=Tr(Kr(n,s)),o=Ba(i,n),l=[],d=0;d<o;d++){var c=Kr(n,d);l.push(c)}return r&&(l=l.reverse()),l}function t2(e,t){if(!t.disableNavigation){var r=t.toDate,s=t.pagedNavigation,n=t.numberOfMonths,i=n===void 0?1:n,o=s?i:1,l=Tr(e);if(!r)return Kr(l,o);var d=Ba(r,e);if(!(d<i))return Kr(l,o)}}function a2(e,t){if(!t.disableNavigation){var r=t.fromDate,s=t.pagedNavigation,n=t.numberOfMonths,i=n===void 0?1:n,o=s?i:1,l=Tr(e);if(!r)return Kr(l,-o);var d=Ba(l,r);if(!(d<=0))return Kr(l,-o)}}var L0=O.createContext(void 0);function s2(e){var t=ze(),r=e2(),s=r[0],n=r[1],i=r2(s,t),o=t2(s,t),l=a2(s,t),d=function(h){return i.some(function(m){return Un(h,m)})},c=function(h,m){d(h)||(m&&Wn(h,m)?n(Kr(h,1+t.numberOfMonths*-1)):n(h))},u={currentMonth:s,displayMonths:i,goToMonth:n,goToDate:c,previousMonth:l,nextMonth:o,isDateDisplayed:d};return a.jsx(L0.Provider,{value:u,children:e.children})}function ss(){var e=O.useContext(L0);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function Fo(e){var t,r=ze(),s=r.classNames,n=r.styles,i=r.components,o=ss().goToMonth,l=function(u){o(Kr(u,e.displayIndex?-e.displayIndex:0))},d=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:I0,c=a.jsx(d,{id:e.id,displayMonth:e.displayMonth});return a.jsxs("div",{className:s.caption_dropdowns,style:n.caption_dropdowns,children:[a.jsx("div",{className:s.vhidden,children:c}),a.jsx(Kv,{onChange:l,displayMonth:e.displayMonth}),a.jsx(Jv,{onChange:l,displayMonth:e.displayMonth})]})}function n2(e){return a.jsx("svg",Ee({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:a.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function i2(e){return a.jsx("svg",Ee({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:a.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Ws=O.forwardRef(function(e,t){var r=ze(),s=r.classNames,n=r.styles,i=[s.button_reset,s.button];e.className&&i.push(e.className);var o=i.join(" "),l=Ee(Ee({},n.button_reset),n.button);return e.style&&Object.assign(l,e.style),a.jsx("button",Ee({},e,{ref:t,type:"button",className:o,style:l}))});function o2(e){var t,r,s=ze(),n=s.dir,i=s.locale,o=s.classNames,l=s.styles,d=s.labels,c=d.labelPrevious,u=d.labelNext,h=s.components;if(!e.nextMonth&&!e.previousMonth)return a.jsx(a.Fragment,{});var m=c(e.previousMonth,{locale:i}),f=[o.nav_button,o.nav_button_previous].join(" "),g=u(e.nextMonth,{locale:i}),x=[o.nav_button,o.nav_button_next].join(" "),p=(t=h==null?void 0:h.IconRight)!==null&&t!==void 0?t:i2,w=(r=h==null?void 0:h.IconLeft)!==null&&r!==void 0?r:n2;return a.jsxs("div",{className:o.nav,style:l.nav,children:[!e.hidePrevious&&a.jsx(Ws,{name:"previous-month","aria-label":m,className:f,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:n==="rtl"?a.jsx(p,{className:o.nav_icon,style:l.nav_icon}):a.jsx(w,{className:o.nav_icon,style:l.nav_icon})}),!e.hideNext&&a.jsx(Ws,{name:"next-month","aria-label":g,className:x,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:n==="rtl"?a.jsx(w,{className:o.nav_icon,style:l.nav_icon}):a.jsx(p,{className:o.nav_icon,style:l.nav_icon})})]})}function Po(e){var t=ze().numberOfMonths,r=ss(),s=r.previousMonth,n=r.nextMonth,i=r.goToMonth,o=r.displayMonths,l=o.findIndex(function(g){return Un(e.displayMonth,g)}),d=l===0,c=l===o.length-1,u=t>1&&(d||!c),h=t>1&&(c||!d),m=function(){s&&i(s)},f=function(){n&&i(n)};return a.jsx(o2,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:h,nextMonth:n,previousMonth:s,onPreviousClick:m,onNextClick:f})}function l2(e){var t,r=ze(),s=r.classNames,n=r.disableNavigation,i=r.styles,o=r.captionLayout,l=r.components,d=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:I0,c;return n?c=a.jsx(d,{id:e.id,displayMonth:e.displayMonth}):o==="dropdown"?c=a.jsx(Fo,{displayMonth:e.displayMonth,id:e.id}):o==="dropdown-buttons"?c=a.jsxs(a.Fragment,{children:[a.jsx(Fo,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),a.jsx(Po,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):c=a.jsxs(a.Fragment,{children:[a.jsx(d,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),a.jsx(Po,{displayMonth:e.displayMonth,id:e.id})]}),a.jsx("div",{className:s.caption,style:i.caption,children:c})}function c2(e){var t=ze(),r=t.footer,s=t.styles,n=t.classNames.tfoot;return r?a.jsx("tfoot",{className:n,style:s.tfoot,children:a.jsx("tr",{children:a.jsx("td",{colSpan:8,children:r})})}):a.jsx(a.Fragment,{})}function d2(e,t,r){for(var s=r?Bt(new Date):st(new Date,{locale:e,weekStartsOn:t}),n=[],i=0;i<7;i++){var o=vr(s,i);n.push(o)}return n}function u2(){var e=ze(),t=e.classNames,r=e.styles,s=e.showWeekNumber,n=e.locale,i=e.weekStartsOn,o=e.ISOWeek,l=e.formatters.formatWeekdayName,d=e.labels.labelWeekday,c=d2(n,i,o);return a.jsxs("tr",{style:r.head_row,className:t.head_row,children:[s&&a.jsx("td",{style:r.head_cell,className:t.head_cell}),c.map(function(u,h){return a.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":d(u,{locale:n}),children:l(u,{locale:n})},h)})]})}function f2(){var e,t=ze(),r=t.classNames,s=t.styles,n=t.components,i=(e=n==null?void 0:n.HeadRow)!==null&&e!==void 0?e:u2;return a.jsx("thead",{style:s.head,className:r.head,children:a.jsx(i,{})})}function h2(e){var t=ze(),r=t.locale,s=t.formatters.formatDay;return a.jsx(a.Fragment,{children:s(e.date,{locale:r})})}var di=O.createContext(void 0);function x2(e){if(!ts(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return a.jsx(di.Provider,{value:t,children:e.children})}return a.jsx(m2,{initialProps:e.initialProps,children:e.children})}function m2(e){var t=e.initialProps,r=e.children,s=t.selected,n=t.min,i=t.max,o=function(c,u,h){var m,f;(m=t.onDayClick)===null||m===void 0||m.call(t,c,u,h);var g=!!(u.selected&&n&&(s==null?void 0:s.length)===n);if(!g){var x=!!(!u.selected&&i&&(s==null?void 0:s.length)===i);if(!x){var p=s?O0([],s):[];if(u.selected){var w=p.findIndex(function(b){return yr(c,b)});p.splice(w,1)}else p.push(c);(f=t.onSelect)===null||f===void 0||f.call(t,p,c,u,h)}}},l={disabled:[]};s&&l.disabled.push(function(c){var u=i&&s.length>i-1,h=s.some(function(m){return yr(m,c)});return!!(u&&!h)});var d={selected:s,onDayClick:o,modifiers:l};return a.jsx(di.Provider,{value:d,children:r})}function ui(){var e=O.useContext(di);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function p2(e,t){var r=t||{},s=r.from,n=r.to;return s&&n?yr(n,e)&&yr(s,e)?void 0:yr(n,e)?{from:n,to:void 0}:yr(s,e)?void 0:_s(s,e)?{from:e,to:n}:{from:s,to:e}:n?_s(e,n)?{from:n,to:e}:{from:e,to:n}:s?Wn(e,s)?{from:e,to:s}:{from:s,to:e}:{from:e,to:void 0}}var fi=O.createContext(void 0);function g2(e){if(!as(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return a.jsx(fi.Provider,{value:t,children:e.children})}return a.jsx(v2,{initialProps:e.initialProps,children:e.children})}function v2(e){var t=e.initialProps,r=e.children,s=t.selected,n=s||{},i=n.from,o=n.to,l=t.min,d=t.max,c=function(f,g,x){var p,w;(p=t.onDayClick)===null||p===void 0||p.call(t,f,g,x);var b=p2(f,s);(w=t.onSelect)===null||w===void 0||w.call(t,b,f,g,x)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(u.range_start=[i],o?(u.range_end=[o],yr(i,o)||(u.range_middle=[{after:i,before:o}])):u.range_end=[i]):o&&(u.range_start=[o],u.range_end=[o]),l&&(i&&!o&&u.disabled.push({after:nn(i,l-1),before:vr(i,l-1)}),i&&o&&u.disabled.push({after:i,before:vr(i,l-1)}),!i&&o&&u.disabled.push({after:nn(o,l-1),before:vr(o,l-1)})),d){if(i&&!o&&(u.disabled.push({before:vr(i,-d+1)}),u.disabled.push({after:vr(i,d-1)})),i&&o){var h=at(o,i)+1,m=d-h;u.disabled.push({before:nn(i,m)}),u.disabled.push({after:vr(o,m)})}!i&&o&&(u.disabled.push({before:vr(o,-d+1)}),u.disabled.push({after:vr(o,d-1)}))}return a.jsx(fi.Provider,{value:{selected:s,onDayClick:c,modifiers:u},children:r})}function hi(){var e=O.useContext(fi);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function bs(e){return Array.isArray(e)?O0([],e):e!==void 0?[e]:[]}function b2(e){var t={};return Object.entries(e).forEach(function(r){var s=r[0],n=r[1];t[s]=bs(n)}),t}var Jr;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Jr||(Jr={}));var w2=Jr.Selected,ot=Jr.Disabled,y2=Jr.Hidden,N2=Jr.Today,gn=Jr.RangeEnd,vn=Jr.RangeMiddle,bn=Jr.RangeStart,j2=Jr.Outside;function _2(e,t,r){var s,n=(s={},s[w2]=bs(e.selected),s[ot]=bs(e.disabled),s[y2]=bs(e.hidden),s[N2]=[e.today],s[gn]=[],s[vn]=[],s[bn]=[],s[j2]=[],s);return e.fromDate&&n[ot].push({before:e.fromDate}),e.toDate&&n[ot].push({after:e.toDate}),ts(e)?n[ot]=n[ot].concat(t.modifiers[ot]):as(e)&&(n[ot]=n[ot].concat(r.modifiers[ot]),n[bn]=r.modifiers[bn],n[vn]=r.modifiers[vn],n[gn]=r.modifiers[gn]),n}var B0=O.createContext(void 0);function E2(e){var t=ze(),r=ui(),s=hi(),n=_2(t,r,s),i=b2(t.modifiers),o=Ee(Ee({},n),i);return a.jsx(B0.Provider,{value:o,children:e.children})}function W0(){var e=O.useContext(B0);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function S2(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function k2(e){return!!(e&&typeof e=="object"&&"from"in e)}function T2(e){return!!(e&&typeof e=="object"&&"after"in e)}function C2(e){return!!(e&&typeof e=="object"&&"before"in e)}function A2(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function D2(e,t){var r,s=t.from,n=t.to;if(s&&n){var i=at(n,s)<0;i&&(r=[n,s],s=r[0],n=r[1]);var o=at(e,s)>=0&&at(n,e)>=0;return o}return n?yr(n,e):s?yr(s,e):!1}function F2(e){return Rn(e)}function P2(e){return Array.isArray(e)&&e.every(Rn)}function O2(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(F2(r))return yr(e,r);if(P2(r))return r.includes(e);if(k2(r))return D2(e,r);if(A2(r))return r.dayOfWeek.includes(e.getDay());if(S2(r)){var s=at(r.before,e),n=at(r.after,e),i=s>0,o=n<0,l=_s(r.before,r.after);return l?o&&i:i||o}return T2(r)?at(e,r.after)>0:C2(r)?at(r.before,e)>0:typeof r=="function"?r(e):!1})}function xi(e,t,r){var s=Object.keys(t).reduce(function(i,o){var l=t[o];return O2(e,l)&&i.push(o),i},[]),n={};return s.forEach(function(i){return n[i]=!0}),r&&!Un(e,r)&&(n.outside=!0),n}function M2(e,t){for(var r=Tr(e[0]),s=Ln(e[e.length-1]),n,i,o=r;o<=s;){var l=xi(o,t),d=!l.disabled&&!l.hidden;if(!d){o=vr(o,1);continue}if(l.selected)return o;l.today&&!i&&(i=o),n||(n=o),o=vr(o,1)}return i||n}var I2=365;function U0(e,t){var r=t.moveBy,s=t.direction,n=t.context,i=t.modifiers,o=t.retry,l=o===void 0?{count:0,lastFocused:e}:o,d=n.weekStartsOn,c=n.fromDate,u=n.toDate,h=n.locale,m={day:vr,week:jn,month:Kr,year:Gc,startOfWeek:function(p){return n.ISOWeek?Bt(p):st(p,{locale:h,weekStartsOn:d})},endOfWeek:function(p){return n.ISOWeek?Yo(p):Bn(p,{locale:h,weekStartsOn:d})}},f=m[r](e,s==="after"?1:-1);s==="before"&&c?f=Yc([c,f]):s==="after"&&u&&(f=Xc([u,f]));var g=!0;if(i){var x=xi(f,i);g=!x.disabled&&!x.hidden}return g?f:l.count>I2?l.lastFocused:U0(f,{moveBy:r,direction:s,context:n,modifiers:i,retry:Ee(Ee({},l),{count:l.count+1})})}var $0=O.createContext(void 0);function R2(e){var t=ss(),r=W0(),s=O.useState(),n=s[0],i=s[1],o=O.useState(),l=o[0],d=o[1],c=M2(t.displayMonths,r),u=(n!=null?n:l&&t.isDateDisplayed(l))?l:c,h=function(){d(n),i(void 0)},m=function(p){i(p)},f=ze(),g=function(p,w){if(n){var b=U0(n,{moveBy:p,direction:w,context:f,modifiers:r});yr(n,b)||(t.goToDate(b,n),m(b))}},x={focusedDay:n,focusTarget:u,blur:h,focus:m,focusDayAfter:function(){return g("day","after")},focusDayBefore:function(){return g("day","before")},focusWeekAfter:function(){return g("week","after")},focusWeekBefore:function(){return g("week","before")},focusMonthBefore:function(){return g("month","before")},focusMonthAfter:function(){return g("month","after")},focusYearBefore:function(){return g("year","before")},focusYearAfter:function(){return g("year","after")},focusStartOfWeek:function(){return g("startOfWeek","before")},focusEndOfWeek:function(){return g("endOfWeek","after")}};return a.jsx($0.Provider,{value:x,children:e.children})}function mi(){var e=O.useContext($0);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function L2(e,t){var r=W0(),s=xi(e,r,t);return s}var pi=O.createContext(void 0);function B2(e){if(!Js(e.initialProps)){var t={selected:void 0};return a.jsx(pi.Provider,{value:t,children:e.children})}return a.jsx(W2,{initialProps:e.initialProps,children:e.children})}function W2(e){var t=e.initialProps,r=e.children,s=function(i,o,l){var d,c,u;if((d=t.onDayClick)===null||d===void 0||d.call(t,i,o,l),o.selected&&!t.required){(c=t.onSelect)===null||c===void 0||c.call(t,void 0,i,o,l);return}(u=t.onSelect)===null||u===void 0||u.call(t,i,i,o,l)},n={selected:t.selected,onDayClick:s};return a.jsx(pi.Provider,{value:n,children:r})}function z0(){var e=O.useContext(pi);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function U2(e,t){var r=ze(),s=z0(),n=ui(),i=hi(),o=mi(),l=o.focusDayAfter,d=o.focusDayBefore,c=o.focusWeekAfter,u=o.focusWeekBefore,h=o.blur,m=o.focus,f=o.focusMonthBefore,g=o.focusMonthAfter,x=o.focusYearBefore,p=o.focusYearAfter,w=o.focusStartOfWeek,b=o.focusEndOfWeek,y=function(le){var M,ie,B,ne;Js(r)?(M=s.onDayClick)===null||M===void 0||M.call(s,e,t,le):ts(r)?(ie=n.onDayClick)===null||ie===void 0||ie.call(n,e,t,le):as(r)?(B=i.onDayClick)===null||B===void 0||B.call(i,e,t,le):(ne=r.onDayClick)===null||ne===void 0||ne.call(r,e,t,le)},S=function(le){var M;m(e),(M=r.onDayFocus)===null||M===void 0||M.call(r,e,t,le)},P=function(le){var M;h(),(M=r.onDayBlur)===null||M===void 0||M.call(r,e,t,le)},L=function(le){var M;(M=r.onDayMouseEnter)===null||M===void 0||M.call(r,e,t,le)},I=function(le){var M;(M=r.onDayMouseLeave)===null||M===void 0||M.call(r,e,t,le)},H=function(le){var M;(M=r.onDayPointerEnter)===null||M===void 0||M.call(r,e,t,le)},W=function(le){var M;(M=r.onDayPointerLeave)===null||M===void 0||M.call(r,e,t,le)},J=function(le){var M;(M=r.onDayTouchCancel)===null||M===void 0||M.call(r,e,t,le)},ee=function(le){var M;(M=r.onDayTouchEnd)===null||M===void 0||M.call(r,e,t,le)},R=function(le){var M;(M=r.onDayTouchMove)===null||M===void 0||M.call(r,e,t,le)},q=function(le){var M;(M=r.onDayTouchStart)===null||M===void 0||M.call(r,e,t,le)},be=function(le){var M;(M=r.onDayKeyUp)===null||M===void 0||M.call(r,e,t,le)},he=function(le){var M;switch(le.key){case"ArrowLeft":le.preventDefault(),le.stopPropagation(),r.dir==="rtl"?l():d();break;case"ArrowRight":le.preventDefault(),le.stopPropagation(),r.dir==="rtl"?d():l();break;case"ArrowDown":le.preventDefault(),le.stopPropagation(),c();break;case"ArrowUp":le.preventDefault(),le.stopPropagation(),u();break;case"PageUp":le.preventDefault(),le.stopPropagation(),le.shiftKey?x():f();break;case"PageDown":le.preventDefault(),le.stopPropagation(),le.shiftKey?p():g();break;case"Home":le.preventDefault(),le.stopPropagation(),w();break;case"End":le.preventDefault(),le.stopPropagation(),b();break}(M=r.onDayKeyDown)===null||M===void 0||M.call(r,e,t,le)},je={onClick:y,onFocus:S,onBlur:P,onKeyDown:he,onKeyUp:be,onMouseEnter:L,onMouseLeave:I,onPointerEnter:H,onPointerLeave:W,onTouchCancel:J,onTouchEnd:ee,onTouchMove:R,onTouchStart:q};return je}function $2(){var e=ze(),t=z0(),r=ui(),s=hi(),n=Js(e)?t.selected:ts(e)?r.selected:as(e)?s.selected:void 0;return n}function z2(e){return Object.values(Jr).includes(e)}function H2(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(s){var n=e.modifiersClassNames[s];if(n)r.push(n);else if(z2(s)){var i=e.classNames["day_".concat(s)];i&&r.push(i)}}),r}function V2(e,t){var r=Ee({},e.styles.day);return Object.keys(t).forEach(function(s){var n;r=Ee(Ee({},r),(n=e.modifiersStyles)===null||n===void 0?void 0:n[s])}),r}function G2(e,t,r){var s,n,i,o=ze(),l=mi(),d=L2(e,t),c=U2(e,d),u=$2(),h=!!(o.onDayClick||o.mode!=="default");O.useEffect(function(){var L;d.outside||l.focusedDay&&h&&yr(l.focusedDay,e)&&((L=r.current)===null||L===void 0||L.focus())},[l.focusedDay,e,r,h,d.outside]);var m=H2(o,d).join(" "),f=V2(o,d),g=!!(d.outside&&!o.showOutsideDays||d.hidden),x=(i=(n=o.components)===null||n===void 0?void 0:n.DayContent)!==null&&i!==void 0?i:h2,p=a.jsx(x,{date:e,displayMonth:t,activeModifiers:d}),w={style:f,className:m,children:p,role:"gridcell"},b=l.focusTarget&&yr(l.focusTarget,e)&&!d.outside,y=l.focusedDay&&yr(l.focusedDay,e),S=Ee(Ee(Ee({},w),(s={disabled:d.disabled,role:"gridcell"},s["aria-selected"]=d.selected,s.tabIndex=y||b?0:-1,s)),c),P={isButton:h,isHidden:g,activeModifiers:d,selectedDays:u,buttonProps:S,divProps:w};return P}function Y2(e){var t=O.useRef(null),r=G2(e.date,e.displayMonth,t);return r.isHidden?a.jsx("div",{role:"gridcell"}):r.isButton?a.jsx(Ws,Ee({name:"day",ref:t},r.buttonProps)):a.jsx("div",Ee({},r.divProps))}function X2(e){var t=e.number,r=e.dates,s=ze(),n=s.onWeekNumberClick,i=s.styles,o=s.classNames,l=s.locale,d=s.labels.labelWeekNumber,c=s.formatters.formatWeekNumber,u=c(Number(t),{locale:l});if(!n)return a.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:u});var h=d(Number(t),{locale:l}),m=function(f){n(t,r,f)};return a.jsx(Ws,{name:"week-number","aria-label":h,className:o.weeknumber,style:i.weeknumber,onClick:m,children:u})}function q2(e){var t,r,s=ze(),n=s.styles,i=s.classNames,o=s.showWeekNumber,l=s.components,d=(t=l==null?void 0:l.Day)!==null&&t!==void 0?t:Y2,c=(r=l==null?void 0:l.WeekNumber)!==null&&r!==void 0?r:X2,u;return o&&(u=a.jsx("td",{className:i.cell,style:n.cell,children:a.jsx(c,{number:e.weekNumber,dates:e.dates})})),a.jsxs("tr",{className:i.row,style:n.row,children:[u,e.dates.map(function(h){return a.jsx("td",{className:i.cell,style:n.cell,role:"presentation",children:a.jsx(d,{displayMonth:e.displayMonth,date:h})},Gd(h))})]})}function Oo(e,t,r){for(var s=r!=null&&r.ISOWeek?Yo(t):Bn(t,r),n=r!=null&&r.ISOWeek?Bt(e):st(e,r),i=at(s,n),o=[],l=0;l<=i;l++)o.push(vr(n,l));var d=o.reduce(function(c,u){var h=r!=null&&r.ISOWeek?Ko(u):Qo(u,r),m=c.find(function(f){return f.weekNumber===h});return m?(m.dates.push(u),c):(c.push({weekNumber:h,dates:[u]}),c)},[]);return d}function K2(e,t){var r=Oo(Tr(e),Ln(e),t);if(t!=null&&t.useFixedWeeks){var s=Xd(e,t);if(s<6){var n=r[r.length-1],i=n.dates[n.dates.length-1],o=jn(i,6-s),l=Oo(jn(i,1),o,t);r.push.apply(r,l)}}return r}function J2(e){var t,r,s,n=ze(),i=n.locale,o=n.classNames,l=n.styles,d=n.hideHead,c=n.fixedWeeks,u=n.components,h=n.weekStartsOn,m=n.firstWeekContainsDate,f=n.ISOWeek,g=K2(e.displayMonth,{useFixedWeeks:!!c,ISOWeek:f,locale:i,weekStartsOn:h,firstWeekContainsDate:m}),x=(t=u==null?void 0:u.Head)!==null&&t!==void 0?t:f2,p=(r=u==null?void 0:u.Row)!==null&&r!==void 0?r:q2,w=(s=u==null?void 0:u.Footer)!==null&&s!==void 0?s:c2;return a.jsxs("table",{id:e.id,className:o.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!d&&a.jsx(x,{}),a.jsx("tbody",{className:o.tbody,style:l.tbody,children:g.map(function(b){return a.jsx(p,{displayMonth:e.displayMonth,dates:b.dates,weekNumber:b.weekNumber},b.weekNumber)})}),a.jsx(w,{displayMonth:e.displayMonth})]})}function Q2(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}var Z2=Q2()?O.useLayoutEffect:O.useEffect,wn=!1,eb=0;function Mo(){return"react-day-picker-".concat(++eb)}function rb(e){var t,r=e!=null?e:wn?Mo():null,s=O.useState(r),n=s[0],i=s[1];return Z2(function(){n===null&&i(Mo())},[]),O.useEffect(function(){wn===!1&&(wn=!0)},[]),(t=e!=null?e:n)!==null&&t!==void 0?t:void 0}function tb(e){var t,r,s=ze(),n=s.dir,i=s.classNames,o=s.styles,l=s.components,d=ss().displayMonths,c=rb(s.id?"".concat(s.id,"-").concat(e.displayIndex):void 0),u=s.id?"".concat(s.id,"-grid-").concat(e.displayIndex):void 0,h=[i.month],m=o.month,f=e.displayIndex===0,g=e.displayIndex===d.length-1,x=!f&&!g;n==="rtl"&&(t=[f,g],g=t[0],f=t[1]),f&&(h.push(i.caption_start),m=Ee(Ee({},m),o.caption_start)),g&&(h.push(i.caption_end),m=Ee(Ee({},m),o.caption_end)),x&&(h.push(i.caption_between),m=Ee(Ee({},m),o.caption_between));var p=(r=l==null?void 0:l.Caption)!==null&&r!==void 0?r:l2;return a.jsxs("div",{className:h.join(" "),style:m,children:[a.jsx(p,{id:c,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),a.jsx(J2,{id:u,"aria-labelledby":c,displayMonth:e.displayMonth})]},e.displayIndex)}function ab(e){var t=ze(),r=t.classNames,s=t.styles;return a.jsx("div",{className:r.months,style:s.months,children:e.children})}function sb(e){var t,r,s=e.initialProps,n=ze(),i=mi(),o=ss(),l=O.useState(!1),d=l[0],c=l[1];O.useEffect(function(){n.initialFocus&&i.focusTarget&&(d||(i.focus(i.focusTarget),c(!0)))},[n.initialFocus,d,i.focus,i.focusTarget,i]);var u=[n.classNames.root,n.className];n.numberOfMonths>1&&u.push(n.classNames.multiple_months),n.showWeekNumber&&u.push(n.classNames.with_weeknumber);var h=Ee(Ee({},n.styles.root),n.style),m=Object.keys(s).filter(function(g){return g.startsWith("data-")}).reduce(function(g,x){var p;return Ee(Ee({},g),(p={},p[x]=s[x],p))},{}),f=(r=(t=s.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:ab;return a.jsx("div",Ee({className:u.join(" "),style:h,dir:n.dir,id:n.id,nonce:s.nonce,title:s.title,lang:s.lang},m,{children:a.jsx(f,{children:o.displayMonths.map(function(g,x){return a.jsx(tb,{displayIndex:x,displayMonth:g},x)})})}))}function nb(e){var t=e.children,r=Cv(e,["children"]);return a.jsx(Xv,{initialProps:r,children:a.jsx(s2,{children:a.jsx(B2,{initialProps:r,children:a.jsx(x2,{initialProps:r,children:a.jsx(g2,{initialProps:r,children:a.jsx(E2,{children:a.jsx(R2,{children:t})})})})})})})}function ib(e){return a.jsx(nb,Ee({},e,{children:a.jsx(sb,{initialProps:e})}))}const Ge=(e,...t)=>{console.log(e,...t)},ob=()=>{const{showError:e,showSuccess:t}=Er(),[r,s]=O.useState([]),[n,i]=O.useState({}),[o,l]=O.useState({}),[d,c]=O.useState(!0),[u,h]=O.useState(""),[m,f]=O.useState([]),[g,x]=O.useState({}),[p,w]=O.useState("General"),[b,y]=O.useState(""),[S,P]=O.useState(!1),[L,I]=O.useState(null),[H,W]=O.useState(!1),[J,ee]=O.useState(null),R=O.useMemo(()=>m.sort((A,N)=>new Date(N)-new Date(A)),[m]);O.useEffect(()=>{(async()=>{try{const N=await bt.getAvailableDates(),_=(N==null?void 0:N.data)||[];let U=[];const re=[...new Set([..._,...U])].filter(z=>z&&z.trim()!=="").sort((z,K)=>new Date(K)-new Date(z));Ge("📅 Fechas disponibles cargadas:",re),f(re)}catch(N){console.error("Error cargando fechas globales:",N),f([])}})()},[]),O.useEffect(()=>{if(Ge("🔄 Aplicando filtro:",p,b,"Barbers:",r.length),p==="General"||!b){Ge("📋 Usando estadísticas generales - limpiando filtros"),l({}),P(!1);return}if(r.length===0){Ge("⚠️ No hay barberos para filtrar");return}if(S){Ge("⏳ Filtrado ya en progreso, saltando...");return}Ge("🎯 Ejecutando filtrado por tipo:",p,"fecha base:",b),je()},[p,b,r]);const q=()=>{if(!b||p==="General")return[];const A=new Date(b+"T12:00:00"),N=[];if(p==="Día")N.push(new Date(A));else if(p==="Semana")for(let _=0;_<7;_++){const U=new Date(A);U.setDate(A.getDate()-_),N.push(new Date(U))}else if(p==="Mes")for(let _=0;_<30;_++){const U=new Date(A);U.setDate(A.getDate()-_),N.push(new Date(U))}return Ge("🎯 Rango a resaltar:",p,b,N.map(_=>{const U=_.getFullYear(),re=(_.getMonth()+1).toString().padStart(2,"0"),z=_.getDate().toString().padStart(2,"0");return`${U}-${re}-${z}`})),N},be=async()=>{if(!b||p==="General")return R;const A=new Date(b+"T12:00:00"),N=p==="Semana"?7:p==="Mes"?30:1,_=R.filter(U=>{const re=new Date(U+"T12:00:00"),z=Math.floor((A-re)/(1e3*60*60*24));return z>=0&&z<N});return Ge("📅 Fechas válidas para rango:",p,b,_),_},he=(A,N)=>{if(!N)return[];const _=new Date(N+"T00:00:00.000Z"),U=[];if(A==="Día")U.push(_.toISOString().split("T")[0]);else if(A==="Semana")for(let z=0;z<7;z++){const K=new Date(_);K.setDate(_.getDate()-z),U.push(K.toISOString().split("T")[0])}else if(A==="Mes")for(let z=0;z<30;z++){const K=new Date(_);K.setDate(_.getDate()-z),U.push(K.toISOString().split("T")[0])}const re=U.filter(z=>R.includes(z));return Ge(`📅 Rango para ${A} desde ${N}:`,`Total generado: ${U.length}, Con datos: ${re.length}`,re),re},je=async()=>{if(!b||p==="General"){l({}),P(!1);return}P(!0),console.log(`🔍 INICIANDO FILTRO: ${p} - ${b}`),p==="Día"?await le(b):await M(),console.log(`✅ FILTRO COMPLETADO: ${p} - ${b}`)},le=async A=>{var _,U,re,z;console.log("📅 FILTRO DIARIO ALTERNATIVO - Filtrando desde datos existentes:",A),P(!0);const N={};for(const K of r)try{console.log(`📊 Procesando día ${A} para barbero ${((_=K.user)==null?void 0:_.name)||K._id}...`),N[K._id]={sales:{total:0,count:0},cortes:{count:0,total:0},appointments:{completed:0,total:0}};try{const[Z,de]=await Promise.all([bt.getDailyReport(A,K._id),ls.getDailyReport(A,K._id)]);if(console.log(`� Datos del día para ${(U=K.user)==null?void 0:U.name}:`,{ventas:Z,citas:de}),Z!=null&&Z.success&&(Z!=null&&Z.data)){let ge=0,Se=0,Ne=0,Q=0;Array.isArray(Z.data)?Z.data.forEach(ce=>{ce.type==="product"?(ge+=ce.total||0,Se+=1):(ce.type==="walkIn"||ce.type==="corte")&&(Ne+=ce.total||0,Q+=1)}):Z.data.total!==void 0&&(ge=Z.data.total||0,Se=Z.data.count||0),N[K._id].sales={total:ge,count:Se},N[K._id].cortes={count:Q,total:Ne},console.log(`💰 Ventas del día ${A}:`,{totalVentas:ge,countVentas:Se,totalCortes:Ne,countCortes:Q})}if(de!=null&&de.success&&(de!=null&&de.data)){let ge=0,Se=0;Array.isArray(de.data)?de.data.forEach(Ne=>{var Q;ge+=Ne.total||((Q=Ne.service)==null?void 0:Q.price)||0,Ne.status==="completed"&&(Se+=1)}):de.data.total!==void 0&&(ge=de.data.total||0,Se=de.data.completed||0),N[K._id].appointments={completed:Se,total:ge},console.log(`📅 Citas del día ${A}:`,{totalCitas:ge,countCitas:Se})}}catch(Z){console.warn(`⚠️ Error obteniendo datos del día ${A} para ${(re=K.user)==null?void 0:re.name}:`,Z.message)}console.log(`✅ FINAL día ${A} para ${(z=K.user)==null?void 0:z.name}:`,N[K._id])}catch(Z){console.error(`❌ Error processing day ${A} for barber ${K._id}:`,Z)}console.log("📊 RESULTADO FINAL - Estadísticas del día:",N),l(N),P(!1)},M=async()=>{var _,U,re;if(!r||r.length===0)return;P(!0);const A=he(p,b);if(Ge(`📅 Procesando ${p} - Fechas válidas:`,A),A.length===0){Ge("❌ No hay fechas válidas para el rango, mostrando estadísticas vacías");const z={};r.forEach(K=>{z[K._id]={sales:{total:0,count:0},cortes:{count:0,total:0},appointments:{completed:0,total:0}}}),l(z),P(!1);return}const N={};for(const z of r)try{Ge(`📊 Procesando ${p} para barbero ${((_=z.user)==null?void 0:_.name)||z._id}...`);let K=0,Z=0,de=0,ge=0,Se=0,Ne=0;for(const Q of A)try{Ge(`📅 Procesando fecha ${Q} para ${(U=z.user)==null?void 0:U.name}...`);const[ce,D]=await Promise.all([bt.getBarberSalesStats(z._id,{date:Q}),ls.getBarberAppointmentStats(z._id,{date:Q})]);if(ce!=null&&ce.success&&(ce!=null&&ce.data)){const ae=ce.data;ae.ventas&&Array.isArray(ae.ventas)&&ae.ventas.forEach(_e=>{K+=_e.total||0,Z+=1}),ae.cortes&&Array.isArray(ae.cortes)&&ae.cortes.forEach(_e=>{de+=_e.total||0,ge+=1}),ae.total!==void 0&&!ae.ventas&&(K+=ae.total),ae.cortesTotal!==void 0&&!ae.cortes&&(de+=ae.cortesTotal),Ge(`💰 ${Q} - Ventas: ${ae.total||0}, Cortes: ${ae.cortesTotal||0}`)}if(D!=null&&D.success&&(D!=null&&D.data)){const ae=D.data;ae.citas&&Array.isArray(ae.citas)&&ae.citas.forEach(_e=>{var Pe;Se+=_e.revenue||((Pe=_e.service)==null?void 0:Pe.price)||0,_e.status==="completed"&&(Ne+=1)}),ae.revenue!==void 0&&!ae.citas&&(Se+=ae.revenue),ae.completed!==void 0&&!ae.citas&&(Ne+=ae.completed),Ge(`📅 ${Q} - Citas: ${ae.revenue||0}, Completadas: ${ae.completed||0}`)}}catch(ce){Ge(`⚠️ Error procesando fecha ${Q} para barbero ${z._id}:`,ce.message)}N[z._id]={sales:{total:K,count:Z},cortes:{count:ge,total:de},appointments:{completed:Ne,total:Se}},Ge(`✅ TOTAL ${p} para ${(re=z.user)==null?void 0:re.name}:`,`Ventas: ${K}, Cortes: ${de}, Citas: ${Se}`,`Fechas procesadas: ${A.length}`)}catch(K){console.error(`❌ Error procesando ${p} para barbero ${z._id}:`,K),N[z._id]={sales:{total:0,count:0},cortes:{count:0,total:0},appointments:{completed:0,total:0}}}Ge(`📊 FINAL - Estadísticas filtradas por ${p}:`,N),l(N),P(!1)},ie=async()=>{c(!0),h("");try{const A=await ct.getAllBarbers();let N=[];Array.isArray(A)?N=A:A&&A.data&&Array.isArray(A.data)?N=A.data:A&&Array.isArray(A.success)&&(N=A.success),s(N),await B(N)}catch(A){console.error("Error al cargar barberos:",A),s([]),h("Error al cargar los datos")}finally{c(!1)}},B=async A=>{var _,U;Ge("📊 Cargando estadísticas para",A.length,"barberos...");const N={};for(let re=0;re<A.length;re++){const z=A[re];try{Ge(`🔄 Cargando stats para barbero ${re+1}/${A.length}: ${((_=z.user)==null?void 0:_.name)||z._id}`),re>0&&await new Promise(D=>setTimeout(D,150*re));const[K,Z]=await Promise.all([bt.getBarberSalesStats(z._id),ls.getBarberAppointmentStats(z._id)]);let de=0,ge=0;K.data&&Array.isArray(K.data.ventas)?K.data.ventas.forEach(D=>{de+=D.total||0,ge+=1}):K.data&&typeof K.data.total=="number"&&(de=K.data.total,ge=K.data.count||0);let Se=0,Ne=0;K.data&&Array.isArray(K.data.cortes)&&K.data.cortes.forEach(D=>{Ne+=D.total||0,Se+=1});let Q=0,ce=0;Z.data&&Array.isArray(Z.data.citas)?Z.data.citas.forEach(D=>{var ae;Q+=D.revenue||((ae=D.service)==null?void 0:ae.price)||0,ce+=1}):Z.data&&typeof Z.data.revenue=="number"&&(Q=Z.data.revenue,ce=Z.data.completed||0),N[z._id]={sales:{total:de,count:ge},cortes:{count:Se,total:Ne},appointments:{completed:ce,total:Q}},Ge(`✅ Stats cargadas para ${((U=z.user)==null?void 0:U.name)||z._id}:`,N[z._id])}catch(K){console.error(`❌ Error loading stats for barber ${z._id}:`,K),N[z._id]={sales:{total:0,count:0},cortes:{count:0,total:0},appointments:{completed:0,total:0}}}}Ge("📈 Todas las estadísticas cargadas:",N),i(N)},ne=async A=>{try{const[N,_]=await Promise.all([bt.getAvailableDates(A),ls.getAvailableDates(A)]),U=[...new Set([...(N==null?void 0:N.data)||[],...(_==null?void 0:_.data)||[]])].sort((re,z)=>new Date(z)-new Date(re));x(re=>({...re,[A]:U}))}catch(N){console.error("Error cargando fechas disponibles:",N),e("Error al cargar fechas disponibles")}},C=async(A,N=null)=>{W(!0),ee(A);try{const _=N||new Date().toISOString().split("T")[0],U=await bt.getDailyReport(_,A);Ge("🔍 Respuesta del servidor:",U);const re=r.find(K=>K._id===A),z=(U==null?void 0:U.data)||U;return Ge("📊 Datos procesados:",z),I({date:_,barber:re,sales:(z==null?void 0:z.sales)||[],appointments:(z==null?void 0:z.appointments)||[],walkIns:(z==null?void 0:z.walkIns)||[],totals:(z==null?void 0:z.totals)||{}}),t("Reporte generado exitosamente"),!0}catch(_){return console.error("Error generando reporte:",_),e("Error al generar el reporte"),!1}finally{W(!1),ee(null)}};return O.useEffect(()=>{ie()},[]),{barbers:r,statistics:n,filteredStats:o,loading:d,error:u,globalAvailableDates:m,allAvailableDates:R,availableDates:g,filterType:p,filterDate:b,filterLoading:S,reportData:L,loadingReport:H,selectedBarber:J,setFilterType:w,setFilterDate:y,getHighlightedRange:q,getValidDatesForRange:be,getDateRange:he,loadData:ie,loadStatistics:B,loadBarberAvailableDates:ne,generateBarberReport:C,setReportData:I}},lb=()=>{const[e,t]=O.useState(!1),[r,s]=O.useState({}),[n,i]=O.useState(()=>new Date),o=async(p,w)=>{r[p]?s(b=>({...b,[p]:!1})):(s(b=>({...b,[p]:!0})),w&&await w(p))},l=p=>{s(w=>({...w,[p]:!1}))},d=()=>{s({})},c=()=>{t(!0)};return{showReportModal:e,barberMenus:r,calendarMonth:n,setShowReportModal:t,setBarberMenus:s,setCalendarMonth:i,toggleBarberMenu:o,closeBarberMenu:l,closeAllMenus:d,openReportModal:c,closeReportModal:()=>{t(!1)},handleGenerateReport:async(p,w,b,y)=>{await b(p,w)&&(c(),y&&y(p))},generateQuickReport:async(p,w,b,y,S)=>{var I;const P=new Date;P.setDate(P.getDate()-w);const L=P.toISOString().split("T")[0];(I=b[p])!=null&&I.includes(L)?await y(p,L):S(`No hay datos para ${w===1?"ayer":"anteayer"}`)},handleManualDateSelect:async(p,w,b,y,S)=>{var P;return(P=b[w])!=null&&P.includes(p)?(await y(w,p),!0):(p&&S("No hay datos disponibles para la fecha seleccionada"),!1)},isDateDisabled:(p,w)=>{const b=p.getFullYear(),y=(p.getMonth()+1).toString().padStart(2,"0"),S=p.getDate().toString().padStart(2,"0"),P=`${b}-${y}-${S}`;return!w.includes(P)},handleDateSelect:(p,w,b)=>{if(!p)return;const y=p.getFullYear(),S=(p.getMonth()+1).toString().padStart(2,"0"),P=p.getDate().toString().padStart(2,"0"),L=`${y}-${S}-${P}`;console.log("📅 Día seleccionado:",L,"Disponible:",w.includes(L)),w.includes(L)?b(L):console.warn("⚠️ Día no disponible seleccionado:",L)}}},cb=`
  .compact-calendar {
    font-size: 11px;
    color: #e5e7eb;
  }
  
  .compact-calendar .rdp-months {
    width: 100%;
    max-width: 280px;
  }
  
  .compact-calendar .rdp-day {
    color: #9ca3af;
    width: 28px;
    height: 28px;
    font-size: 11px;
  }
  
  .compact-calendar .rdp-day_button {
    width: 28px !important;
    height: 28px !important;
    border-radius: 50% !important;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    border: 1px solid transparent !important;
  }
  
  .compact-calendar .rdp-day_button:hover {
    background-color: rgba(59, 130, 246, 0.3) !important;
    border-radius: 50% !important;
  }
  
  .compact-calendar .available-day .rdp-day_button {
    background-color: rgba(34, 197, 94, 0.25) !important;
    color: #86efac !important;
    border: 1px solid rgba(34, 197, 94, 0.4) !important;
    border-radius: 50% !important;
  }
  
  .compact-calendar .rdp-day_selected .rdp-day_button,
  .compact-calendar .selected-day .rdp-day_button {
    background-color: #2563eb !important;
    color: white !important;
    font-weight: bold !important;
    border: 2px solid #60a5fa !important;
    border-radius: 50% !important;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3) !important;
  }
  
  .compact-calendar .highlight-day .rdp-day_button {
    background-color: #1d4ed8 !important;
    color: white !important;
    font-weight: bold !important;
    border: 2px solid #93c5fd !important;
    border-radius: 50% !important;
    box-shadow: 0 2px 4px rgba(59, 130, 246, 0.4) !important;
  }
  
  .compact-calendar .rdp-caption {
    color: #e5e7eb;
    font-size: 12px;
    font-weight: 600;
  }
  
  .compact-calendar .rdp-nav {
    color: #e5e7eb;
  }
  
  .compact-calendar .rdp-head_cell {
    color: #9ca3af;
    font-size: 10px;
    font-weight: 500;
  }
  
  /* Asegurar que los estilos de selección tengan prioridad */
  .compact-calendar .rdp-day_selected {
    background-color: #2563eb !important;
    border-radius: 50% !important;
  }
  
  .compact-calendar .rdp-day_selected .rdp-day_button {
    background-color: #2563eb !important;
    color: white !important;
  }
`;if(typeof document!="undefined"){const e="compact-calendar-styles";if(!document.getElementById(e)){const t=document.createElement("style");t.id=e,t.textContent=cb,document.head.appendChild(t)}}const db=()=>{const{user:e}=er(),{showError:t}=Er(),{barbers:r,statistics:s,filteredStats:n,loading:i,error:o,globalAvailableDates:l,allAvailableDates:d,availableDates:c,filterType:u,filterDate:h,filterLoading:m,reportData:f,loadingReport:g,selectedBarber:x,setFilterType:p,setFilterDate:w,getHighlightedRange:b,loadBarberAvailableDates:y,generateBarberReport:S}=ob(),{showReportModal:P,barberMenus:L,calendarMonth:I,setCalendarMonth:H,toggleBarberMenu:W,closeReportModal:J,handleGenerateReport:ee,generateQuickReport:R,handleManualDateSelect:q,isDateDisabled:be,handleDateSelect:he}=lb(),je=B=>{var ne;return((ne=B.user)==null?void 0:ne.role)==="admin"?a.jsx(pc,{className:"h-6 w-6 text-yellow-400"}):a.jsx(gc,{className:"h-6 w-6 text-blue-400"})},le=B=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(B||0),M=()=>{if(!f)return;const B=ie(f),ne=new Blob([B],{type:"text/html"}),C=URL.createObjectURL(ne),A=document.createElement("a");A.href=C,A.download=`reporte-${f.date}.html`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(C)},ie=B=>{if(!B)return"<p>No hay datos disponibles para el reporte</p>";const ne=Array.isArray(B.sales)?B.sales:[],C=Array.isArray(B.appointments)?B.appointments:[],A=Array.isArray(B.walkIns)?B.walkIns:[],N=z=>new Date(z).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),_=z=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(z),re=(()=>{const z=ne.reduce((de,ge)=>de+(ge.total||0),0),K=C.reduce((de,ge)=>de+(ge.total||0),0),Z=A.reduce((de,ge)=>de+(ge.total||0),0);return{productTotal:z,appointmentTotal:K,walkInTotal:Z,grandTotal:z+K+Z}})();return`
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte Diario - ${N(B.date)}</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: white;
            color: black;
            margin: 0;
            padding: 20px;
            font-size: 12px;
            line-height: 1.4;
        }
        .header {
            text-align: center;
            border-block-end: 2px solid #000;
            padding-block-end: 10px;
            margin-block-end: 20px;
        }
        .shop-name {
            font-size: 18px;
            font-weight: bold;
            margin-block-end: 5px;
        }
        .report-title {
            font-size: 14px;
            margin-block-end: 5px;
        }
        .date {
            font-size: 12px;
        }
        .section {
            margin-block-end: 25px;
        }
        .section-title {
            font-size: 14px;
            font-weight: bold;
            border-block-end: 1px solid #000;
            padding-block-end: 5px;
            margin-block-end: 10px;
        }
        .item {
            display: flex;
            justify-content: space-between;
            padding: 2px 0;
            border-block-end: 1px dotted #ccc;
        }
        .item-name {
            flex: 1;
            padding-inline-end: 10px;
        }
        .item-price {
            font-weight: bold;
        }
        .subtotal {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-block-start: 1px solid #000;
            font-weight: bold;
        }
        .total {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-block-start: 2px solid #000;
            font-weight: bold;
            font-size: 14px;
        }
        .footer {
            text-align: center;
            margin-block-start: 30px;
            padding-block-start: 10px;
            border-block-start: 1px solid #000;
            font-size: 10px;
        }
        @media print {
            body { margin: 0; padding: 10px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="shop-name">THE BROTHERS BARBER SHOP</div>
        <div class="report-title">REPORTE DIARIO</div>
        <div class="date">${N(B.date)}</div>
    </div>

    <!-- PRODUCTOS VENDIDOS -->
    <div class="section">
        <div class="section-title">PRODUCTOS VENDIDOS</div>
        ${ne.length===0?"<div>No hay ventas registradas</div>":""}
        ${ne.map(z=>{var K;return`
            <div class="item">
                <div class="item-name">${((K=z.products)==null?void 0:K.map(Z=>{var de;return`${((de=Z.product)==null?void 0:de.name)||"Producto"} x${Z.quantity}`}).join(", "))||"Venta"}</div>
                <div class="item-price">${_(z.total)}</div>
            </div>
        `}).join("")}
        ${ne.length>0?`
            <div class="subtotal">
                <div>SUBTOTAL PRODUCTOS:</div>
                <div>${_(re.productTotal)}</div>
            </div>
        `:""}
    </div>

    <!-- CORTES SIN CITA -->
    <div class="section">
        <div class="section-title">CORTES SIN CITA (WALK-INS)</div>
        ${A.length===0?"<div>No hay cortes sin cita registrados</div>":""}
        ${A.map(z=>{var K,Z,de;return`
            <div class="item">
                <div class="item-name">${((K=z.service)==null?void 0:K.name)||"Servicio"} - ${((de=(Z=z.barber)==null?void 0:Z.user)==null?void 0:de.name)||"Barbero"}</div>
                <div class="item-price">${_(z.total)}</div>
            </div>
        `}).join("")}
        ${A.length>0?`
            <div class="subtotal">
                <div>SUBTOTAL WALK-INS:</div>
                <div>${_(re.walkInTotal)}</div>
            </div>
        `:""}
    </div>

    <!-- CITAS COMPLETADAS -->
    <div class="section">
        <div class="section-title">CITAS COMPLETADAS</div>
        ${C.length===0?"<div>No hay citas completadas</div>":""}
        ${C.map(z=>{var K,Z,de,ge;return`
            <div class="item">
                <div class="item-name">${((K=z.service)==null?void 0:K.name)||"Servicio"} - ${((de=(Z=z.barber)==null?void 0:Z.user)==null?void 0:de.name)||"Barbero"} - ${((ge=z.user)==null?void 0:ge.name)||"Cliente"}</div>
                <div class="item-price">${_(z.total||0)}</div>
            </div>
        `}).join("")}
        ${C.length>0?`
            <div class="subtotal">
                <div>SUBTOTAL CITAS:</div>
                <div>${_(re.appointmentTotal)}</div>
            </div>
        `:""}
    </div>

    <div class="total">
        <div>TOTAL GENERAL:</div>
        <div>${_(re.grandTotal)}</div>
    </div>

    <div class="footer">
        Reporte generado el ${new Date().toLocaleString("es-ES")}
    </div>
</body>
</html>
    `.trim()};return a.jsxs(Ye,{children:[a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-black via-gray-900 to-black text-white relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/8 via-purple-900/8 to-blue-900/8"}),a.jsx("div",{className:"absolute inset-0 opacity-40",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.3) 1px, transparent 1px)",backgroundSize:"30px 30px",backgroundPosition:"0 0, 15px 15px"}}),a.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"radial-gradient(circle, rgba(168, 85, 247, 0.4) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"10px 10px"}}),a.jsx("div",{className:"absolute inset-0 opacity-15",style:{backgroundImage:"radial-gradient(circle, rgba(59, 130, 246, 0.5) 0.8px, transparent 0.8px)",backgroundSize:"40px 40px",backgroundPosition:"20px 0"}}),a.jsxs("div",{className:"relative z-10 container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"mb-8 flex flex-col items-center gap-2",children:[a.jsx("div",{className:"flex gap-2 bg-white/5 rounded-lg p-1 border border-white/10",children:["General","Día","Semana","Mes"].map(B=>a.jsx("button",{className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors ${u===B?"bg-blue-500/80 text-white":"text-blue-200 hover:bg-blue-500/30"}`,onClick:()=>{p(B),B==="General"&&w("")},children:B},B))}),a.jsxs("div",{className:"text-xs text-center",children:[l.length>0?a.jsxs("div",{className:"text-green-400 bg-green-500/10 px-3 py-1 rounded-full border border-green-500/20",children:["✅ ",l.length," días con datos disponibles"]}):a.jsx("div",{className:"text-yellow-400 bg-yellow-500/10 px-3 py-1 rounded-full border border-yellow-500/20",children:"⏳ Cargando fechas con datos..."}),u!=="General"&&h&&a.jsxs("div",{className:"mt-2 text-blue-400 bg-blue-500/10 px-3 py-1 rounded-full border border-blue-500/20",children:["🔍 Filtro activo: ",u," - ",h,m&&a.jsx("span",{className:"ml-2 animate-pulse",children:"⏳"})]}),u!=="General"&&!h&&a.jsxs("div",{className:"mt-2 text-yellow-400 bg-yellow-500/10 px-3 py-1 rounded-full border border-yellow-500/20",children:["⚠️ Selecciona una fecha para aplicar el filtro ",u]})]}),u!=="General"&&a.jsxs("div",{className:"flex flex-col items-center gap-2 mt-2",children:[a.jsx("span",{className:"text-xs text-gray-300",children:"Selecciona fecha base:"}),a.jsxs("div",{className:"bg-gray-900/80 rounded-lg p-3 border border-gray-700/40 max-w-xs",children:[a.jsx(ib,{mode:"single",selected:h?new Date(h+"T12:00:00"):void 0,onSelect:B=>he(B,d,w),month:I,onMonthChange:H,disabled:B=>be(B,d),modifiers:{highlight:b(),available:d.map(B=>new Date(B+"T12:00:00")),selected:h?[new Date(h+"T12:00:00")]:[]},modifiersClassNames:{highlight:"highlight-day",available:"available-day",selected:"selected-day"},showOutsideDays:!1,className:"compact-calendar"}),a.jsxs("div",{className:"text-xs text-gray-600 bg-gray-800/30 rounded px-2 py-1 mt-2",children:["💡 Solo los días con datos están habilitados (verde). El rango ",u.toLowerCase()," se resalta en azul.",d.length>0&&a.jsxs("div",{className:"mt-1 text-green-400",children:["📊 ",d.length," días con datos disponibles"]})]})]})]})]}),o&&a.jsx("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500/50 rounded-xl text-red-300 backdrop-blur-sm shadow-2xl shadow-red-500/20",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Pn,{className:"h-5 w-5 mr-2"}),o]})}),a.jsx("div",{className:"bg-transparent border border-white/10 rounded-2xl backdrop-blur-sm shadow-2xl shadow-blue-500/20",children:i?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}),a.jsx("p",{className:"mt-2 text-gray-400 text-sm",children:"Cargando estadísticas..."})]}):r.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(Wo,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"No hay barberos registrados"})]}):a.jsx("div",{className:"divide-y divide-white/10",children:r.map(B=>{var _,U,re,z,K,Z,de,ge,Se,Ne,Q,ce,D;const ne=u!=="General"&&h,C=Object.keys(n).length>0,A=ne&&C&&n[B._id],N=A?n[B._id]:s[B._id]||{};return console.log(`� DEBUG ${(_=B.user)==null?void 0:_.name}:`,{filterType:u,filterDate:h,hasFilterDate:ne,hasFilteredData:C,useFiltered:A,filteredStatsKeys:Object.keys(n),barberFilteredStats:n[B._id],barberGeneralStats:s[B._id],finalStats:N}),a.jsxs("div",{className:"px-4 py-6 hover:bg-white/5 transition-colors backdrop-blur-sm",children:[a.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-start",children:[a.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500/20 to-purple-500/20 rounded-lg flex items-center justify-center flex-shrink-0",children:je(B)}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h4",{className:"text-xl font-semibold",children:a.jsx(Ze,{className:"text-xl font-semibold",children:((U=B.user)==null?void 0:U.name)||"Sin nombre"})}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${B.isActive?"text-green-400":"text-red-400"} bg-current/10`,children:B.isActive?"Activo":"Inactivo"})]}),a.jsx("p",{className:"text-sm text-gray-400 mb-1",children:B.specialty}),a.jsxs("p",{className:"text-sm text-blue-400",children:[B.experience," años de experiencia"]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 w-full lg:w-auto",children:[m?a.jsx("div",{className:"col-span-4 text-center py-4 text-xs text-blue-300",children:"Cargando datos del rango seleccionado..."}):null,a.jsxs("div",{className:"bg-white/5 rounded-lg p-2 text-center border border-white/10",children:[a.jsx(Ns,{className:"w-5 h-5 text-green-400 mx-auto mb-1"}),a.jsx("div",{className:"text-base font-bold text-green-400",children:le(((re=N.sales)==null?void 0:re.total)||0)}),a.jsxs("div",{className:"text-[11px] text-gray-400",children:[((z=N.sales)==null?void 0:z.count)||0," ventas"]})]}),a.jsxs("div",{className:"bg-white/5 rounded-lg p-2 text-center border border-white/10",children:[a.jsx(jr,{className:"w-5 h-5 text-purple-400 mx-auto mb-1"}),a.jsx("div",{className:"text-base font-bold text-purple-400",children:((K=N.cortes)==null?void 0:K.count)||0}),a.jsx("div",{className:"text-[11px] text-gray-400",children:"cortes"})]}),a.jsxs("div",{className:"bg-white/5 rounded-lg p-2 text-center border border-white/10",children:[a.jsx(is,{className:"w-5 h-5 text-blue-400 mx-auto mb-1"}),a.jsx("div",{className:"text-base font-bold text-blue-400",children:le(((Z=N.appointments)==null?void 0:Z.total)||0)}),a.jsxs("div",{className:"text-[10px] text-gray-500",children:[((de=N.appointments)==null?void 0:de.completed)||0," citas"]})]}),a.jsxs("div",{className:"bg-white/5 rounded-lg p-2 text-center border border-white/10",children:[a.jsx($s,{className:"w-5 h-5 text-yellow-400 mx-auto mb-1"}),a.jsx("div",{className:"text-base font-bold text-yellow-400",children:le((((ge=N.sales)==null?void 0:ge.total)||0)+(((Se=N.appointments)==null?void 0:Se.total)||0))}),a.jsx("div",{className:"text-[11px] text-gray-400",children:"ingresos totales"})]})]}),a.jsx("div",{className:"relative",children:a.jsx("button",{onClick:()=>W(B._id,y),className:"p-2 bg-blue-600/20 text-blue-400 rounded-lg hover:bg-blue-600/30 transition-colors flex items-center justify-center",disabled:g,children:g&&x===B._id?a.jsx("div",{className:"w-5 h-5 border-2 border-blue-400 border-t-transparent rounded-full animate-spin"}):a.jsx(ys,{className:"w-5 h-5"})})})]}),L[B._id]&&a.jsxs("div",{className:"mt-4 bg-white/5 rounded-lg border border-white/10 p-4 transition-all duration-300 ease-in-out",children:[a.jsxs("h5",{className:"text-sm font-medium text-gray-300 mb-3",children:["Generar Reporte - ",((Ne=B.user)==null?void 0:Ne.name)||"Barbero"]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:()=>ee(B._id,null,S,()=>W(B._id)),className:"w-full text-left px-3 py-2 text-sm bg-blue-600/20 text-blue-400 rounded-lg hover:bg-blue-600/30 transition-colors flex items-center gap-2",children:[a.jsx(is,{className:"w-4 h-4"}),"Reporte del día actual"]}),a.jsx("div",{className:"border-t border-gray-700/50"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500 font-medium mb-2",children:"Seleccionar fecha específica:"}),((Q=c[B._id])==null?void 0:Q.length)>0?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500 font-medium mb-2",children:"Períodos rápidos:"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("button",{onClick:()=>R(B._id,1,c,S,t),className:"px-2 py-1.5 text-xs bg-green-600/20 text-green-400 rounded-md hover:bg-green-600/30 transition-colors",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"font-medium",children:"Ayer"}),a.jsx("div",{className:"text-[10px] opacity-75",children:(()=>{const ae=new Date;return ae.setDate(ae.getDate()-1),ae.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit"})})()})]})}),a.jsx("button",{onClick:()=>R(B._id,2,c,S,t),className:"px-2 py-1.5 text-xs bg-yellow-600/20 text-yellow-400 rounded-md hover:bg-yellow-600/30 transition-colors",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"font-medium",children:"Anteayer"}),a.jsx("div",{className:"text-[10px] opacity-75",children:(()=>{const ae=new Date;return ae.setDate(ae.getDate()-2),ae.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit"})})()})]})})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500 font-medium mb-2",children:"Fecha específica:"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"date",className:"w-full px-3 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",onChange:ae=>{const _e=ae.target.value;_e&&q(_e,B._id,c,S,t).then(()=>{ae.target.value=""})},min:((ce=c[B._id])==null?void 0:ce.length)>0?c[B._id][c[B._id].length-1]:"",max:((D=c[B._id])==null?void 0:D.length)>0?c[B._id][0]:"",placeholder:"Seleccionar fecha..."}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:a.jsx(is,{className:"w-4 h-4 text-gray-500"})})]}),a.jsx("div",{className:"text-xs text-gray-600 bg-gray-800/30 rounded px-2 py-1 mt-1",children:"💡 Solo las fechas con datos están disponibles"})]}),a.jsx("div",{className:"text-xs text-gray-500 font-medium mb-1",children:"Acceso rápido (últimas 5 fechas):"}),a.jsx("div",{className:"grid grid-cols-1 gap-1 max-h-24 overflow-y-auto",children:c[B._id].slice(0,5).map(ae=>a.jsxs("button",{onClick:()=>ee(B._id,ae,S,()=>W(B._id)),className:"text-left px-3 py-1.5 text-xs text-gray-300 hover:bg-white/10 rounded-md transition-colors flex items-center gap-2",children:[a.jsx(is,{className:"w-3 h-3"}),new Date(ae).toLocaleDateString("es-ES",{weekday:"short",day:"numeric",month:"short",year:"numeric"})]},ae))})]}):a.jsx("div",{className:"px-3 py-2 text-xs text-gray-500 text-center",children:"No hay fechas disponibles"})]})]})]})]},B._id)})})})]})]}),P&&f&&a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:J}),a.jsxs("div",{className:"relative bg-gray-800/95 backdrop-blur-md border border-gray-700/50 rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700/50",children:[a.jsx("h3",{className:"text-xl font-bold",children:a.jsxs(Ze,{className:"text-xl font-bold",children:["Reporte del ",new Date(f.date).toLocaleDateString("es-ES")]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:M,className:"px-4 py-2 bg-blue-600/20 text-blue-400 rounded-lg hover:bg-blue-600/30 transition-colors flex items-center gap-2",children:[a.jsx(On,{className:"w-4 h-4"}),"Descargar"]}),a.jsx("button",{onClick:J,className:"p-2 text-gray-400 hover:text-white transition-colors",children:a.jsx(qr,{className:"w-5 h-5"})})]})]}),a.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:f&&a.jsx("div",{className:"bg-white text-black p-6 rounded-lg font-mono text-sm",dangerouslySetInnerHTML:{__html:ie(f).replace(/<!DOCTYPE.*?<body[^>]*>/,"").replace(/<\/body>.*?<\/html>/,"")}})})]})]})]})},ub=()=>{const[e,t]=O.useState(new Date().toISOString().split("T")[0]),[r,s]=O.useState("daily"),[n,i]=O.useState([]),[o,l]=O.useState(!1),[d,c]=O.useState(""),[u,h]=O.useState({period:"",dateRange:""}),[m,f]=O.useState({totalRevenue:0,totalCuts:0,totalProducts:0,activeBarbers:0}),g=[{value:"daily",label:"Diario",icon:nr},{value:"weekly",label:"Semanal",icon:fa},{value:"monthly",label:"Mensual",icon:$s}];O.useEffect(()=>{x()},[e,r]);const x=async()=>{var y,S;try{l(!0),c("");const P=await fetch(`/api/v1/sales/reports?type=${r}&date=${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!P.ok)throw new Error("Error al cargar el reporte");const L=await P.json();i(L.data||[]),h({period:L.period||"",dateRange:L.dateRange||""});const I=(L.data||[]).reduce((H,W)=>{var J;return H.totalRevenue+=W.totalRevenue,H.totalCuts+=W.totalCuts,H.totalProducts+=W.totalProducts,H.activeBarbers=((J=L.data)==null?void 0:J.length)||0,H},{totalRevenue:0,totalCuts:0,totalProducts:0,activeBarbers:0});f(I)}catch(P){console.error("Error al cargar reporte:",P),c(`Error al cargar el reporte ${(S=(y=g.find(L=>L.value===r))==null?void 0:y.label)==null?void 0:S.toLowerCase()}`)}finally{l(!1)}},p=y=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(y),w=y=>new Date(y+"T00:00:00").toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric"}),b=()=>{const y=new Date(e+"T00:00:00");switch(r){case"daily":return`Reporte del día: ${w(e)}`;case"weekly":const S=new Date(y);S.setDate(S.getDate()-6);const P=S.toISOString().split("T")[0];return`Reporte semanal: ${w(P)} - ${w(e)}`;case"monthly":const L=new Date(y);L.setDate(L.getDate()-29);const I=L.toISOString().split("T")[0];return`Reporte mensual: ${w(I)} - ${w(e)}`;default:return`Reporte: ${w(e)}`}};return o?a.jsx(Ye,{children:a.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:a.jsxs("div",{className:"relative z-10 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-400 mx-auto mb-4"}),a.jsx("p",{className:"text-white text-lg",children:"Cargando reporte..."})]})})}):a.jsx(Ye,{children:a.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[a.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[a.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),a.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-green-500/10 rounded-full blur-3xl"}),a.jsx("div",{className:"absolute top-3/4 left-3/4 w-64 h-64 bg-purple-500/10 rounded-full blur-2xl"})]}),a.jsxs("div",{className:"relative z-10 container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-400 via-green-400 to-purple-400 bg-clip-text text-transparent mb-2",children:"Reportes"}),a.jsx("p",{className:"text-gray-300 text-lg",children:"Análisis de ventas y servicios por barbero"}),a.jsx("p",{className:"text-blue-400 mt-2 font-medium",children:b()}),u.dateRange&&a.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:["Datos del servidor: ",u.dateRange]})]}),a.jsxs("div",{className:"mb-8 grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Dn,{className:"h-5 w-5 text-blue-400"}),a.jsx("label",{className:"text-gray-300 font-medium",children:"Tipo:"})]}),a.jsx("div",{className:"flex gap-2",children:g.map(y=>{const S=y.icon;return a.jsxs("button",{onClick:()=>s(y.value),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all duration-300 ${r===y.value?"bg-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:[a.jsx(S,{className:"h-4 w-4"}),y.label]},y.value)})})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nr,{className:"h-5 w-5 text-blue-400"}),a.jsx("label",{className:"text-gray-300 font-medium",children:r==="daily"?"Fecha:":"Fecha final:"})]}),a.jsx("input",{type:"date",value:e,onChange:y=>t(y.target.value),className:"px-4 py-2 bg-gray-800/50 border border-gray-700/50 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50"}),a.jsxs("span",{className:"text-gray-400",children:["(",w(e),")"]}),(r==="weekly"||r==="monthly")&&a.jsx("span",{className:"text-xs text-gray-500 italic",children:r==="weekly"?"(7 días hacia atrás)":"(30 días hacia atrás)"})]})]}),d&&a.jsx("div",{className:"mb-6 p-4 bg-red-900/30 border border-red-500/50 rounded-lg text-red-300",children:d}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[a.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-400 text-sm",children:"Ingresos Totales"}),a.jsx("p",{className:"text-2xl font-bold text-green-400",children:p(m.totalRevenue)})]}),a.jsx(Ra,{className:"h-8 w-8 text-green-400"})]})}),a.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-400 text-sm",children:"Total Cortes"}),a.jsx("p",{className:"text-2xl font-bold text-blue-400",children:m.totalCuts})]}),a.jsx(jr,{className:"h-8 w-8 text-blue-400"})]})}),a.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-400 text-sm",children:"Productos Vendidos"}),a.jsx("p",{className:"text-2xl font-bold text-purple-400",children:m.totalProducts})]}),a.jsx(Aa,{className:"h-8 w-8 text-purple-400"})]})}),a.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-400 text-sm",children:"Barberos Activos"}),a.jsx("p",{className:"text-2xl font-bold text-orange-400",children:m.activeBarbers})]}),a.jsx(Wo,{className:"h-8 w-8 text-orange-400"})]})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Detalle por Barbero"}),n.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(fa,{className:"h-16 w-16 text-gray-600 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:"No hay datos"}),a.jsx("p",{className:"text-gray-500",children:"No se registraron ventas ni servicios para esta fecha"})]}):n.map((y,S)=>a.jsxs("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6 hover:bg-gray-800/60 transition-all duration-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500/20 to-purple-500/20 rounded-full flex items-center justify-center",children:a.jsxs("span",{className:"text-xl font-bold text-blue-400",children:["#",S+1]})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:y.barberName}),a.jsxs("p",{className:"text-gray-400",children:["Total: ",p(y.totalRevenue)]})]})]}),a.jsxs("div",{className:"flex gap-4 text-sm",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-blue-400 font-semibold",children:y.totalCuts}),a.jsx("div",{className:"text-gray-400",children:"Cortes"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-purple-400 font-semibold",children:y.totalProducts}),a.jsx("div",{className:"text-gray-400",children:"Productos"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-blue-400 mb-3 flex items-center gap-2",children:[a.jsx(jr,{className:"h-5 w-5"}),"Servicios (",y.totalCuts,")"]}),y.cuts.length===0?a.jsx("p",{className:"text-gray-500 text-sm",children:"No se registraron cortes"}):a.jsxs("div",{className:"space-y-2",children:[y.cuts.map((P,L)=>a.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-blue-300",children:P.serviceName}),a.jsx("p",{className:"text-gray-400 text-sm",children:P.customerName})]}),a.jsx("span",{className:"text-blue-400 font-semibold",children:p(P.servicePrice)})]})},L)),a.jsx("div",{className:"text-right pt-2 border-t border-blue-500/30",children:a.jsxs("span",{className:"text-blue-400 font-bold",children:["Subtotal: ",p(y.totalCutsRevenue)]})})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-purple-400 mb-3 flex items-center gap-2",children:[a.jsx(Ns,{className:"h-5 w-5"}),"Productos (",y.totalProducts,")"]}),y.productSales.length===0?a.jsx("p",{className:"text-gray-500 text-sm",children:"No se vendieron productos"}):a.jsxs("div",{className:"space-y-2",children:[y.productSales.map((P,L)=>a.jsx("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-3",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-purple-300",children:P.productName}),a.jsxs("p",{className:"text-gray-400 text-sm",children:[P.quantity," x ",p(P.unitPrice),P.customerName&&` - ${P.customerName}`]})]}),a.jsx("span",{className:"text-purple-400 font-semibold",children:p(P.totalAmount)})]})},L)),a.jsx("div",{className:"text-right pt-2 border-t border-purple-500/30",children:a.jsxs("span",{className:"text-purple-400 font-bold",children:["Subtotal: ",p(y.totalProductRevenue)]})})]})]})]})]},y.barberId))]})]})]})})};function Ea({children:e,requiredRole:t}){const{user:r,loading:s,error:n,refreshToken:i}=er(),o=Tn();if(O.useEffect(()=>{const l=localStorage.getItem("token");!s&&l&&!r&&!n&&i().catch(()=>{})},[s,r,n,i]),s)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});if(!r)return a.jsx(kr,{to:"/login",state:{from:o.pathname},replace:!0});if(t){const l=Array.isArray(t)?t:[t];if(!l.includes(r.role))return console.warn(`Acceso denegado: se requiere uno de estos roles [${l.join(", ")}], usuario tiene rol ${r.role}`),a.jsx(kr,{to:"/",replace:!0})}return e}function fb({children:e}){const{user:t}=er();return t?e({user:t}):a.jsx(kr,{to:"/login",replace:!0})}const Io=({children:e})=>{const{user:t,loading:r}=er(),s=Tn(),{state:n}=s;if(r)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});if(t){if(n!=null&&n.from)return a.jsx(kr,{to:n.from,replace:!0});if(s.pathname==="/")return a.jsx(kr,{to:"/",replace:!0});switch(t.role){case"admin":return a.jsx(kr,{to:"/",replace:!0});case"barber":return a.jsx(kr,{to:"/",replace:!0});default:return a.jsx(kr,{to:"/",replace:!0})}}return e};function hb(){return Pc(),a.jsxs(Oc,{children:[a.jsx(gs,{children:a.jsxs(Ie,{element:a.jsx(Ac,{}),children:[a.jsx(Ie,{path:"/",element:a.jsx(Ic,{})}),a.jsx(Ie,{path:"/services",element:a.jsx(zi,{})}),a.jsx(Ie,{path:"/barbers",element:a.jsx(Du,{})}),a.jsx(Ie,{path:"/barbers/:id",element:a.jsx(Hi,{})}),a.jsx(Ie,{path:"/login",element:a.jsx(Io,{children:a.jsx(Fu,{})})}),a.jsx(Ie,{path:"/register",element:a.jsx(Io,{children:a.jsx(Pu,{})})}),a.jsx(Ie,{path:"/profile",element:a.jsx(Ea,{children:a.jsx(Rc,{})})}),a.jsx(Ie,{path:"/profile-edit",element:a.jsx(Ea,{children:a.jsx($c,{})})}),a.jsxs(Ie,{path:"/admin",element:a.jsx(Ea,{requiredRole:["admin","barber"],children:a.jsx(yn,{})}),children:[a.jsx(Ie,{index:!0,element:a.jsx(fb,{children:({user:e})=>a.jsx(kr,{to:e.role==="barber"?"/admin/sales":"/admin/barbers",replace:!0})})}),a.jsx(Ie,{path:"inventory",element:a.jsx(Tv,{})}),a.jsx(Ie,{path:"sales",element:a.jsx(Ou,{})}),a.jsxs(Ie,{element:a.jsx(Ea,{requiredRole:["admin"],children:a.jsx(yn,{})}),children:[a.jsx(Ie,{path:"services",element:a.jsx(zi,{})}),a.jsx(Ie,{path:"roles",element:a.jsx(Mu,{})}),a.jsx(Ie,{path:"barbers",element:a.jsx(db,{})}),a.jsx(Ie,{path:"barbers/:id",element:a.jsx(Hi,{})}),a.jsx(Ie,{path:"reports",element:a.jsx(ub,{})})]})]}),a.jsx(Ie,{path:"/appointment",element:a.jsx(Ea,{children:a.jsx(Su,{})})}),a.jsx(Ie,{path:"*",element:a.jsx(kr,{to:"/",replace:!0})})]})}),a.jsx(Fc,{})]})}const xb="/TheBrothersBarberShop/";Nc.createRoot(document.getElementById("root")).render(a.jsx(uc.StrictMode,{children:a.jsx(fc,{basename:xb,children:a.jsx(Sc,{children:a.jsx(Dc,{children:a.jsx(hb,{})})})})}));
