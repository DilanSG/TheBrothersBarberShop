import{j as e,P as f}from"./index-xDHdJVsL.js";import{r as o}from"./vendor-CqFXMR30.js";import{e as y,m as w,v as E,o as B,D as O,a as S,w as z,z as A,x as F}from"./utils-DFsqPVhN.js";const M=()=>{const[l,R]=o.useState(new Date().toISOString().split("T")[0]),[n,C]=o.useState("daily"),[h,D]=o.useState([]),[P,p]=o.useState(!1),[g,j]=o.useState(""),[b,k]=o.useState({period:"",dateRange:""}),[x,T]=o.useState({totalRevenue:0,totalCuts:0,totalProducts:0,activeBarbers:0}),N=[{value:"daily",label:"Diario",icon:y},{value:"weekly",label:"Semanal",icon:w},{value:"monthly",label:"Mensual",icon:E}];o.useEffect(()=>{$()},[l,n]);const $=async()=>{var t,r;try{p(!0),j("");const s=await fetch(`/api/v1/sales/reports?type=${n}&date=${l}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!s.ok)throw new Error("Error al cargar el reporte");const a=await s.json();D(a.data||[]),k({period:a.period||"",dateRange:a.dateRange||""});const m=(a.data||[]).reduce((i,u)=>{var v;return i.totalRevenue+=u.totalRevenue,i.totalCuts+=u.totalCuts,i.totalProducts+=u.totalProducts,i.activeBarbers=((v=a.data)==null?void 0:v.length)||0,i},{totalRevenue:0,totalCuts:0,totalProducts:0,activeBarbers:0});T(m)}catch(s){console.error("Error al cargar reporte:",s),j(`Error al cargar el reporte ${(r=(t=N.find(a=>a.value===n))==null?void 0:t.label)==null?void 0:r.toLowerCase()}`)}finally{p(!1)}},c=t=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(t),d=t=>new Date(t+"T00:00:00").toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric"}),I=()=>{const t=new Date(l+"T00:00:00");switch(n){case"daily":return`Reporte del día: ${d(l)}`;case"weekly":const r=new Date(t);r.setDate(r.getDate()-6);const s=r.toISOString().split("T")[0];return`Reporte semanal: ${d(s)} - ${d(l)}`;case"monthly":const a=new Date(t);a.setDate(a.getDate()-29);const m=a.toISOString().split("T")[0];return`Reporte mensual: ${d(m)} - ${d(l)}`;default:return`Reporte: ${d(l)}`}};return P?e.jsx(f,{children:e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-400 mx-auto mb-4"}),e.jsx("p",{className:"text-white text-lg",children:"Cargando reporte..."})]})})}):e.jsx(f,{children:e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-green-500/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-3/4 left-3/4 w-64 h-64 bg-purple-500/10 rounded-full blur-2xl"})]}),e.jsxs("div",{className:"relative z-10 container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-400 via-green-400 to-purple-400 bg-clip-text text-transparent mb-2",children:"Reportes"}),e.jsx("p",{className:"text-gray-300 text-lg",children:"Análisis de ventas y servicios por barbero"}),e.jsx("p",{className:"text-blue-400 mt-2 font-medium",children:I()}),b.dateRange&&e.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:["Datos del servidor: ",b.dateRange]})]}),e.jsxs("div",{className:"mb-8 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-blue-400"}),e.jsx("label",{className:"text-gray-300 font-medium",children:"Tipo:"})]}),e.jsx("div",{className:"flex gap-2",children:N.map(t=>{const r=t.icon;return e.jsxs("button",{onClick:()=>C(t.value),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all duration-300 ${n===t.value?"bg-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:[e.jsx(r,{className:"h-4 w-4"}),t.label]},t.value)})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 text-blue-400"}),e.jsx("label",{className:"text-gray-300 font-medium",children:n==="daily"?"Fecha:":"Fecha final:"})]}),e.jsx("input",{type:"date",value:l,onChange:t=>R(t.target.value),className:"px-4 py-2 bg-gray-800/50 border border-gray-700/50 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50"}),e.jsxs("span",{className:"text-gray-400",children:["(",d(l),")"]}),(n==="weekly"||n==="monthly")&&e.jsx("span",{className:"text-xs text-gray-500 italic",children:n==="weekly"?"(7 días hacia atrás)":"(30 días hacia atrás)"})]})]}),g&&e.jsx("div",{className:"mb-6 p-4 bg-red-900/30 border border-red-500/50 rounded-lg text-red-300",children:g}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Ingresos Totales"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:c(x.totalRevenue)})]}),e.jsx(O,{className:"h-8 w-8 text-green-400"})]})}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Total Cortes"}),e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:x.totalCuts})]}),e.jsx(S,{className:"h-8 w-8 text-blue-400"})]})}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Productos Vendidos"}),e.jsx("p",{className:"text-2xl font-bold text-purple-400",children:x.totalProducts})]}),e.jsx(z,{className:"h-8 w-8 text-purple-400"})]})}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Barberos Activos"}),e.jsx("p",{className:"text-2xl font-bold text-orange-400",children:x.activeBarbers})]}),e.jsx(A,{className:"h-8 w-8 text-orange-400"})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Detalle por Barbero"}),h.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"h-16 w-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:"No hay datos"}),e.jsx("p",{className:"text-gray-500",children:"No se registraron ventas ni servicios para esta fecha"})]}):h.map((t,r)=>e.jsxs("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6 hover:bg-gray-800/60 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500/20 to-purple-500/20 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-xl font-bold text-blue-400",children:["#",r+1]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:t.barberName}),e.jsxs("p",{className:"text-gray-400",children:["Total: ",c(t.totalRevenue)]})]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-blue-400 font-semibold",children:t.totalCuts}),e.jsx("div",{className:"text-gray-400",children:"Cortes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-purple-400 font-semibold",children:t.totalProducts}),e.jsx("div",{className:"text-gray-400",children:"Productos"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-blue-400 mb-3 flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5"}),"Servicios (",t.totalCuts,")"]}),t.cuts.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No se registraron cortes"}):e.jsxs("div",{className:"space-y-2",children:[t.cuts.map((s,a)=>e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-300",children:s.serviceName}),e.jsx("p",{className:"text-gray-400 text-sm",children:s.customerName})]}),e.jsx("span",{className:"text-blue-400 font-semibold",children:c(s.servicePrice)})]})},a)),e.jsx("div",{className:"text-right pt-2 border-t border-blue-500/30",children:e.jsxs("span",{className:"text-blue-400 font-bold",children:["Subtotal: ",c(t.totalCutsRevenue)]})})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-purple-400 mb-3 flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"Productos (",t.totalProducts,")"]}),t.productSales.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No se vendieron productos"}):e.jsxs("div",{className:"space-y-2",children:[t.productSales.map((s,a)=>e.jsx("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-purple-300",children:s.productName}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[s.quantity," x ",c(s.unitPrice),s.customerName&&` - ${s.customerName}`]})]}),e.jsx("span",{className:"text-purple-400 font-semibold",children:c(s.totalAmount)})]})},a)),e.jsx("div",{className:"text-right pt-2 border-t border-purple-500/30",children:e.jsxs("span",{className:"text-purple-400 font-bold",children:["Subtotal: ",c(t.totalProductRevenue)]})})]})]})]})]},t.barberId))]})]})]})})};export{M as default};
